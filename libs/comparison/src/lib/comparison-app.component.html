<!--<gd-loading-mask></gd-loading-mask>-->
<div class="wrapper">
  <div class="row">
    <div class="column">
      <div class="top-panel">
        <gd-logo [logo]="'comparison'" icon="eye"></gd-logo>
        <gd-top-toolbar class="toolbar-panel">
          <gd-button [icon]="'play'" [tooltip]="'Compare'" [disabled]="!file.get(first) || !file.get(second)"
                     (click)="compare()"></gd-button>
          <gd-button [icon]="'download'" [tooltip]="'Download'" [disabled]="!result" (click)="download()"></gd-button>
        </gd-top-toolbar>
      </div>
      <div class="open-file-panel">
        <gd-add-file-panel class="compare-file" [fileName]="firstFileName" [panel]="first"
                           (active)="activePanel = $event" (urlForUpload)="upload($event)"
                           (cleanPanel)="clearFile(first)">
        </gd-add-file-panel>
        <gd-add-file-panel class="compare-file" [fileName]="secondFileName" [panel]="second"
                           (active)="activePanel = $event" (urlForUpload)="upload($event)"
                           (cleanPanel)="clearFile(second)">
        </gd-add-file-panel>
      </div>
      <div class="files-panel" *ngIf="activeTab === filesTab">
        <div class="compare-file upload-compare-file">
          <gd-upload-file-panel class="upload-compare-file" [panel]="first" (active)="activePanel = $event"
                                *ngIf="!firstFileName && !loadingFirstPanel">
          </gd-upload-file-panel>
          <div class="upload-compare-file" *ngIf="loadingFirstPanel">
            <fa-icon [icon]="['fas','circle-notch']" [spin]="true"></fa-icon>
            <span>Loading... Please wait.</span>
          </div>
          <gd-document class="gd-document" *ngIf="file.get(first)" [file]="file.get(first)" [mode]="false"
                       [preloadPageCount]="comparisonConfig?.preloadPageCount" gdRenderPrint
                       [htmlMode]="false">
          </gd-document>
        </div>
        <div class="compare-file upload-compare-file">
          <gd-upload-file-panel class="upload-compare-file" [panel]="second" (active)="activePanel = $event"
                                *ngIf="!secondFileName && !loadingSecondPanel">
          </gd-upload-file-panel>
          <div class="upload-compare-file" *ngIf="loadingSecondPanel">
            <fa-icon [icon]="['fas','circle-notch']" [spin]="true"></fa-icon> &nbsp;
            <span>Loading... Please wait.</span>
          </div>
          <gd-document class="gd-document" *ngIf="file.get(second)" [file]="file.get(second)" [mode]="false"
                       [preloadPageCount]="comparisonConfig?.preloadPageCount" gdRenderPrint
                       [htmlMode]="false">
          </gd-document>
        </div>
      </div>
      <div class="result-panel" *ngIf="activeTab === resultTab">
        <div class="upload-compare-file" *ngIf="!result">
          <fa-icon [icon]="['fas','circle-notch']" [spin]="true"></fa-icon> &nbsp;
          <span>Loading... Please wait.</span>
        </div>
        <gd-document class="gd-document" *ngIf="result" [file]="result" [mode]="false"
                     [preloadPageCount]="comparisonConfig?.preloadPageCount" gdRenderPrint
                     [htmlMode]="false"></gd-document>
      </div>
    </div>
    <gd-side-panel (hideSidePanel)="hideSidePanel($event)" *ngIf="result && activeTab === resultTab" [title]="'Differences'"
                   [icon]="'info-circle'">
      <div *ngFor="let change of result.changes; let i = index" class="gd-difference" data-id="{{i}}">
        <span [ngSwitch]="change.type">
          <span *ngSwitchCase='1'>
            <fa-icon class="fas fa-pencil-alt" [icon]="['fas','pencil-alt']"></fa-icon><span class="gd-difference-title">Text edited</span>
          </span>
          <span *ngSwitchCase='2'>
            <fa-icon class="fas fa-arrow-right" [icon]="['fas','arrow-right']"></fa-icon><span class="gd-difference-title">Text added</span>
          </span>
          <span *ngSwitchCase='3'>
            <fa-icon class="fas fa-times" [icon]="['fas','times']"></fa-icon><span class="gd-difference-title">Text deleted</span>
          </span>
          <span *ngSwitchCase='4'>
            <fa-icon class="fas fa-arrow-right" [icon]="['fas','arrow-right']"></fa-icon><span class="gd-difference-title">Text added</span>
          </span>
          <span *ngSwitchCase='5'>
            <fa-icon class="fas fa-pencil-alt" [icon]="['fas','pencil-alt']"></fa-icon><span class="gd-difference-title">Style changed</span>
          </span>
        </span>
        <span class="gd-difference-page">Page {{change.pageInfo.id + 1}}</span>
        <div class="gd-differentce-comment">{{change.text}}</div>
      </div>
    </gd-side-panel>
  </div>
  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"
                         (selectedFileGuid)="selectFile($event, null, browseFilesModal, activePanel)">
  </gd-browse-files-modal>
  <gd-error-modal></gd-error-modal>
</div>
