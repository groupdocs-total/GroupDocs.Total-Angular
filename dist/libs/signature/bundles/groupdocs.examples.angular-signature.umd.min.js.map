{"version":3,"sources":["../../../../node_modules/tslib/tslib.es6.js","ng://@groupdocs.examples.angular/signature/lib/signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-config.ts","ng://@groupdocs.examples.angular/signature/lib/signature-config.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-models.ts","ng://@groupdocs.examples.angular/signature/lib/select-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/remove-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/active-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signatures-holder.service.ts","ng://@groupdocs.examples.angular/signature/lib/copy-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature/signature.component.ts","ng://@groupdocs.examples.angular/signature/lib/drag-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-app.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature-list-panel/signature-list-panel.component.ts","ng://@groupdocs.examples.angular/signature/lib/new-bar-qr-code/new-bar-qr-code.component.ts","ng://@groupdocs.examples.angular/signature/lib/upload-signature/upload-signature.component.ts","ng://@groupdocs.examples.angular/signature/lib/dnd-signature.directive.ts","ng://@groupdocs.examples.angular/signature/lib/canvas/canvas.component.ts","ng://@groupdocs.examples.angular/signature/lib/active-canvas.service.ts","ng://@groupdocs.examples.angular/signature/lib/remove-canvas.service.ts","ng://@groupdocs.examples.angular/signature/lib/stamp-canvas/stamp-canvas.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature-tab-activator.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-left-panel/signature-left-panel.component.ts","ng://@groupdocs.examples.angular/signature/lib/hand-modal/hand-modal.component.ts","ng://@groupdocs.examples.angular/signature/lib/stamp-modal/stamp-modal.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__values","o","s","Symbol","iterator","m","i","call","length","next","value","done","TypeError","SignatureService","_http","_config","_observer","Subject","_refreshSignatures","asObservable","defineProperty","loadFiles","path","post","getSignatureApiEndpoint","Api","LOAD_FILE_TREE","httpOptionsJson","loadFile","credentials","LOAD_DOCUMENT_DESCRIPTION","upload","file","url","rewrite","signType","formData","FormData","append","String","UPLOAD_DOCUMENTS","loadPage","page","LOAD_DOCUMENT_PAGE","guid","password","getDownloadUrl","DOWNLOAD_DOCUMENTS","loadPrint","LOAD_PRINT","loadPrintPdf","LOAD_PRINT_PDF","httpOptionsJsonResponseTypeBlob","getSignatures","type","signatureType","removeSignatures","DELETE_SIGNATURE_FILE","uploadSignature","data","fileList","item","getCode","text","temp","SAVE_OPTICAL_CODE","properties","loadSignatureImage","sign","LOAD_SIGNATURE_IMAGE","pageNumber","pipe","map","props","saveTextSignature","fontColor","Utils","toRgb","SAVE_TEXT","toHex","saveImage","img","SAVE_IMAGE","image","saveStamp","props_1","tslib_1.__values","props_1_1","backgroundColor","strokeColor","textColor","SAVE_STAMP","stampData","signatures","docType","FileUtil","find","format","SIGN","signaturesData","documentType","downloadSigned","DOWNLOAD_SIGNED","refreshSignatures","Injectable","args","providedIn","HttpClient","ConfigService","SignatureConfig","SignatureConfigService","_signatureConfig","BehaviorSubject","_updatedConfig","load","_this","Promise","resolve","reject","configEndpoint","getConfigEndpoint","SIGNATURE_APP","get","toPromise","then","response","signatureConfig","catch","JSON","stringify","SignatureType","getSignatureType","id","TEXT","IMAGE","DIGITAL","QR_CODE","BAR_CODE","STAMP","HAND","name","icon","title","FileListWithParams","DraggableSignature","TEMP","Position","left","top","SignatureData","position","ret","number","signatureGuid","imageWidth","width","imageHeight","height","digitalProps","reason","contact","address","signaturePassword","date","DigitalSign","AddedSignature","SignatureProps","getDefault","f","Formatting","default","color","font","fontSize","underline","bold","italic","RemoveSign","CopySign","CopyChanges","StampCanvasProps","textExpansion","textRepeat","init","isMobile","zIndex","strokeWidth","radius","Border","widthOptions","push","widthOption","separator","Downloads","original","signed","SelectSignatureService","_selectSignature","select","RemoveSignatureService","_removeSignature","remove","ActiveSignatureService","_activeChange","changeActive","signId","SignaturesHolderService","Map","add","key","set","addId","has","delete","clear","values","items","items_1","items_1_1","elem","changeTemp","imageGuid","CopySignatureService","_copySignature","_observerChanges","_changesSignature","copy","copySign","notifyChanges","changes","$","jquery","Signature$1","Signature","_signatureService","_removeSignatureService","_copySignatureService","_activeSignatureService","_signaturesHolderService","_zoomService","active","unlock","copied","baseCopied","subject","activeChange","subscribe","debounceTime","sendSaveText","ngOnInit","ngAfterViewChecked","changeZoom","zoom","getData","dragOver","$event","preventDefault","stopPropagation","dragStart","oldPosition","getMousePosition","dataTransfer","setData","dragging","x","y","isOnPage","top_1","correctPosition","currentPage","document","elementFromPoint","parent","hasClass","isText","getFormatting","formatting","fillFormatting","del","activation","isDigital","drop","isInit","onCopySign","ngAfterViewInit","setTimeout","element","focus","pageHeight","pageWidth","saveText","hideMenu","getMenuShift","menuWidth","shift","getMenuType","MenuType","FOR_SIGNATURE","Component","selector","template","ZoomService","Input","DragSignatureService","SignatureAppComponent","_modalService","configService","uploadFilesService","_navigateService","pagePreloadService","_renderPrintService","passwordService","_windowService","_selectSignatureService","_signatureTabActivationService","_hostingComponentsService","_addDynamicComponentService","_dragSignatureService","_onCloseService","removeSignatureService","_excMessageService","_tabActivatorService","copySignatureService","files","countPages","formatDisabled","browseFilesModal","CommonModals","BrowseFiles","signatureTypes","signatureTypeCodes","signatureComponents","fileWasDropped","_zoom","activeTabChange","tabId","activeSignatureTab","changeActiveTab","isDesktop","onResize","w","refreshZoom","copySignature","componentRef","comp","instance","compPage","_b","pages","_c","createDraggableSign","addedSignature","createAddedSignature","addSignatureComponent","changesSignature","copyChanges","ids","ids_1","ids_1_1","compRef","removeSignature","ids_2","ids_2_1","destroy","updatedConfig","uploadsChange","uploads","rewriteConfig","obj","selectFile","selectDir","checkPreload","preloadPageCountConfig","preloadPages","passChange","pass","PasswordRequired","selectSignature","defaultDocumentConfig","isLoading","ptToPx","pt","getFitToWidth","_pageWidth","_pageHeight","offsetWidth","window","innerWidth","Math","round","zoomIn","zoomOut","pageSelector","preloadPageCount","download","downloadOriginal","defaultDocument","print","browse","enableRightClick","textSignature","imageSignature","digitalSignature","qrCodeSignature","barCodeSignature","stampSignature","handSignature","openModal","open","closeModal","close","modalId","cleanSignatures","clearData","start","end","this_1","downloadFile","location","assign","onRightClick","enableRightClickConfig","getSignatureTypeConfig","textSignatureConfig","imageSignatureConfig","digitalSignatureConfig","qrCodeSignatureConfig","barCodeSignatureConfig","stampSignatureConfig","handSignatureConfig","dropSignature","documentPage","offset","currentPosition","attr","split","parseInt","closeTab","signature","pageModel","dynamicDirective","viewContainerRef","addDynamicComponent","getNextId","maxId","keys","annId","hideAll","target","parentElement","attributes","newSign","DrawHandSignature","DrawStampSignature","addTextSign","ngOnDestroy","prepareSignaturesData","OperationSuccess","_d","ids_3","ids_3_1","isPdf","codesConfig","isVisible","notCode","activeTab","fileDropped","isFirstTab","onPan","ModalService","UploadFilesService","NavigateService","PagePreloadService","RenderPrintService","PasswordService","WindowService","TopTabActivatorService","HostingDynamicComponentService","AddDynamicComponentService","OnCloseService","ExceptionMessageService","TabActivatorService","SignatureListPanelComponent","_datePipe","removeSignatureEvent","EventEmitter","showDigitalInputs","transform","Date","getImage","deleteSign","emit","getSign","digitalId","dragLeave","selectDigital","isActive","parseDate","empty","loading","ngOnChanges","DatePipe","Output","NewBarQrCodeComponent","_elementRef","closePanel","saveCode","encodedImage","clean","nativeElement","querySelector","addSign","saveTemp","ElementRef","UploadSignatureComponent","handleFileInput","addFiles","uploadFiles","DndSignatureDirective","_uploadFilesService","_super","tslib_1.__extends","onDrop","evt","Directive","HostListener","DndDirective","CanvasComponent","_isDragged","_ctx","canvas","getContext","onMouseDown","e","pos","offsetX","offsetY","wEvent","beginPath","moveTo","onMouseUp","onMouseMove","lineTo","stroke","setColor","strokeStyle","toDataURL","getWidth","getHeight","ViewChild","static","ActiveCanvasService","RemoveCanvasService","_removeCanvas","StampCanvasComponent","_activeCanvasService","colorPickerBG","colorPickerC","borderWidth","onClose","c","redrawCanvas","refreshRadius","drawCircle","theFirst","fillStyle","fontDecoration","textAlign","fillText","makeTextUnderline","drawTextCircle","textWidth","measureText","startY","endY","underlineHeight","startX","endX","lineWidth","arc","PI","fill","closePath","save","translate","rotate","num","rad","j","restore","toggleColorPicker","bg","selectColor","selectBorderWidth","deleteCanvas","getLeft","getTop","calcDiff","resize","closeColorPickerBG","closeColorPickerC","getTranslation","inactive","SignatureTabActivatorService","SignatureLeftPanelComponent","newSignatureEvent","showNewCode","showUpload","getRefreshSignatures","getTitleIcon","getTitle","getName","closeUploadPanel","closeCodePanel","getCodeName","closeNewSignature","openNewSignature","HandModalComponent","_tabActivationService","defaultColor","selectedColor","colorPickerShow","saveSign","canvasComponent","closePicker","onCloseOpen","StampModalComponent","stampCircles","textString","showText","sizeMagnifier","textProps","removeCanvas","activeId","size","lastProps","ctx","drawImage","reverse","addCircle","stampCircle","addCanvas","addText","toggleText","toggleUnderline","toggleBold","toggleItalic","selectTextColor","selectFont","selectFontSize","deleteText","leaveText","getTextWidth","HostDynamicDirective","initializeApp","signatureConfigService","setupLoadingInterceptor","service","LoadingMaskInterceptorService","SignatureModule","library","fas","far","forRoot","apiEndpoint","DEFAULT_API_ENDPOINT","ngModule","NgModule","declarations","exports","CommonComponentsModule","imports","CommonModule","HttpClientModule","FontAwesomeModule","ClickOutsideModule","providers","provide","HTTP_INTERCEPTORS","useClass","ErrorInterceptorService","multi","APP_INITIALIZER","useFactory","deps","LoadingMaskService","entryComponents"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient, HttpResponse} from \"@angular/common/http\";\r\nimport {Api, ConfigService, FileCredentials, FileUtil, Utils} from \"@groupdocs.examples.angular/common-components\";\r\nimport {AddedSignature, DraggableSignature, FileListWithParams, SignatureProps} from \"./signature-models\";\r\nimport {map} from \"rxjs/operators\";\r\nimport { Subject, Observable } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignatureService {\r\n  private _observer: Subject<any> = new Subject();\r\n  private readonly _refreshSignatures: Observable<any> = this._observer.asObservable();\r\n\r\n  constructor(private _http: HttpClient, private _config: ConfigService) {\r\n  }\r\n\r\n  get getRefreshSignatures(): Observable<any> {\r\n    return this._refreshSignatures;\r\n  }\r\n\r\n  loadFiles(path: string) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_FILE_TREE, {'path': path}, Api.httpOptionsJson);\r\n  }\r\n\r\n  loadFile(credentials: FileCredentials) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_DOCUMENT_DESCRIPTION, credentials, Api.httpOptionsJson);\r\n  }\r\n\r\n  upload(file: File, url: string, rewrite: boolean, signType: string) {\r\n    const formData = new FormData();\r\n    formData.append(\"file\", file);\r\n    formData.append('rewrite', String(rewrite));\r\n    if (signType) {\r\n      formData.append(\"signatureType\", signType);\r\n    }\r\n    if (url) {\r\n      formData.append(\"url\", url);\r\n    }\r\n\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.UPLOAD_DOCUMENTS, formData);\r\n  }\r\n\r\n  loadPage(credentials: FileCredentials, page: number) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_DOCUMENT_PAGE, {\r\n      'guid': credentials.guid,\r\n      'password': credentials.password,\r\n      'page': page\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  getDownloadUrl(credentials: FileCredentials) {\r\n    return this._config.getSignatureApiEndpoint() + Api.DOWNLOAD_DOCUMENTS + '/?path=' + credentials.guid;\r\n  }\r\n\r\n  loadPrint(credentials: FileCredentials) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_PRINT, {\r\n      'guid': credentials.guid,\r\n      'password': credentials.password,\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  loadPrintPdf(credentials: FileCredentials) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_PRINT_PDF, {\r\n      'guid': credentials.guid,\r\n      'password': credentials.password,\r\n    }, Api.httpOptionsJsonResponseTypeBlob);\r\n  }\r\n\r\n  getSignatures(path: string, type: string) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_FILE_TREE, {\r\n      'path': path,\r\n      'signatureType': type\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  removeSignatures(guid: string, type: string) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.DELETE_SIGNATURE_FILE, {\r\n      'guid': guid,\r\n      'signatureType': type\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  uploadSignature(data: FileListWithParams, rewrite: boolean) {\r\n    if (data.fileList.length > 1) {\r\n      for (let i = 0; i < data.fileList.length - 1; i++) {\r\n        this.upload(data.fileList.item(i), '', rewrite, data.signType);\r\n      }\r\n    }\r\n    return this.upload(data.fileList.item(data.fileList.length - 1), '', rewrite, data.signType);\r\n  }\r\n\r\n  getCode(text: string, temp: boolean, type: string) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_OPTICAL_CODE, {\r\n      'properties': {'text': text, 'temp': temp},\r\n      'signatureType': type\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  loadSignatureImage(sign: DraggableSignature) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_SIGNATURE_IMAGE, {\r\n      'guid': sign.guid,\r\n      'page': sign.pageNumber,\r\n      'signatureType': sign.type,\r\n      'password': ''\r\n    }, Api.httpOptionsJson).pipe(\r\n      map((props: AddedSignature) => {\r\n        props.guid = sign.guid;\r\n        return props;\r\n      }));\r\n  }\r\n\r\n  saveTextSignature(data: AddedSignature) {\r\n    const properties = data.props;\r\n    properties.fontColor = Utils.toRgb(properties.fontColor);\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_TEXT, {\r\n      'properties': properties\r\n    }, Api.httpOptionsJson).pipe(\r\n      map((props: SignatureProps) => {\r\n        props.fontColor = Utils.toHex(props.fontColor);\r\n        return props;\r\n      }));\r\n  }\r\n\r\n  saveImage(img: string) {\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_IMAGE, {\r\n      'image': img\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  saveStamp(img: string, props: any[]) {\r\n    for (const properties of props) {\r\n      properties.backgroundColor = Utils.toRgb(properties.backgroundColor);\r\n      properties.strokeColor = Utils.toRgb(properties.strokeColor);\r\n      properties.textColor = Utils.toRgb(properties.textColor);\r\n    }\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_STAMP, {\r\n      'image': img,\r\n      'stampData': props\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  sign(credentials: FileCredentials, signatures: any[]) {\r\n    const docType = FileUtil.find(credentials.guid, false).format;\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SIGN, {\r\n      guid: credentials.guid,\r\n      password: credentials.password ? credentials.password : \"\",\r\n      signaturesData: signatures,\r\n      documentType: docType\r\n    }, Api.httpOptionsJson);\r\n  }\r\n\r\n  downloadSigned(credentials: FileCredentials, signatures: any[]) {\r\n    const docType = FileUtil.find(credentials.guid, false).format;\r\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.DOWNLOAD_SIGNED, {\r\n      guid: credentials.guid,\r\n      password: credentials.password,\r\n      signaturesData: signatures,\r\n      documentType: docType\r\n    }, Api.httpOptionsJsonResponseTypeBlob);\r\n  }\r\n\r\n  refreshSignatures() {\r\n    this._observer.next();\r\n  }\r\n}\r\n","export class SignatureConfig {\r\n  rewrite: boolean;\r\n  pageSelector: boolean;\r\n  download: boolean;\r\n  upload: boolean;\r\n  print: boolean;\r\n  browse: boolean;\r\n  enableRightClick: boolean;\r\n\r\n  filesDirectory: string;\r\n  fontsDirectory: string;\r\n  defaultDocument: string;\r\n  preloadPageCount: 0;\r\n  textSignature: boolean;\r\n  imageSignature: boolean;\r\n  digitalSignature: boolean;\r\n  qrCodeSignature: boolean;\r\n  barCodeSignature: boolean;\r\n  stampSignature: boolean;\r\n  handSignature: boolean;\r\n  downloadOriginal: boolean;\r\n  downloadSigned: boolean;\r\n\r\n  zoom: boolean;\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {BehaviorSubject, Observable} from \"rxjs\";\r\nimport {HttpClient} from \"@angular/common/http\";\r\nimport {Api, ConfigService} from \"@groupdocs.examples.angular/common-components\";\r\nimport {SignatureConfig} from \"./signature-config\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SignatureConfigService {\r\n\r\n  private _signatureConfig: BehaviorSubject<SignatureConfig> = new BehaviorSubject(new SignatureConfig());\r\n  private _updatedConfig: Observable<SignatureConfig> = this._signatureConfig.asObservable();\r\n\r\n  constructor(private _http: HttpClient, private _config: ConfigService) {\r\n  }\r\n\r\n  get updatedConfig() {\r\n    return this._updatedConfig;\r\n  }\r\n\r\n  load() {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const configEndpoint = this._config.getConfigEndpoint(Api.SIGNATURE_APP);\r\n      this._http.get(configEndpoint, Api.httpOptionsJson).toPromise().then((response: SignatureConfig) => {\r\n        const signatureConfig = <SignatureConfig>response;\r\n        this._signatureConfig.next(signatureConfig);\r\n        resolve();\r\n      }).catch((response: any) => {\r\n        reject(`Could not load signature config: ${JSON.stringify(response)}`);\r\n      });\r\n    });\r\n  }\r\n}\r\n","import {Formatting} from \"@groupdocs.examples.angular/common-components\";\r\n\r\nexport class Signature {\r\n  guid: string;\r\n  image: string;\r\n  name: string;\r\n  text: string;\r\n  fontColor: string;\r\n}\r\n\r\nexport class SignatureType {\r\n  public static TEXT = {id: 'text', name: 'Text signatures', icon: 'font', title: ''};\r\n  public static IMAGE = {id: 'image', name: 'Uploaded Images', icon: 'image', title: 'Add image signature'};\r\n  public static QR_CODE = {id: 'qrCode', name: 'QR codes', icon: 'qrcode', title: 'New QR code'};\r\n  public static BAR_CODE = {id: 'barCode', name: 'Bar codes', icon: 'barcode', title: 'New Bar code'};\r\n  public static DIGITAL = {\r\n    id: 'digital',\r\n    name: 'Digital signatures',\r\n    icon: 'fingerprint',\r\n    title: 'New digital signature'\r\n  };\r\n  public static STAMP = {id: 'stamp', name: 'Stamps', icon: 'stamp', title: ''};\r\n  public static HAND = {id: 'hand', name: 'Signatures', icon: 'signature', title: ''};\r\n\r\n  public static getSignatureType(id: string) {\r\n    switch (id) {\r\n      case SignatureType.TEXT.id:\r\n        return SignatureType.TEXT;\r\n      case SignatureType.IMAGE.id:\r\n        return SignatureType.IMAGE;\r\n      case SignatureType.DIGITAL.id:\r\n        return SignatureType.DIGITAL;\r\n      case SignatureType.QR_CODE.id:\r\n        return SignatureType.QR_CODE;\r\n      case SignatureType.BAR_CODE.id:\r\n        return SignatureType.BAR_CODE;\r\n      case SignatureType.STAMP.id:\r\n        return SignatureType.STAMP;\r\n      case SignatureType.HAND.id:\r\n        return SignatureType.HAND;\r\n    }\r\n  }\r\n}\r\n\r\nexport class FileListWithParams {\r\n  fileList: FileList;\r\n  signType: string;\r\n\r\n  constructor(fileList: FileList, signType: string) {\r\n    this.fileList = fileList;\r\n    this.signType = signType;\r\n  }\r\n}\r\n\r\nexport class OpticalCodeModel {\r\n  encodedImage: string;\r\n  text: string;\r\n  temp: boolean;\r\n}\r\n\r\nexport class DraggableSignature {\r\n  public static TEMP = \"temp\";\r\n  guid: string;\r\n  type: string;\r\n  position: Position;\r\n  pageNumber: number;\r\n  digitalProps: DigitalSign;\r\n}\r\n\r\nexport class Position {\r\n  left: number;\r\n  top: number;\r\n\r\n  constructor(left: number, top: number) {\r\n    this.left = left;\r\n    this.top = top;\r\n  }\r\n}\r\n\r\nexport class SignatureData {\r\n  reason: string;\r\n  contact: string;\r\n  address: string;\r\n  date: string;\r\n  signaturePassword: string;\r\n  signatureGuid: string;\r\n  signatureType: string;\r\n  pageNumber: number;\r\n  left: number;\r\n  top: number;\r\n  imageWidth: number;\r\n  imageHeight: number;\r\n  angle: number;\r\n\r\n  public static map(data: AddedSignature, type: string, position: Position) {\r\n    const ret = new SignatureData();\r\n    ret.signatureType = type;\r\n    ret.pageNumber = data.number;\r\n    ret.left = position.left;\r\n    ret.top = position.top;\r\n    ret.signatureGuid = data.guid;\r\n    ret.imageWidth = data.width;\r\n    ret.imageHeight = data.height;\r\n    if (data.digitalProps) {\r\n      ret.reason = data.digitalProps.reason;\r\n      ret.contact = data.digitalProps.contact;\r\n      ret.address = data.digitalProps.address;\r\n      ret.signaturePassword = data.digitalProps.signaturePassword;\r\n      ret.date = data.digitalProps.date;\r\n    }\r\n\r\n    return ret;\r\n  }\r\n}\r\n\r\nexport class DigitalSign {\r\n  reason: string;\r\n  contact: string;\r\n  address: string;\r\n  date: string;\r\n  signaturePassword: string;\r\n}\r\n\r\nexport class AddedSignature {\r\n\r\n  constructor() {\r\n    this.height = 0;\r\n    this.width = 0;\r\n  }\r\n\r\n  guid: string;\r\n  props: SignatureProps;\r\n  data: string;\r\n  width: number;\r\n  height: number;\r\n  number: number;\r\n  digitalProps: DigitalSign;\r\n}\r\n\r\nexport class SignatureProps {\r\n  imageGuid: string;\r\n  text: string;\r\n  width: number;\r\n  height: number;\r\n  bold: boolean;\r\n  italic: boolean;\r\n  underline: boolean;\r\n  font: string;\r\n  fontSize: number;\r\n  fontColor: string;\r\n\r\n  public static getDefault(): SignatureProps {\r\n    const props = new SignatureProps();\r\n    props.text = \"\";\r\n    const f = Formatting.default();\r\n    props.fontColor = f.color;\r\n    props.font = f.font;\r\n    props.fontSize = f.fontSize;\r\n    props.underline = f.underline;\r\n    props.bold = f.bold;\r\n    props.italic = f.italic;\r\n    return props;\r\n  }\r\n}\r\n\r\nexport class RemoveSign {\r\n  guid: string;\r\n  id: number;\r\n  type: string;\r\n}\r\n\r\nexport class CopySign {\r\n  guid: string;\r\n  id: number;\r\n  type: string;\r\n}\r\n\r\nexport class CopyChanges {\r\n  guid: string;\r\n  id: number;\r\n  width: number;\r\n  height: number;\r\n  position: Position;\r\n  props: SignatureProps;\r\n}\r\n\r\nexport class StampCanvasProps {\r\n  id: number;\r\n  text: string;\r\n  width: number;\r\n  height: number;\r\n  zIndex: number;\r\n  backgroundColor: string;\r\n  strokeColor: string;\r\n  strokeWidth: number;\r\n  fontSize: number;\r\n  font: string;\r\n  textColor: string;\r\n  radius: number;\r\n  bold: boolean;\r\n  italic: boolean;\r\n  underline: boolean;\r\n  textExpansion = 0.173;\r\n  textRepeat = 1;\r\n\r\n  constructor() {\r\n  }\r\n\r\n  init(isMobile) {\r\n    this.text = \"\";\r\n    this.width = isMobile ? 103 : 153;\r\n    this.height = isMobile ? 103 : 153;\r\n    this.zIndex = 10;\r\n    this.backgroundColor = \"rgb(255, 255, 255)\";\r\n    this.strokeColor = \"rgb(51, 51, 51)\";\r\n    this.strokeWidth = 1;\r\n    this.fontSize = 19;\r\n    this.font = \"Arial\";\r\n    this.textColor = \"rgb(51, 51, 51)\";\r\n    this.radius = 76.5;\r\n    this.bold = false;\r\n    this.italic = false;\r\n    this.underline = false;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class Border {\r\n  public static widthOptions() {\r\n    const ret = []\r\n    for (let i = 1; i <= 10; i++) {\r\n      ret.push(this.widthOption(i));\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  public static widthOption(width: number) {\r\n    return {value: width, name: width + 'px', separator: false}\r\n  }\r\n}\r\n\r\nexport class Downloads {\r\n  public static original = 'original';\r\n  public static signed = 'signed';\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\nimport {DraggableSignature} from \"./signature-models\";\r\n\r\nexport class SelectSignatureService {\r\n  private _observer: Subject<DraggableSignature> = new Subject();\r\n  private readonly _selectSignature: Observable<DraggableSignature> = this._observer.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get selectSignature(): Observable<DraggableSignature> {\r\n    return this._selectSignature;\r\n  }\r\n\r\n  select(sign: DraggableSignature): void {\r\n    this._observer.next(sign);\r\n  }\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\nimport {RemoveSign} from \"./signature-models\";\r\n\r\nexport class RemoveSignatureService {\r\n  private _observer: Subject<RemoveSign> = new Subject();\r\n  private readonly _removeSignature: Observable<RemoveSign> = this._observer.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get removeSignature(): Observable<RemoveSign> {\r\n    return this._removeSignature;\r\n  }\r\n\r\n  remove(id: RemoveSign): void {\r\n    this._observer.next(id);\r\n  }\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\n\r\nexport class ActiveSignatureService {\r\n  private _observer: Subject<number> = new Subject();\r\n  private readonly _activeChange: Observable<number> = this._observer.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get activeChange(): Observable<number> {\r\n    return this._activeChange;\r\n  }\r\n\r\n  changeActive(signId: number) {\r\n    this._observer.next(signId);\r\n  }\r\n}\r\n","import {DraggableSignature} from \"./signature-models\";\r\n\r\nexport class SignaturesHolderService {\r\n\r\n  private map = new Map<string, number[]>();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  add(key: string) {\r\n    this.map.set(key, []);\r\n  }\r\n\r\n  addId(key: string, id: number) {\r\n    if (!this.map.has(key)) {\r\n      this.add(key);\r\n    }\r\n    const item = this.map.get(key);\r\n    item.push(id);\r\n  }\r\n\r\n  delete(key: string) {\r\n    this.map.delete(key);\r\n  }\r\n\r\n  has(key: string) {\r\n    return this.map.has(key);\r\n  }\r\n\r\n  clear() {\r\n    this.map.clear();\r\n  }\r\n\r\n  values() {\r\n    return this.map.values();\r\n  }\r\n\r\n  get(key: string) {\r\n    return this.map.get(key);\r\n  }\r\n\r\n  remove(key: string, id: number) {\r\n    const items = this.map.get(key);\r\n    this.delete(key);\r\n    if (items.length !== 1) {\r\n      this.add(key);\r\n      for (const elem of items) {\r\n        if (elem !== id) {\r\n          this.map.get(key).push(elem);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  changeTemp(imageGuid: string, id: number) {\r\n    this.remove(DraggableSignature.TEMP, id);\r\n    this.addId(imageGuid, id);\r\n  }\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\nimport {CopyChanges, CopySign} from \"./signature-models\";\r\n\r\nexport class CopySignatureService {\r\n  private _observer: Subject<CopySign> = new Subject();\r\n  private readonly _copySignature: Observable<CopySign> = this._observer.asObservable();\r\n  private _observerChanges: Subject<CopyChanges> = new Subject();\r\n  private readonly _changesSignature: Observable<CopyChanges> = this._observerChanges.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get copySignature(): Observable<CopySign> {\r\n    return this._copySignature;\r\n  }\r\n\r\n  copy(copySign: CopySign): void {\r\n    this._observer.next(copySign);\r\n  }\r\n\r\n  get changesSignature(): Observable<CopyChanges> {\r\n    return this._changesSignature;\r\n  }\r\n\r\n  notifyChanges(changes: CopyChanges): void {\r\n    this._observerChanges.next(changes);\r\n  }\r\n}\r\n","import {AfterViewInit, Component, Input, OnInit, AfterViewChecked} from '@angular/core';\r\nimport {\r\n  Position,\r\n  AddedSignature,\r\n  SignatureType,\r\n  SignatureProps,\r\n  RemoveSign,\r\n  DraggableSignature,\r\n  CopySign,\r\n  CopyChanges\r\n} from \"../signature-models\";\r\nimport {Formatting, Utils, MenuType, ZoomService} from \"@groupdocs.examples.angular/common-components\";\r\nimport {SignatureService} from \"../signature.service\";\r\nimport {RemoveSignatureService} from \"../remove-signature.service\";\r\nimport {ActiveSignatureService} from \"../active-signature.service\";\r\nimport * as jquery from 'jquery';\r\nimport {SignaturesHolderService} from \"../signatures-holder.service\";\r\nimport {CopySignatureService} from \"../copy-signature.service\";\r\nimport {Subject} from \"rxjs\";\r\nimport {debounceTime} from \"rxjs/operators\";\r\n\r\nconst $ = jquery;\r\n\r\n@Component({\r\n  selector: 'gd-signature-component',\r\n  templateUrl: './signature.component.html',\r\n  styleUrls: ['./signature.component.less']\r\n})\r\nexport class Signature implements OnInit, AfterViewInit, AfterViewChecked {\r\n  @Input() id: number;\r\n  @Input() data: AddedSignature;\r\n  @Input() position: Position;\r\n  @Input() type: string;\r\n  @Input() pageWidth: number;\r\n  @Input() pageHeight: number;\r\n  active = true;\r\n  unlock = true;\r\n  copied = false;\r\n  baseCopied = false;\r\n  private oldPosition: { x: number; y: number };\r\n\r\n  private subject: Subject<string> = new Subject();\r\n\r\n  constructor(private _signatureService: SignatureService,\r\n              private _removeSignatureService: RemoveSignatureService,\r\n              private _copySignatureService: CopySignatureService,\r\n              private _activeSignatureService: ActiveSignatureService,\r\n              private _signaturesHolderService: SignaturesHolderService,\r\n              private _zoomService: ZoomService) {\r\n\r\n    this._activeSignatureService.activeChange.subscribe((id: number) => {\r\n      if (this.id === id) {\r\n        this.active = true;\r\n      } else {\r\n        this.active = false;\r\n      }\r\n    });\r\n\r\n    this.subject.pipe(\r\n      debounceTime(300)\r\n    ).subscribe(text => {\r\n      this.notifyChanges();\r\n      this.sendSaveText();\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewChecked() {\r\n    this._zoomService.changeZoom(this._zoomService.zoom);\r\n  }\r\n\r\n  getData() {\r\n    return 'data:image/png;base64,' + this.data.data;\r\n  }\r\n\r\n  dragOver($event: DragEvent) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n  }\r\n\r\n  dragStart($event: DragEvent) {\r\n    $event.preventDefault();\r\n    this.oldPosition = Utils.getMousePosition($event);\r\n    if ($event.dataTransfer) {\r\n      $event.dataTransfer.setData('text', 'foo');\r\n    }\r\n  }\r\n\r\n  dragging($event) {\r\n    $event.preventDefault();\r\n    const position = Utils.getMousePosition($event);\r\n    if (position.x && position.y && this.isOnPage(position)) {\r\n      const left = position.x - this.oldPosition.x;\r\n      const top = position.y - this.oldPosition.y;\r\n      this.position.left += left;\r\n      this.position.top += top;\r\n      this.correctPosition();\r\n      this.oldPosition = position;\r\n    }\r\n  }\r\n\r\n  isOnPage(position) {\r\n    const currentPage = document.elementFromPoint(position.x, position.y);\r\n    return currentPage && $(currentPage).parent().parent() &&\r\n      ($(currentPage).parent().parent().parent().hasClass(\"page\") ||\r\n        $(currentPage).parent().parent().parent().parent().parent().hasClass(\"page\"));\r\n  }\r\n\r\n  isText() {\r\n    return SignatureType.TEXT.id === this.type;\r\n  }\r\n\r\n  getFormatting() {\r\n    const f = this.data.props;\r\n    const formatting = Formatting.default();\r\n    if (f) {\r\n      formatting.fontSize = f.fontSize;\r\n      formatting.font = f.font;\r\n      formatting.color = f.fontColor;\r\n      formatting.bold = f.bold;\r\n      formatting.underline = f.underline;\r\n      formatting.italic = f.italic;\r\n    }\r\n    return formatting;\r\n  }\r\n\r\n  saveTextSignature($event: Formatting) {\r\n    if (this.data.props) {\r\n      this.fillFormatting($event);\r\n      this.notifyChanges();\r\n      this.sendSaveText();\r\n    }\r\n  }\r\n\r\n  private fillFormatting(formatting: Formatting) {\r\n    this.data.props.fontSize = formatting.fontSize;\r\n    this.data.props.font = formatting.font;\r\n    this.data.props.bold = formatting.bold;\r\n    this.data.props.italic = formatting.italic;\r\n    this.data.props.underline = formatting.underline;\r\n    this.data.props.fontColor = formatting.color;\r\n  }\r\n\r\n  remove() {\r\n    const del = new RemoveSign();\r\n    del.guid = this.data.guid;\r\n    del.id = this.id;\r\n    del.type = this.type;\r\n    this._removeSignatureService.remove(del);\r\n  }\r\n\r\n  activation() {\r\n    this._activeSignatureService.changeActive(this.id);\r\n  }\r\n\r\n  isDigital() {\r\n    return this.type === SignatureType.DIGITAL.id;\r\n  }\r\n\r\n  width($event) {\r\n    this.data.width += $event;\r\n    if (!this.unlock) {\r\n      this.data.height += $event;\r\n    }\r\n    this.correctPosition();\r\n    this.notifyChanges();\r\n  }\r\n\r\n  height($event) {\r\n    this.data.height += $event;\r\n    if (!this.unlock) {\r\n      this.data.width += $event;\r\n    }\r\n    this.correctPosition();\r\n    this.notifyChanges();\r\n  }\r\n\r\n  left($event) {\r\n    if (this.unlock) {\r\n      this.position.left += $event;\r\n    }\r\n    this.correctPosition();\r\n    this.notifyChanges();\r\n  }\r\n\r\n  top($event) {\r\n    if (this.unlock) {\r\n      this.position.top += $event;\r\n    }\r\n    this.correctPosition();\r\n    this.notifyChanges();\r\n  }\r\n\r\n  notifyChanges() {\r\n    const changes = new CopyChanges();\r\n    changes.guid = this.data.guid;\r\n    changes.id = this.id;\r\n    changes.position = this.position;\r\n    changes.width = this.data.width;\r\n    changes.height = this.data.height;\r\n    changes.props = this.data.props;\r\n    this._copySignatureService.notifyChanges(changes);\r\n  }\r\n\r\n  drop($event: DragEvent) {\r\n    $event.stopPropagation();\r\n    $event.preventDefault();\r\n  }\r\n\r\n  isInit() {\r\n    return this.data.width === 0 && this.data.height === 0;\r\n  }\r\n\r\n  onCopySign() {\r\n    const copy = new CopySign();\r\n    copy.guid = this.data.guid;\r\n    copy.id = this.id;\r\n    copy.type = this.type;\r\n    this._copySignatureService.copy(copy);\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    if (this.type === SignatureType.TEXT.id) {\r\n      setTimeout(() => {\r\n        const element = $(\"#text\");\r\n        if (element) {\r\n          element.focus();\r\n        }\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  private correctPosition() {\r\n    if (this.position.left < 0) {\r\n      this.position.left = 0;\r\n    }\r\n    if (this.position.top < 0) {\r\n      this.position.top = 0;\r\n    }\r\n    if (this.position.top + this.data.height > this.pageHeight) {\r\n      this.position.top = this.pageHeight - this.data.height;\r\n    }\r\n    if (this.position.left + this.data.width > this.pageWidth) {\r\n      this.position.left = this.pageWidth - this.data.width;\r\n    }\r\n  }\r\n\r\n  saveText(value: string) {\r\n    this.data.props.text = value;\r\n    this.subject.next(value);\r\n  }\r\n\r\n  private sendSaveText() {\r\n    this._signatureService.saveTextSignature(this.data).subscribe((p: SignatureProps) => {\r\n      if (DraggableSignature.TEMP === this.data.guid) {\r\n        this._signaturesHolderService.changeTemp(p.imageGuid, this.id);\r\n        this.data.guid = p.imageGuid;\r\n      }\r\n      this.data.props = p;\r\n    });\r\n  }\r\n\r\n  hideMenu($event) {\r\n    this._activeSignatureService.changeActive(null);\r\n  }\r\n\r\n  getMenuShift() {\r\n    const menuWidth = this.type === SignatureType.TEXT.id ? 426 : 148;\r\n    let shift = this.data.width > menuWidth ? 0 : (this.data.width - menuWidth) * 0.5;\r\n    if (this.position.left - (menuWidth - this.data.width) / 2 < 0) {\r\n      shift -= (this.position.left - (menuWidth - this.data.width) / 2);\r\n    }\r\n    if (this.position.left + (menuWidth + this.data.width) / 2 > this.pageWidth) {\r\n      shift -= (this.position.left + (menuWidth + this.data.width) / 2 - this.pageWidth);\r\n    }\r\n    return shift;\r\n  }\r\n\r\n  getMenuType() {\r\n    return MenuType.FOR_SIGNATURE;\r\n  }\r\n}\r\n","import {DraggableSignature} from \"./signature-models\";\r\n\r\nexport class DragSignatureService {\r\n  public sign: DraggableSignature;\r\n\r\n  constructor() {\r\n  }\r\n}\r\n","import {Component, ComponentRef, OnDestroy, OnInit} from '@angular/core';\r\nimport {SignatureService} from \"./signature.service\";\r\nimport {\r\n  FileDescription,\r\n  FileModel,\r\n  ModalService,\r\n  UploadFilesService,\r\n  NavigateService,\r\n  PagePreloadService,\r\n  PageModel,\r\n  ZoomService,\r\n  RenderPrintService,\r\n  FileUtil,\r\n  PasswordService,\r\n  FileCredentials,\r\n  CommonModals,\r\n  HostingDynamicComponentService,\r\n  AddDynamicComponentService,\r\n  OnCloseService,\r\n  ExceptionMessageService,\r\n  WindowService,\r\n  Utils,\r\n  TabActivatorService,\r\n  TopTabActivatorService\r\n} from \"@groupdocs.examples.angular/common-components\";\r\nimport {SignatureConfig} from \"./signature-config\";\r\nimport {SignatureConfigService} from \"./signature-config.service\";\r\nimport {\r\n  AddedSignature,\r\n  CopyChanges,\r\n  CopySign,\r\n  DraggableSignature,\r\n  Position, RemoveSign,\r\n  SignatureData, SignatureProps,\r\n  SignatureType\r\n} from \"./signature-models\";\r\nimport {SelectSignatureService} from \"./select-signature.service\";\r\nimport {Signature} from \"./signature/signature.component\";\r\nimport {DragSignatureService} from \"./drag-signature.service\";\r\nimport {RemoveSignatureService} from \"./remove-signature.service\";\r\nimport {ActiveSignatureService} from \"./active-signature.service\";\r\nimport {SignaturesHolderService} from \"./signatures-holder.service\";\r\nimport 'hammerjs';\r\nimport {CopySignatureService} from \"./copy-signature.service\";\r\nimport * as jquery from 'jquery';\r\n\r\nconst $ = jquery;\r\n\r\n@Component({\r\n  selector: 'gd-signature',\r\n  templateUrl: './signature-app.component.html',\r\n  styleUrls: ['./signature-app.component.less']\r\n})\r\nexport class SignatureAppComponent implements OnDestroy, OnInit {\r\n  title = 'signature';\r\n  files: FileModel[] = [];\r\n  file: FileDescription;\r\n  signatureConfig: SignatureConfig;\r\n  countPages = 0;\r\n  formatDisabled = !this.file;\r\n  credentials: FileCredentials;\r\n  browseFilesModal = CommonModals.BrowseFiles;\r\n  isDesktop: boolean;\r\n  signatureTypes = [\r\n    SignatureType.TEXT,\r\n    SignatureType.IMAGE,\r\n    SignatureType.DIGITAL,\r\n    SignatureType.QR_CODE,\r\n    SignatureType.BAR_CODE,\r\n    SignatureType.STAMP,\r\n    SignatureType.HAND,\r\n  ];\r\n  signatureTypeCodes = [\r\n    SignatureType.QR_CODE,\r\n    SignatureType.BAR_CODE,\r\n  ];\r\n\r\n  signatureComponents = new Map<number, ComponentRef<any>>();\r\n  activeSignatureTab: string;\r\n  isLoading: boolean;\r\n  fileWasDropped = false;\r\n\r\n  _zoom = 100;\r\n  _pageWidth: number;\r\n  _pageHeight: number;\r\n\r\n  constructor(private _signatureService: SignatureService,\r\n              private _modalService: ModalService,\r\n              configService: SignatureConfigService,\r\n              uploadFilesService: UploadFilesService,\r\n              private _navigateService: NavigateService,\r\n              private _zoomService: ZoomService,\r\n              pagePreloadService: PagePreloadService,\r\n              private _renderPrintService: RenderPrintService,\r\n              passwordService: PasswordService,\r\n              private _windowService: WindowService,\r\n              private _selectSignatureService: SelectSignatureService,\r\n              private _signatureTabActivationService: TopTabActivatorService,\r\n              private _hostingComponentsService: HostingDynamicComponentService,\r\n              private _addDynamicComponentService: AddDynamicComponentService,\r\n              private _dragSignatureService: DragSignatureService,\r\n              private _onCloseService: OnCloseService,\r\n              removeSignatureService: RemoveSignatureService,\r\n              private _activeSignatureService: ActiveSignatureService,\r\n              private _excMessageService: ExceptionMessageService,\r\n              private _signaturesHolderService: SignaturesHolderService,\r\n              private _tabActivatorService: TabActivatorService,\r\n              copySignatureService: CopySignatureService) {\r\n\r\n    this._tabActivatorService.activeTabChange.subscribe((tabId: string) => {\r\n      if (tabId === '1') {\r\n        if (this.activeSignatureTab) {\r\n          this._signatureTabActivationService.changeActiveTab(this.activeSignatureTab);\r\n        }\r\n        this.activeSignatureTab = null;\r\n      }\r\n    });\r\n\r\n    this.isDesktop = _windowService.isDesktop();\r\n    _windowService.onResize.subscribe((w) => {\r\n      if (!_windowService.isMobile()) {\r\n        this.isDesktop = _windowService.isDesktop();\r\n        if (!this.isDesktop) {\r\n          this.refreshZoom();\r\n        }\r\n      }\r\n    });\r\n\r\n    copySignatureService.copySignature.subscribe((copySign: CopySign) => {\r\n      const componentRef = this.signatureComponents.get(copySign.id);\r\n      if (componentRef) {\r\n        // @ts-ignore\r\n        const comp = (<Signature>componentRef).instance;\r\n        const compPage = comp.data.number;\r\n        comp.baseCopied = true;\r\n        for (const page of this.file.pages) {\r\n          if (page.number !== compPage) {\r\n            const sign = this.createDraggableSign(comp, copySign, page);\r\n            const addedSignature = this.createAddedSignature(copySign, comp, page);\r\n            const id = this.addSignatureComponent(addedSignature, sign, page, true);\r\n            this._signaturesHolderService.addId(sign.guid, id);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    copySignatureService.changesSignature.subscribe((copyChanges: CopyChanges) => {\r\n      const componentRef = this.signatureComponents.get(copyChanges.id);\r\n      if (componentRef) {\r\n        const ids = this._signaturesHolderService.get(copyChanges.guid);\r\n        for (const id of ids) {\r\n          const compRef = this.signatureComponents.get(id);\r\n          if (compRef) {\r\n            // @ts-ignore\r\n            const comp = (<Signature>compRef).instance;\r\n            if (comp.id !== copyChanges.id && (comp.copied || comp.baseCopied)) {\r\n              comp.data.width = copyChanges.width;\r\n              comp.data.height = copyChanges.height;\r\n              comp.data.position = copyChanges.position;\r\n              comp.data.props = copyChanges.props;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    removeSignatureService.removeSignature.subscribe((del: RemoveSign) => {\r\n      const ids = this._signaturesHolderService.get(del.guid);\r\n      for (const id of ids) {\r\n        if (del.type === SignatureType.DIGITAL.id || del.id === id) {\r\n          const componentRef = this.signatureComponents.get(id);\r\n          if (componentRef) {\r\n            componentRef.destroy();\r\n          }\r\n          this.signatureComponents.delete(id);\r\n          this._signaturesHolderService.remove(del.guid, id);\r\n        }\r\n      }\r\n    });\r\n\r\n    configService.updatedConfig.subscribe((signatureConfig) => {\r\n      this.signatureConfig = signatureConfig;\r\n    });\r\n\r\n    uploadFilesService.uploadsChange.subscribe((uploads) => {\r\n      if (uploads) {\r\n        let i: number;\r\n        for (i = 0; i < uploads.length; i++) {\r\n          this._signatureService.upload(uploads.item(i), '', this.rewriteConfig, null).subscribe((obj: FileCredentials) => {\r\n            this.fileWasDropped ? this.selectFile(obj.guid, '', '') : this.selectDir('');\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    pagePreloadService.checkPreload.subscribe((page: number) => {\r\n      if (this.preloadPageCountConfig !== 0) {\r\n        for (let i = page; i < page + 2; i++) {\r\n          if (i > 0 && i <= this.countPages && !this.file.pages[i - 1].data) {\r\n            this.preloadPages(i, i);\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    passwordService.passChange.subscribe((pass: string) => {\r\n      this.selectFile(this.credentials.guid, pass, CommonModals.PasswordRequired);\r\n    });\r\n\r\n    _selectSignatureService.selectSignature.subscribe((sign: DraggableSignature) => {\r\n      this.selectSignature(sign);\r\n    });\r\n\r\n    this.isDesktop = _windowService.isDesktop();\r\n    _windowService.onResize.subscribe((w) => {\r\n      this.isDesktop = _windowService.isDesktop();\r\n    });\r\n  }\r\n\r\n  private createDraggableSign(comp, copySign: CopySign, page) {\r\n    const sign = new DraggableSignature();\r\n    sign.type = comp.type;\r\n    sign.guid = copySign.guid;\r\n    sign.position = comp.position;\r\n    sign.pageNumber = page.number;\r\n    return sign;\r\n  }\r\n\r\n  private createAddedSignature(copySign: CopySign, comp, page) {\r\n    const addedSignature = new AddedSignature();\r\n    addedSignature.guid = copySign.guid;\r\n    addedSignature.data = comp.data.data;\r\n    if (comp.data.props) {\r\n      addedSignature.props = comp.data.props;\r\n    }\r\n    addedSignature.width = comp.data.width;\r\n    addedSignature.height = comp.data.height;\r\n    addedSignature.number = page.number;\r\n    return addedSignature;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.defaultDocumentConfig()) {\r\n      this.isLoading = true;\r\n      this.selectFile(this.defaultDocumentConfig(), \"\", \"\");\r\n    }\r\n  }\r\n\r\n  private ptToPx(pt: number) {\r\n    //pt * 96 / 72 = px.\r\n    return pt * 96 / 72;\r\n  }\r\n\r\n  private getFitToWidth() {\r\n    // Images and Excel-related files receiving dimensions in px from server\r\n    const pageWidth = this.ptToPx(this._pageWidth);\r\n    const pageHeight = this.ptToPx(this._pageHeight);\r\n    const offsetWidth = pageWidth ? pageWidth : window.innerWidth;\r\n\r\n    return (pageHeight > pageWidth && Math.round(offsetWidth / window.innerWidth) < 2) ? 200 - Math.round(offsetWidth * 100 / window.innerWidth) : Math.round(window.innerWidth * 100 / offsetWidth);\r\n  }\r\n\r\n  set zoom(zoom) {\r\n    this._zoom = zoom;\r\n    this._zoomService.changeZoom(this._zoom);\r\n  }\r\n\r\n  get zoom() {\r\n    return this._zoom;\r\n  }\r\n\r\n  private refreshZoom() {\r\n    this.zoom = this._windowService.isDesktop() ? 100 : this.getFitToWidth();\r\n  }\r\n\r\n  zoomIn() {\r\n    if (this.formatDisabled)\r\n      return;\r\n    if (this._zoom < 490) {\r\n      this.zoom = this._zoom + 10;\r\n    }\r\n  }\r\n\r\n  zoomOut() {\r\n    if (this.formatDisabled)\r\n      return;\r\n    if (this._zoom > 30) {\r\n      this.zoom = this._zoom - 10;\r\n    }\r\n  }\r\n\r\n  get rewriteConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.rewrite : true;\r\n  }\r\n\r\n  get zoomConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.zoom : true;\r\n  }\r\n\r\n  get pageSelectorConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.pageSelector : true;\r\n  }\r\n\r\n  get preloadPageCountConfig(): number {\r\n    return this.signatureConfig ? this.signatureConfig.preloadPageCount : 0;\r\n  }\r\n\r\n  get downloadConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.download : true;\r\n  }\r\n\r\n  get downloadOriginalConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.downloadOriginal : true;\r\n  }\r\n\r\n  get downloadSingedConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.downloadSigned : true;\r\n  }\r\n\r\n  get uploadConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.upload : true;\r\n  }\r\n\r\n  private defaultDocumentConfig() {\r\n    return this.signatureConfig ? this.signatureConfig.defaultDocument : \"\";\r\n  }\r\n\r\n  get printConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.print : true;\r\n  }\r\n\r\n  get browseConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.browse : true;\r\n  }\r\n\r\n  get htmlModeConfig(): boolean {\r\n    return false;\r\n  }\r\n\r\n  get enableRightClickConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.enableRightClick : true;\r\n  }\r\n\r\n  get textSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.textSignature : true;\r\n  }\r\n\r\n  get imageSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.imageSignature : true;\r\n  }\r\n\r\n  get digitalSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.digitalSignature : true;\r\n  }\r\n\r\n  get qrCodeSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.qrCodeSignature : true;\r\n  }\r\n\r\n  get barCodeSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.barCodeSignature : true;\r\n  }\r\n\r\n  get stampSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.stampSignature : true;\r\n  }\r\n\r\n  get handSignatureConfig(): boolean {\r\n    return this.signatureConfig ? this.signatureConfig.handSignature : true;\r\n  }\r\n\r\n  get currentPage(): number {\r\n    return this._navigateService.currentPage;\r\n  }\r\n\r\n  openModal(id: string) {\r\n    this._modalService.open(id);\r\n  }\r\n\r\n  closeModal(id: string) {\r\n    this._modalService.close(id);\r\n  }\r\n\r\n  selectDir($event: string) {\r\n    this._signatureService.loadFiles($event).subscribe((files: FileModel[]) => this.files = files || []);\r\n  }\r\n\r\n  selectFile($event: string, password: string, modalId: string) {\r\n    this.credentials = {guid: $event, password: password};\r\n    this.file = null;\r\n    this._signatureService.loadFile(this.credentials).subscribe((file: FileDescription) => {\r\n        this.file = file;\r\n        this.formatDisabled = !this.file;\r\n        if (file) {\r\n          if (!this.isDesktop && file.pages && file.pages[0]) {\r\n            this._pageHeight = file.pages[0].height;\r\n            this._pageWidth = file.pages[0].width;\r\n            this.refreshZoom();\r\n          }\r\n          const preloadPageCount = this.preloadPageCountConfig;\r\n          const countPages = file.pages ? file.pages.length : 0;\r\n          if (preloadPageCount > 0) {\r\n            this.preloadPages(1, preloadPageCount > countPages ? countPages : preloadPageCount);\r\n          }\r\n          this._navigateService.countPages = countPages;\r\n          this._navigateService.currentPage = 1;\r\n          this.countPages = countPages;\r\n          this.cleanSignatures();\r\n        }\r\n      }\r\n    );\r\n    if (modalId) {\r\n      this._modalService.close(modalId);\r\n    }\r\n    this.clearData();\r\n  }\r\n\r\n  preloadPages(start: number, end: number) {\r\n    for (let i = start; i <= end; i++) {\r\n      this._signatureService.loadPage(this.credentials, i).subscribe((page: PageModel) => {\r\n        this.file.pages[i - 1] = page;\r\n      });\r\n    }\r\n  }\r\n\r\n  upload($event: string) {\r\n    this._signatureService.upload(null, $event, this.rewriteConfig, null).subscribe(() => {\r\n      this.selectDir('');\r\n    });\r\n  }\r\n\r\n  downloadFile() {\r\n    if (this.formatDisabled)\r\n      return;\r\n    window.location.assign(this._signatureService.getDownloadUrl(this.credentials));\r\n  }\r\n\r\n  private clearData() {\r\n    if (!this.file || !this.file.pages) {\r\n      return;\r\n    }\r\n    for (const page of this.file.pages) {\r\n      page.data = null;\r\n    }\r\n  }\r\n\r\n  onRightClick($event: MouseEvent) {\r\n    return this.enableRightClickConfig;\r\n  }\r\n\r\n  getSignatureTypeConfig(id: string) {\r\n    switch (id) {\r\n      case SignatureType.TEXT.id:\r\n        return this.textSignatureConfig;\r\n      case SignatureType.IMAGE.id:\r\n        return this.imageSignatureConfig;\r\n      case SignatureType.DIGITAL.id:\r\n        return this.digitalSignatureConfig;\r\n      case SignatureType.QR_CODE.id:\r\n        return this.qrCodeSignatureConfig;\r\n      case SignatureType.BAR_CODE.id:\r\n        return this.barCodeSignatureConfig;\r\n      case SignatureType.STAMP.id:\r\n        return this.stampSignatureConfig;\r\n      case SignatureType.HAND.id:\r\n        return this.handSignatureConfig;\r\n    }\r\n  }\r\n\r\n  dragOver($event: DragEvent) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n  }\r\n\r\n  dropSignature($event: DragEvent) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n    const position = Utils.getMousePosition($event);\r\n\r\n    const currentPage = document.elementFromPoint(position.x, position.y);\r\n    if (currentPage && $(currentPage).parent().parent() && $(currentPage).parent().parent().parent().hasClass(\"page\")) {\r\n      const documentPage = $(currentPage).parent().parent()[0];\r\n      const left = (position.x - $(documentPage).offset().left)/(this.zoom/100);\r\n      const top = (position.y - $(documentPage).offset().top)/(this.zoom/100);\r\n      const currentPosition = new Position(left, top);\r\n      const sign = this._dragSignatureService.sign;\r\n      if (sign) {\r\n        const id = $(currentPage).parent().attr('id');\r\n        if (id) {\r\n          const split = id.split('-');\r\n          sign.pageNumber = split.length === 2 ? parseInt(split[1], 10) : sign.pageNumber;\r\n        }\r\n        sign.position = currentPosition;\r\n        this.selectSignature(sign);\r\n        this._dragSignatureService.sign = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  private selectSignature(sign: DraggableSignature) {\r\n    if (sign.type === SignatureType.DIGITAL.id) {\r\n      const addedSignature = new AddedSignature();\r\n      addedSignature.digitalProps = sign.digitalProps;\r\n      addedSignature.guid = sign.guid;\r\n      addedSignature.number = sign.pageNumber;\r\n      for (const page of this.file.pages) {\r\n        const id = this.addSignatureComponent(addedSignature, sign, page);\r\n        this._signaturesHolderService.addId(sign.guid, id);\r\n      }\r\n      this.closeTab(sign.type);\r\n    } else {\r\n      this._signatureService.loadSignatureImage(sign).subscribe((signature: AddedSignature) => {\r\n        signature.number = sign.pageNumber;\r\n        const pageModel = this.file.pages.find(function (p) {\r\n          return p.number === sign.pageNumber;\r\n        });\r\n        const id = this.addSignatureComponent(signature, sign, pageModel);\r\n        this._signaturesHolderService.addId(sign.guid, id);\r\n        this.closeTab(sign.type);\r\n      });\r\n    }\r\n  }\r\n\r\n  private addSignatureComponent(addedSignature: AddedSignature, sign: DraggableSignature, page: PageModel, copied: boolean = false) {\r\n    const dynamicDirective = this._hostingComponentsService.find(page.number);\r\n    if (dynamicDirective) {\r\n      const viewContainerRef = dynamicDirective.viewContainerRef;\r\n      const selectSignature = this._addDynamicComponentService.addDynamicComponent(viewContainerRef, Signature);\r\n      const id = this.getNextId();\r\n      while (addedSignature.width >= page.width || addedSignature.height >= page.height) {\r\n        addedSignature.width = addedSignature.width / 2;\r\n        addedSignature.height = addedSignature.height / 2;\r\n      }\r\n      (<Signature>selectSignature.instance).id = id;\r\n      (<Signature>selectSignature.instance).copied = copied;\r\n      (<Signature>selectSignature.instance).data = addedSignature;\r\n      (<Signature>selectSignature.instance).position = sign.position;\r\n      (<Signature>selectSignature.instance).type = sign.type;\r\n      (<Signature>selectSignature.instance).pageWidth = page.width;\r\n      (<Signature>selectSignature.instance).pageHeight = page.height;\r\n      this.signatureComponents.set(id, selectSignature);\r\n      this._activeSignatureService.changeActive(id);\r\n      return id;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private getNextId() {\r\n    let maxId = 0;\r\n    for (const annId of this.signatureComponents.keys()) {\r\n      if (annId > maxId) {\r\n        maxId = annId;\r\n      }\r\n    }\r\n    const id = maxId + 1;\r\n    return id;\r\n  }\r\n\r\n  private closeTab(type: string) {\r\n    this._signatureTabActivationService.changeActiveTab(type);\r\n  }\r\n\r\n  hideAll($event) {\r\n    if (($event.target.parentElement && $event.target.parentElement.attributes['name'] &&\r\n      $event.target.parentElement.attributes['name'].value === 'button') ||\r\n      ($event.target.parentElement &&\r\n        $event.target.parentElement.parentElement &&\r\n        $event.target.parentElement.parentElement.attributes['name'] &&\r\n        $event.target.parentElement.parentElement.attributes['name'].value === 'button') ||\r\n      ($event.target.parentElement &&\r\n        $event.target.parentElement.parentElement &&\r\n        $event.target.parentElement.parentElement.parentElement &&\r\n        $event.target.parentElement.parentElement.parentElement.parentElement &&\r\n        $event.target.parentElement.parentElement.parentElement.parentElement.attributes['name'] &&\r\n        $event.target.parentElement.parentElement.parentElement.parentElement.attributes['name'].value === 'button')) {\r\n\r\n      return;\r\n    }\r\n    this._onCloseService.close(true);\r\n  }\r\n\r\n  newSign($event: string) {\r\n    if (SignatureType.HAND.id === $event) {\r\n      this._modalService.open(CommonModals.DrawHandSignature);\r\n    } else if (SignatureType.STAMP.id === $event) {\r\n      this._modalService.open(CommonModals.DrawStampSignature);\r\n    } else if (SignatureType.TEXT.id === $event) {\r\n      this.addTextSign();\r\n      this._signatureTabActivationService.changeActiveTab(SignatureType.TEXT.id);\r\n    }\r\n  }\r\n\r\n  private addTextSign() {\r\n    const signature = new AddedSignature();\r\n    signature.props = SignatureProps.getDefault();\r\n    signature.guid = DraggableSignature.TEMP;\r\n    const sign = new DraggableSignature();\r\n    sign.guid = DraggableSignature.TEMP;\r\n    sign.position = new Position(0, 0);\r\n    sign.type = SignatureType.TEXT.id;\r\n    const pageNumber = this._navigateService.currentPage;\r\n    signature.number = pageNumber;\r\n    sign.pageNumber = pageNumber;\r\n    const pageModel = this.file.pages.find(function (p) {\r\n      return p.number === pageNumber;\r\n    });\r\n    const id = this.addSignatureComponent(signature, sign, pageModel);\r\n    this._signaturesHolderService.addId(sign.guid, id);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.cleanSignatures();\r\n  }\r\n\r\n  private cleanSignatures() {\r\n    for (const componentRef of this.signatureComponents.values()) {\r\n      componentRef.destroy();\r\n    }\r\n    this.signatureComponents = new Map<number, ComponentRef<any>>();\r\n    this._signaturesHolderService.clear();\r\n  }\r\n\r\n  sign() {\r\n    const signatures = this.prepareSignaturesData();\r\n    this._signatureService.sign(this.credentials, signatures).subscribe((ret: any) => {\r\n      this._modalService.open(CommonModals.OperationSuccess);\r\n      this.selectFile(ret.guid, null, CommonModals.OperationSuccess);\r\n    });\r\n  }\r\n\r\n  public prepareSignaturesData() {\r\n    const signatures = [];\r\n    for (const ids of this._signaturesHolderService.values()) {\r\n      for (const id of ids) {\r\n        const componentRef = this.signatureComponents.get(id);\r\n        // @ts-ignore\r\n        const sign = (<Signature>componentRef).instance;\r\n        const data = sign.data;\r\n        const position = sign.position;\r\n        const type = sign.type;\r\n\r\n        if (DraggableSignature.TEMP !== data.guid) {\r\n          signatures.push(SignatureData.map(data, type, position));\r\n        }\r\n\r\n        if (SignatureType.DIGITAL.id === type) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return signatures;\r\n  }\r\n\r\n  isPdf() {\r\n    if (this.file) {\r\n      if (FileUtil.find(this.file.guid, false).format === \"Portable Document Format\") {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  codesConfig() {\r\n    return this.getSignatureTypeConfig(SignatureType.BAR_CODE.id) || this.getSignatureTypeConfig(SignatureType.QR_CODE.id);\r\n  }\r\n\r\n  isVisible(id: string) {\r\n    const notCode = id !== SignatureType.BAR_CODE.id && id !== SignatureType.QR_CODE.id;\r\n    return this.getSignatureTypeConfig(id) && (this.isDesktop || notCode);\r\n  }\r\n\r\n  activeTab($event: string) {\r\n    this.activeSignatureTab = $event;\r\n  }\r\n\r\n  fileDropped($event) {\r\n    this.fileWasDropped = $event;\r\n  }\r\n\r\n  isFirstTab(signatureType: { name: string; icon: string; id: string; title: string }) {\r\n    if ((signatureType.id === SignatureType.TEXT.id) || (!this.isDesktop && signatureType.id === SignatureType.QR_CODE.id)) {\r\n      return -1;\r\n    }\r\n    if ((signatureType.id === SignatureType.HAND.id) || (!this.isDesktop && signatureType.id === SignatureType.BAR_CODE.id)) {\r\n      return 1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  onPan($event)\r\n  {\r\n    this._zoomService.changeZoom(this._zoom);\r\n  }\r\n}\r\n","import {Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\r\nimport {DigitalSign, DraggableSignature, Position, Signature, SignatureType} from \"../signature-models\";\r\nimport {NavigateService} from \"@groupdocs.examples.angular/common-components\";\r\nimport {SelectSignatureService} from \"../select-signature.service\";\r\nimport {DragSignatureService} from \"../drag-signature.service\";\r\nimport {DatePipe} from \"@angular/common\";\r\nimport {SignaturesHolderService} from \"../signatures-holder.service\";\r\n\r\n\r\n@Component({\r\n  selector: 'gd-signature-list-panel',\r\n  templateUrl: './signature-list-panel.component.html',\r\n  styleUrls: ['./signature-list-panel.component.less']\r\n})\r\nexport class SignatureListPanelComponent implements OnInit, OnChanges {\r\n\r\n  @Input() signatures: Signature[];\r\n  @Input() icon: string;\r\n  @Input() signatureType: string;\r\n  @Input() isPdf: boolean;\r\n  @Input() loading: boolean;\r\n  @Output() removeSignatureEvent = new EventEmitter<string>();\r\n  showDigitalInputs = false;\r\n  digitalProps = new DigitalSign();\r\n  digitalId: string;\r\n\r\n  constructor(private _navigateService: NavigateService,\r\n              private _selectSignatureService: SelectSignatureService,\r\n              private _dragSignatureService: DragSignatureService,\r\n              private _datePipe: DatePipe,\r\n              private _signaturesHolderService: SignaturesHolderService) {\r\n    this.digitalProps.date = this._datePipe.transform(new Date(), 'dd-MM-yyyy');\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  getImage(data: string) {\r\n    const dataImagePngBase64 = 'data:image/png;base64,';\r\n    return dataImagePngBase64 + data;\r\n  }\r\n\r\n  deleteSign(guid: string) {\r\n    this.removeSignatureEvent.emit(guid);\r\n  }\r\n\r\n  isDigital() {\r\n    return SignatureType.DIGITAL.id === this.signatureType;\r\n  }\r\n\r\n  private selectSignature(sign: DraggableSignature) {\r\n    this._selectSignatureService.select(sign);\r\n  }\r\n\r\n  private getSign(guid: string): DraggableSignature {\r\n    const sign = new DraggableSignature();\r\n    sign.type = this.signatureType;\r\n    sign.guid = guid;\r\n    sign.position = new Position(0, 0);\r\n    sign.pageNumber = this._navigateService.currentPage;\r\n    return sign;\r\n  }\r\n\r\n  select(guid: string) {\r\n    if (this.signatureType === SignatureType.DIGITAL.id) {\r\n      this.showDigitalInputs = this.digitalId !== guid;\r\n      this.digitalId = this.digitalId === guid ? null : guid;\r\n    } else {\r\n      const sign = this.getSign(guid);\r\n      this.selectSignature(sign);\r\n    }\r\n  }\r\n\r\n  dragOver($event: DragEvent) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n  }\r\n\r\n  dragLeave($event: DragEvent, guid: string) {\r\n    this._dragSignatureService.sign = this.getSign(guid);\r\n  }\r\n\r\n  selectDigital(guid: string) {\r\n    if (!this.isActive(guid)) {\r\n      return;\r\n    }\r\n    const sign = this.getSign(guid);\r\n    sign.digitalProps = this.digitalProps;\r\n    this.selectSignature(sign);\r\n  }\r\n\r\n  parseDate(value) {\r\n    return this._datePipe.transform(value, 'dd-MM-yyyy');\r\n  }\r\n\r\n  isActive(guid: string) {\r\n    return !this._signaturesHolderService.has(guid);\r\n  }\r\n\r\n  dragStart($event: DragEvent) { // for ff\r\n    $event.dataTransfer.setData('text', 'foo');\r\n  }\r\n\r\n  empty() {\r\n    return !this.loading && (!this.signatures || this.signatures.length === 0);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (this.showDigitalInputs) {\r\n      this.showDigitalInputs = this.signatureType === SignatureType.DIGITAL.id;\r\n    }\r\n  }\r\n\r\n  drop($event: DragEvent) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n  }\r\n}\r\n","import {Component, ElementRef, EventEmitter, Input, OnInit, Output} from '@angular/core';\r\nimport {SignatureService} from \"../signature.service\";\r\nimport {OpticalCodeModel} from \"../signature-models\";\r\nimport {Subject} from \"rxjs\";\r\nimport {debounceTime} from \"rxjs/operators\";\r\n\r\n@Component({\r\n  selector: 'gd-new-bar-qr-code',\r\n  templateUrl: './new-bar-qr-code.component.html',\r\n  styleUrls: ['./new-bar-qr-code.component.less']\r\n})\r\nexport class NewBarQrCodeComponent implements OnInit {\r\n  @Input() type: string;\r\n  @Input() icon: string;\r\n  @Input() name: string;\r\n  @Output() closePanel = new EventEmitter<boolean>();\r\n  encodedImage: string;\r\n\r\n  private subject: Subject<string> = new Subject();\r\n\r\n  constructor(private _signatureService: SignatureService,\r\n              private _elementRef: ElementRef) {\r\n    this.subject.pipe(\r\n      debounceTime(500)\r\n    ).subscribe(text => {\r\n      this.saveCode(text, true);\r\n    });\r\n  }\r\n\r\n  private saveCode(text: string, temp: boolean) {\r\n    if (text) {\r\n      this._signatureService.getCode(text, temp, this.type).subscribe((data: OpticalCodeModel) => {\r\n        this.encodedImage = data.encodedImage;\r\n        if (!temp) {\r\n          this.closePanel.emit(true);\r\n        }\r\n      });\r\n    } else {\r\n      this.clean();\r\n    }\r\n  }\r\n\r\n  private clean() {\r\n    this.encodedImage = null;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.clean();\r\n    setTimeout(() => {\r\n      const element = this._elementRef.nativeElement.querySelector(\"#text-input\");\r\n      element.focus();\r\n    }, 100);\r\n  }\r\n\r\n  addSign(text: string) {\r\n    this.saveCode(text, false);\r\n  }\r\n\r\n  saveTemp(text: string) {\r\n    this.subject.next(text);\r\n  }\r\n\r\n  getData() {\r\n    return 'data:image/png;base64,' + this.encodedImage;\r\n  }\r\n}\r\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\r\nimport {FileListWithParams} from \"../signature-models\";\r\nimport {SignatureService} from \"../signature.service\";\r\n\r\n@Component({\r\n  selector: 'gd-upload-signature',\r\n  templateUrl: './upload-signature.component.html',\r\n  styleUrls: ['./upload-signature.component.less']\r\n})\r\nexport class UploadSignatureComponent implements OnInit {\r\n  @Input() signatureType: string;\r\n  @Input() rewrite: boolean;\r\n  @Output() closePanel = new EventEmitter<boolean>();\r\n\r\n  constructor(private _signatureService: SignatureService) {\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  handleFileInput(files: FileList) {\r\n    this.addFiles(files);\r\n  }\r\n\r\n  addFiles(files) {\r\n    const data = new FileListWithParams(files, this.signatureType);\r\n    this._signatureService.uploadSignature(data, this.rewrite).subscribe(() => {\r\n      this.closePanel.emit(true);\r\n    });\r\n  }\r\n\r\n  uploadFiles($event: any) {\r\n    this.addFiles($event);\r\n  }\r\n}\r\n","import {Directive, EventEmitter, HostListener, Output} from '@angular/core';\r\nimport {DndDirective, UploadFilesService} from \"@groupdocs.examples.angular/common-components\";\r\n\r\n@Directive({\r\n  selector: '[gdDndSignature]'\r\n})\r\nexport class DndSignatureDirective extends DndDirective {\r\n  @Output() files = new EventEmitter();\r\n\r\n  constructor(_uploadFilesService: UploadFilesService) {\r\n    super(_uploadFilesService);\r\n  }\r\n\r\n  @HostListener('drop', ['$event'])\r\n  public onDrop(evt) {\r\n    evt.preventDefault();\r\n    evt.stopPropagation();\r\n    const files = evt.dataTransfer.files;\r\n    if (files.length > 0) {\r\n      this.active = false;\r\n      this.files.emit(files);\r\n    }\r\n  }\r\n\r\n}\r\n","import {Component, ElementRef, Input, OnChanges, OnInit, SimpleChanges, ViewChild} from '@angular/core';\r\nimport {WindowService} from \"@groupdocs.examples.angular/common-components\";\r\n\r\n@Component({\r\n  selector: 'gd-canvas',\r\n  templateUrl: './canvas.component.html',\r\n  styleUrls: ['./canvas.component.less']\r\n})\r\nexport class CanvasComponent implements OnInit, OnChanges {\r\n\r\n  @Input() color: string;\r\n\r\n  _ctx: CanvasRenderingContext2D;\r\n  _isDragged = false;\r\n  private isDesktop: boolean;\r\n\r\n  @ViewChild('canvas', {static: true}) canvas: ElementRef;\r\n\r\n  constructor(private _windowService: WindowService) {\r\n    this.isDesktop = _windowService.isDesktop();\r\n    _windowService.onResize.subscribe((w) => {\r\n      this.isDesktop = _windowService.isDesktop();\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this._ctx = this.canvas.nativeElement.getContext('2d');\r\n  }\r\n\r\n  onMouseDown(e) {\r\n    let pos;\r\n    if (this.isDesktop) {\r\n      pos = {x: e.offsetX, y: e.offsetY};\r\n    } else {\r\n      const wEvent: DragEvent = <DragEvent>window.event;\r\n      pos = {x: wEvent.offsetX, y: wEvent.offsetY};\r\n    }\r\n    e.preventDefault();\r\n    this._isDragged = true;\r\n    this._ctx.beginPath();\r\n    this._ctx.moveTo(pos.x, pos.y);\r\n  }\r\n\r\n  onMouseUp(e) {\r\n    e.preventDefault();\r\n    this._isDragged = false;\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    let pos;\r\n    if (this.isDesktop) {\r\n      pos = {x: e.offsetX, y: e.offsetY};\r\n    } else {\r\n      const wEvent: DragEvent = <DragEvent>window.event;\r\n      pos = {x: wEvent.offsetX, y: wEvent.offsetY};\r\n    }\r\n    e.preventDefault();\r\n    if (this._isDragged) {\r\n      this._ctx.lineTo(pos.x, pos.y);\r\n      this._ctx.stroke();\r\n    }\r\n  }\r\n\r\n  setColor(color) {\r\n    if (this._ctx) {\r\n      this._ctx.strokeStyle = color;\r\n    }\r\n  }\r\n\r\n  getImage(): string {\r\n    return this.canvas.nativeElement.toDataURL('image/png');\r\n  }\r\n\r\n  clear() {\r\n    this.canvas.nativeElement.width = this.canvas.nativeElement.width;\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    this.setColor(this.color);\r\n  }\r\n\r\n  getWidth() {\r\n    return this.isDesktop ? 1079 : this._windowService.getWidth();\r\n  }\r\n\r\n  getHeight() {\r\n    return this.isDesktop ? 540 : this._windowService.getHeight();\r\n  }\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\n\r\nexport class ActiveCanvasService {\r\n  private _observer: Subject<number> = new Subject();\r\n  private readonly _activeChange: Observable<number> = this._observer.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get activeChange(): Observable<number> {\r\n    return this._activeChange;\r\n  }\r\n\r\n  changeActive(signId: number) {\r\n    this._observer.next(signId);\r\n  }\r\n}\r\n","import {Observable, Subject} from \"rxjs\";\r\n\r\nexport class RemoveCanvasService {\r\n  private _observer: Subject<number> = new Subject();\r\n  private readonly _removeCanvas: Observable<number> = this._observer.asObservable();\r\n\r\n  constructor() {\r\n  }\r\n\r\n  get removeCanvas(): Observable<number> {\r\n    return this._removeCanvas;\r\n  }\r\n\r\n  remove(id: number): void {\r\n    this._observer.next(id);\r\n  }\r\n}\r\n","import {AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild} from '@angular/core';\r\nimport {Border, StampCanvasProps} from \"../signature-models\";\r\nimport {ActiveCanvasService} from \"../active-canvas.service\";\r\nimport {RemoveCanvasService} from \"../remove-canvas.service\";\r\nimport {OnCloseService, WindowService} from \"@groupdocs.examples.angular/common-components\";\r\n\r\n@Component({\r\n  selector: 'gd-stamp-canvas',\r\n  templateUrl: './stamp-canvas.component.html',\r\n  styleUrls: ['./stamp-canvas.component.less']\r\n})\r\nexport class StampCanvasComponent implements OnInit, AfterViewInit {\r\n  @Input() id: number;\r\n  @Input() theFirst: boolean;\r\n  @Input() active: boolean;\r\n  @Input() props: StampCanvasProps;\r\n  @Input() width: number;\r\n  @Input() height: number;\r\n\r\n  _ctx: CanvasRenderingContext2D;\r\n  @ViewChild('canvas', {static: true}) canvas: ElementRef;\r\n  colorPickerBG = false;\r\n  colorPickerC = false;\r\n  borderWidth = Border.widthOptions();\r\n  isMobile: boolean;\r\n\r\n  constructor(private _activeCanvasService: ActiveCanvasService,\r\n              private _removeCanvas: RemoveCanvasService,\r\n              private _onCloseService: OnCloseService,\r\n              private _windowService: WindowService) {\r\n\r\n    this._onCloseService.onClose.subscribe((c) => {\r\n      this.colorPickerC = false;\r\n      this.colorPickerBG = false;\r\n    });\r\n\r\n    this._activeCanvasService.activeChange.subscribe((id: number) => {\r\n      this.active = this.id === id;\r\n    });\r\n\r\n    this.isMobile = _windowService.isMobile();\r\n    _windowService.onResize.subscribe((w) => {\r\n      this.isMobile = _windowService.isMobile();\r\n    });\r\n  }\r\n\r\n  get ctx(): CanvasRenderingContext2D {\r\n    return this._ctx;\r\n  }\r\n\r\n  activation() {\r\n    this._activeCanvasService.changeActive(this.id);\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this._ctx = this.canvas.nativeElement.getContext('2d');\r\n    this.redrawCanvas();\r\n  }\r\n\r\n  redrawCanvas() {\r\n    this.refreshRadius();\r\n    this.drawCircle();\r\n    if (this.props.text) {\r\n      if (this.theFirst) {\r\n        this._ctx.fillStyle = this.props.textColor;\r\n        this._ctx.font = this.fontDecoration() + \" \" + this.props.fontSize + 'px ' + this.props.font;\r\n        this._ctx.textAlign = 'center';\r\n        this._ctx.fillText(this.props.text, this.props.width / 2, this.props.height / 2 + this.props.fontSize / 2);\r\n        if (this.props.underline) {\r\n          this.makeTextUnderline();\r\n        }\r\n      } else {\r\n        this.drawTextCircle();\r\n      }\r\n    }\r\n  }\r\n\r\n  private fontDecoration(): string {\r\n    const bold = (this.props.bold) ? \"bold\" : \"\";\r\n    const italic = (this.props.italic) ? \"italic\" : \"\";\r\n    return bold + \" \" + italic;\r\n  }\r\n\r\n  private makeTextUnderline() {\r\n    const x = this.props.width / 2;\r\n    const y = this.props.height / 2;\r\n    const textWidth = this._ctx.measureText(this.props.text).width;\r\n    const startY = y + this.props.fontSize;\r\n    const endY = startY;\r\n    let underlineHeight = this.props.fontSize / 15;\r\n    if (underlineHeight < 1) {\r\n      underlineHeight = 1;\r\n    }\r\n    this._ctx.beginPath();\r\n    const startX = x - (textWidth / 2);\r\n    const endX = x + (textWidth / 2);\r\n    this._ctx.strokeStyle = this.props.textColor;\r\n    this._ctx.lineWidth = underlineHeight;\r\n    this._ctx.moveTo(startX, startY);\r\n    this._ctx.lineTo(endX, endY);\r\n    this._ctx.strokeStyle = 'blue';\r\n    this._ctx.stroke();\r\n  }\r\n\r\n  private drawCircle() {\r\n    const backgroundColor = (this.props.backgroundColor === \"\") ? \"rgb(255, 255, 255)\" : this.props.backgroundColor;\r\n    const x = this.props.width / 2;\r\n    const y = this.props.height / 2;\r\n    this._ctx.beginPath();\r\n    this._ctx.arc(x, y, this.props.radius, 0, 2 * Math.PI);\r\n    this._ctx.lineWidth = this.props.strokeWidth;\r\n    this._ctx.strokeStyle = this.props.strokeColor;\r\n    this._ctx.stroke();\r\n    this._ctx.fillStyle = backgroundColor;\r\n    this._ctx.fill();\r\n    this._ctx.closePath();\r\n  };\r\n\r\n  private drawTextCircle() {\r\n    const x = this.props.width / 2;\r\n    const y = this.props.height / 2;\r\n    this._ctx.save();\r\n    this._ctx.translate(x, y);\r\n    this._ctx.rotate(Math.PI / 2);\r\n    this._ctx.fillStyle = this.props.textColor;\r\n    this._ctx.font = this.fontDecoration() + \" \" + this.props.fontSize + 'px ' + this.props.font;\r\n\r\n    const num = this.props.textExpansion + (this.props.fontSize / 100);\r\n    const rad = this.props.radius - (this.props.fontSize / 2);\r\n    for (let i = 0; i < this.props.textRepeat; i++) {\r\n      for (let j = 0; j < this.props.text.length; j++) {\r\n        this._ctx.save();\r\n        this._ctx.rotate(j * num + num * this.props.text.length * i);\r\n        this._ctx.fillText(this.props.text[j], 0, -(rad));\r\n        this._ctx.restore();\r\n      }\r\n    }\r\n    this._ctx.restore();\r\n  };\r\n\r\n  private refreshRadius() {\r\n    if (this.props.strokeWidth > 1) {\r\n      this.props.radius = (this.props.width / 2) - (this.props.strokeWidth / 2) - 1;\r\n    } else {\r\n      this.props.radius = (this.props.width / 2) - 1;\r\n    }\r\n  }\r\n\r\n  toggleColorPicker($event, bg: boolean) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n    if (bg) {\r\n      this.colorPickerBG = !this.colorPickerBG;\r\n    } else {\r\n      this.colorPickerC = !this.colorPickerC;\r\n    }\r\n  }\r\n\r\n  selectColor(bg: boolean, $event) {\r\n    if (bg) {\r\n      this.props.backgroundColor = $event;\r\n      this.colorPickerBG = false;\r\n    } else {\r\n      this.props.strokeColor = $event;\r\n      this.colorPickerC = false;\r\n    }\r\n    this.redrawCanvas();\r\n  }\r\n\r\n  selectBorderWidth($event) {\r\n    this.props.strokeWidth = $event.value;\r\n    this.redrawCanvas();\r\n  }\r\n\r\n  deleteCanvas() {\r\n    this._removeCanvas.remove(this.id);\r\n    this.redrawCanvas();\r\n  }\r\n\r\n  getLeft() {\r\n    return (this.width - this.props.width) / 2;\r\n  }\r\n\r\n  getTop() {\r\n    return (this.height - (this.isMobile ? 62 : 0) - this.props.height) / 2 - this.calcDiff();\r\n  }\r\n\r\n  private calcDiff() {\r\n    return (this.active && !this.isMobile) ? 37 : this.isMobile ? -30 : 0;\r\n  }\r\n\r\n  resize($event) {\r\n    this.props.width += $event;\r\n    this.props.height += $event;\r\n  }\r\n\r\n  closeColorPickerBG($event) {\r\n    this.colorPickerBG = !$event;\r\n  }\r\n\r\n  closeColorPickerC($event) {\r\n    this.colorPickerC = !$event;\r\n  }\r\n\r\n  getTranslation() {\r\n    this.refreshRadius();\r\n    const menuWidth = 148 * 0.5;\r\n    return this.props.radius < menuWidth ? (menuWidth - this.props.radius) : (this.props.radius - menuWidth);\r\n  }\r\n\r\n  inactive($event: Event) {\r\n    this._activeCanvasService.changeActive(null);\r\n  }\r\n}\r\n","import {TabActivatorService} from \"@groupdocs.examples.angular/common-components\";\r\n\r\nexport class SignatureTabActivatorService extends TabActivatorService {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n}\r\n","import {Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\r\nimport {Signature, SignatureType} from \"../signature-models\";\r\nimport {SignatureService} from \"../signature.service\";\r\n\r\n@Component({\r\n  selector: 'gd-signature-left-panel',\r\n  templateUrl: './signature-left-panel.component.html',\r\n  styleUrls: ['./signature-left-panel.component.less']\r\n})\r\nexport class SignatureLeftPanelComponent implements OnInit, OnChanges {\r\n  @Input() rewrite: boolean;\r\n  @Input() isPdf: boolean;\r\n  @Input() id: string;\r\n  @Output() newSignatureEvent = new EventEmitter<string>();\r\n  public showNewCode = false;\r\n  public showUpload = false;\r\n  signatures: Signature[];\r\n  loading = false;\r\n\r\n  constructor(private _signatureService: SignatureService) {\r\n    _signatureService.getRefreshSignatures.subscribe(() => {\r\n      this.getSignatures(this.id);\r\n    });\r\n  }\r\n\r\n  getSignatures(tabId: string) {\r\n    if (!this.loading) {\r\n      this.loading = true;\r\n      this._signatureService.getSignatures('', tabId).subscribe((signatures: Signature[]) => {\r\n        this.signatures = signatures || [];\r\n        this.loading = false;\r\n      });\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    this.signatures = [];\r\n    this.getSignatures(this.id);\r\n    this.showNewCode = false;\r\n    this.showUpload = false;\r\n  }\r\n\r\n  getTitleIcon() {\r\n    return this.showUpload || this.showNewCode ? 'times' : 'plus';\r\n  }\r\n\r\n  getTitle() {\r\n    if (!this.id) {\r\n      return \"\";\r\n    }\r\n    const signatureType = SignatureType.getSignatureType(this.id);\r\n    return (this.showUpload || this.showNewCode) ? signatureType.title : signatureType.name;\r\n  }\r\n\r\n  getName() {\r\n    if (!this.id) {\r\n      return \"\";\r\n    }\r\n    const signatureType = SignatureType.getSignatureType(this.id);\r\n    return signatureType.name;\r\n  }\r\n\r\n  removeSignature($event: string, type: string) {\r\n    this._signatureService.removeSignatures($event, type).subscribe(() => this.getSignatures(type));\r\n  }\r\n\r\n  closeUploadPanel($event: boolean) {\r\n    this.showUpload = !$event;\r\n    this.getSignatures(this.id);\r\n  }\r\n\r\n  closeCodePanel($event: boolean) {\r\n    this.showNewCode = !$event;\r\n    this.getSignatures(this.id);\r\n  }\r\n\r\n  getCodeName() {\r\n    if (!this.id) {\r\n      return \"\";\r\n    }\r\n    return SignatureType.QR_CODE.id === this.id ? 'Qr Code' : (SignatureType.BAR_CODE.id === this.id ? 'Bar Code' : '');\r\n  }\r\n\r\n  icon() {\r\n    if (!this.id) {\r\n      return \"\";\r\n    }\r\n    return SignatureType.getSignatureType(this.id).icon;\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    this.init();\r\n  }\r\n\r\n  closeNewSignature() {\r\n    if (SignatureType.DIGITAL.id === this.id || SignatureType.IMAGE.id === this.id) {\r\n      this.showUpload = false;\r\n    } else if (SignatureType.BAR_CODE.id === this.id || SignatureType.QR_CODE.id === this.id) {\r\n      this.showNewCode = false;\r\n    }\r\n  }\r\n\r\n  openNewSignature() {\r\n    if (this.showUpload || this.showNewCode) {\r\n      return;\r\n    }\r\n    if (SignatureType.DIGITAL.id === this.id || SignatureType.IMAGE.id === this.id) {\r\n      this.showUpload = true;\r\n    } else if (SignatureType.BAR_CODE.id === this.id || SignatureType.QR_CODE.id === this.id) {\r\n      this.showNewCode = true;\r\n    } else {\r\n      this.newSignatureEvent.emit(this.id);\r\n    }\r\n  }\r\n}\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {SignatureService} from \"../signature.service\";\r\nimport {SignatureTabActivatorService} from \"../signature-tab-activator.service\"\r\nimport {CanvasComponent} from \"../canvas/canvas.component\";\r\nimport {SignatureType} from \"../signature-models\";\r\nimport {CommonModals, ModalService} from \"@groupdocs.examples.angular/common-components\";\r\n\r\n@Component({\r\n  selector: 'gd-hand-modal',\r\n  templateUrl: './hand-modal.component.html',\r\n  styleUrls: ['./hand-modal.component.less']\r\n})\r\nexport class HandModalComponent implements OnInit {\r\n  defaultColor = '#000000';\r\n  selectedColor = this.defaultColor;\r\n  colorPickerShow = false;\r\n\r\n  constructor(private _signatureService: SignatureService,\r\n              private _tabActivationService: SignatureTabActivatorService,\r\n              private _modalService: ModalService) {\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  selectColor(color: string) {\r\n    this.selectedColor = color;\r\n    this.colorPickerShow = false;\r\n  }\r\n\r\n  saveSign(canvasComponent: CanvasComponent) {\r\n    const img = canvasComponent.getImage();\r\n    this._signatureService.saveImage(img).subscribe(() => {\r\n      this._tabActivationService.changeActiveTab(SignatureType.HAND.id);\r\n      this._signatureService.refreshSignatures();\r\n    });\r\n    this.clear(canvasComponent);\r\n    this.close();\r\n  }\r\n\r\n  private close() {\r\n    this._modalService.close(CommonModals.DrawHandSignature);\r\n  }\r\n\r\n  toggleColorPicker($event) {\r\n    $event.preventDefault();\r\n    $event.stopPropagation();\r\n    this.colorPickerShow = !this.colorPickerShow;\r\n  }\r\n\r\n  closePicker($event) {\r\n    this.colorPickerShow = !$event;\r\n  }\r\n\r\n  onCloseOpen(canvasComponent: CanvasComponent, $event) {\r\n    this.clear(canvasComponent);\r\n  }\r\n\r\n  private clear(canvasComponent: CanvasComponent) {\r\n    this.selectedColor = this.defaultColor;\r\n    canvasComponent.clear();\r\n  }\r\n}\r\n","import {Component, ComponentRef, ElementRef, OnDestroy, OnInit, ViewChild} from '@angular/core';\r\nimport {SignatureType, StampCanvasProps} from \"../signature-models\";\r\nimport {ActiveCanvasService} from './../active-canvas.service'\r\nimport {SignatureService} from './../signature.service'\r\nimport {SignatureTabActivatorService} from \"./../signature-tab-activator.service\";\r\nimport {RemoveCanvasService} from \"../remove-canvas.service\";\r\nimport {StampCanvasComponent} from \"../stamp-canvas/stamp-canvas.component\";\r\nimport {\r\n  AddDynamicComponentService, CommonModals, Formatting,\r\n  HostDynamicDirective, ModalService,\r\n  WindowService\r\n} from \"@groupdocs.examples.angular/common-components\";\r\nimport * as jquery from \"jquery\";\r\n\r\nconst $ = jquery;\r\n\r\n@Component({\r\n  selector: 'gd-stamp-modal',\r\n  templateUrl: './stamp-modal.component.html',\r\n  styleUrls: ['./stamp-modal.component.less']\r\n})\r\nexport class StampModalComponent implements OnInit, OnDestroy {\r\n  stampCircles = new Map<number, ComponentRef<any>>();\r\n  textString = '';\r\n  showText = false;\r\n\r\n  @ViewChild(HostDynamicDirective, {static: true}) dynamicDirective: HostDynamicDirective;\r\n\r\n  private isMobile: boolean;\r\n  private sizeMagnifier = 40;\r\n  private activeId: number;\r\n  textProps = Formatting.default();\r\n\r\n  constructor(private _addDynamicComponentService: AddDynamicComponentService,\r\n              private _activeCanvasService: ActiveCanvasService,\r\n              private _windowService: WindowService,\r\n              private _removeCanvas: RemoveCanvasService,\r\n              private _signatureService: SignatureService,\r\n              private _tabActivationService: SignatureTabActivatorService,\r\n              private _modalService: ModalService) {\r\n\r\n    this._removeCanvas.removeCanvas.subscribe((id: number) => {\r\n      const componentRef = this.stampCircles.get(id);\r\n      componentRef.destroy();\r\n      this.stampCircles.delete(id);\r\n    });\r\n\r\n    this.isMobile = _windowService.isMobile();\r\n    _windowService.onResize.subscribe((w) => {\r\n      this.isMobile = _windowService.isMobile();\r\n    });\r\n\r\n    this._activeCanvasService.activeChange.subscribe((id: number) => {\r\n      this.activeId = id;\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  saveSign() {\r\n    const componentRef = this.stampCircles.get(this.stampCircles.size);\r\n    const canvasComponent = <StampCanvasComponent>componentRef.instance;\r\n    const lastProps = canvasComponent.props;\r\n    const ctx = canvasComponent.ctx;\r\n    const props = [];\r\n    props.push(lastProps);\r\n    for (let i = this.stampCircles.size - 1; i > 0; i--) {\r\n      const comp = <StampCanvasComponent>this.stampCircles.get(i).instance;\r\n      const canvas = comp.canvas.nativeElement;\r\n      let offset = lastProps.width - comp.props.width;\r\n      if (offset !== 0) {\r\n        offset = offset / 2;\r\n      }\r\n      ctx.drawImage(canvas, offset, offset);\r\n      props.push(comp.props);\r\n    }\r\n    props.reverse();\r\n    const img = canvasComponent.canvas.nativeElement.toDataURL(\"image/png\");\r\n    this._signatureService.saveStamp(img, props).subscribe(() => {\r\n      this._tabActivationService.changeActiveTab(SignatureType.STAMP.id);\r\n      this._signatureService.refreshSignatures();\r\n    });\r\n    this.close();\r\n  }\r\n\r\n  private close() {\r\n    this._modalService.close(CommonModals.DrawStampSignature);\r\n  }\r\n\r\n  onCloseOpen($event) {\r\n    if ($event) {\r\n      this.textString = '';\r\n      const props = new StampCanvasProps().init(this.isMobile);\r\n      props.id = this.stampCircles.size + 1;\r\n      this.addCircle(props, true);\r\n    } else {\r\n      this.clear();\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    for (const comp of this.stampCircles.values()) {\r\n      comp.destroy();\r\n    }\r\n    this.stampCircles = new Map<number, ComponentRef<any>>();\r\n    this.showText = false;\r\n  }\r\n\r\n  private addCircle(props: StampCanvasProps, theFirst: boolean) {\r\n    if (this.dynamicDirective) {\r\n      const viewContainerRef = this.dynamicDirective.viewContainerRef;\r\n      const stampCircle = this._addDynamicComponentService.addDynamicComponent(viewContainerRef, StampCanvasComponent);\r\n      (<StampCanvasComponent>stampCircle.instance).id = props.id;\r\n      (<StampCanvasComponent>stampCircle.instance).theFirst = theFirst;\r\n      (<StampCanvasComponent>stampCircle.instance).active = true;\r\n      (<StampCanvasComponent>stampCircle.instance).props = props;\r\n      (<StampCanvasComponent>stampCircle.instance).width = this.getWidth();\r\n      (<StampCanvasComponent>stampCircle.instance).height = this.getHeight();\r\n      this.stampCircles.set(props.id, stampCircle);\r\n      this._activeCanvasService.changeActive(props.id);\r\n    }\r\n  }\r\n\r\n  addCanvas() {\r\n    const props = new StampCanvasProps();\r\n    props.init(this.isMobile);\r\n    props.id = this.stampCircles.size + 1;\r\n    const componentRef = this.stampCircles.get(this.stampCircles.size);\r\n    if (componentRef) {\r\n      const lastProps = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.width = lastProps.width + this.sizeMagnifier;\r\n      props.height = lastProps.height + this.sizeMagnifier;\r\n      props.zIndex = lastProps.zIndex - 1;\r\n    }\r\n    this.addCircle(props, false);\r\n    this.showText = false;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.clear();\r\n  }\r\n\r\n  addText(value: string) {\r\n    this.textString = value;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (this.textString && componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.text = value;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n      this.showText = false;\r\n    }\r\n  }\r\n\r\n  toggleText() {\r\n    this.showText = !this.showText;\r\n    if (this.showText) {\r\n      this._activeCanvasService.changeActive(null);\r\n    }\r\n    if (this.showText) {\r\n      setTimeout(() => {\r\n        const element = $(\"#text-input\");\r\n        if (element) {\r\n          element.focus();\r\n        }\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  toggleUnderline($event: boolean) {\r\n    this.textProps.underline = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.underline = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  toggleBold($event: boolean) {\r\n    this.textProps.bold = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.bold = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  toggleItalic($event: boolean) {\r\n    this.textProps.italic = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.italic = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  selectTextColor($event: string) {\r\n    this.textProps.color = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.textColor = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  selectFont($event: string) {\r\n    this.textProps.font = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.font = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  selectFontSize($event: number) {\r\n    this.textProps.fontSize = $event;\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.fontSize = $event;\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n    }\r\n  }\r\n\r\n  getWidth() {\r\n    return this.isMobile ? this._windowService.getWidth() : 1036;\r\n  }\r\n\r\n  getHeight() {\r\n    return this.isMobile ? this._windowService.getHeight() - 180 : 501;\r\n  }\r\n\r\n  deleteText() {\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      props.text = \"\";\r\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\r\n      this.showText = false;\r\n    }\r\n  }\r\n\r\n  leaveText($event: Event) {\r\n    this.showText = false;\r\n  }\r\n\r\n  getTextWidth() {\r\n    const componentRef = this.stampCircles.get(1);\r\n    if (componentRef) {\r\n      const props = (<StampCanvasComponent>componentRef.instance).props;\r\n      return props.radius * 2;\r\n    }\r\n    return 100;\r\n  }\r\n}\r\n","import {APP_INITIALIZER, ModuleWithProviders, NgModule} from '@angular/core';\r\nimport {CommonModule, DatePipe} from '@angular/common';\r\nimport {\r\n  Api,\r\n  CommonComponentsModule,\r\n  ConfigService,\r\n  ErrorInterceptorService,\r\n  LoadingMaskInterceptorService,\r\n  LoadingMaskService\r\n} from \"@groupdocs.examples.angular/common-components\";\r\nimport {HTTP_INTERCEPTORS, HttpClientModule} from \"@angular/common/http\";\r\nimport {SignatureService} from \"./signature.service\";\r\nimport {SignatureConfigService} from \"./signature-config.service\";\r\nimport {SignatureAppComponent} from \"./signature-app.component\";\r\nimport {SignatureListPanelComponent} from './signature-list-panel/signature-list-panel.component';\r\nimport {FontAwesomeModule} from '@fortawesome/angular-fontawesome';\r\nimport {library} from '@fortawesome/fontawesome-svg-core';\r\nimport {fas} from '@fortawesome/free-solid-svg-icons';\r\nimport {far} from '@fortawesome/free-regular-svg-icons';\r\nimport {NewBarQrCodeComponent} from './new-bar-qr-code/new-bar-qr-code.component';\r\nimport {UploadSignatureComponent} from './upload-signature/upload-signature.component';\r\nimport {DndSignatureDirective} from './dnd-signature.directive';\r\nimport {Signature} from './signature/signature.component';\r\nimport {SelectSignatureService} from \"./select-signature.service\";\r\nimport {DragSignatureService} from \"./drag-signature.service\";\r\nimport {RemoveSignatureService} from \"./remove-signature.service\";\r\nimport {ActiveSignatureService} from \"./active-signature.service\";\r\nimport {CanvasComponent} from './canvas/canvas.component';\r\nimport {StampCanvasComponent} from './stamp-canvas/stamp-canvas.component';\r\nimport {ActiveCanvasService} from \"./active-canvas.service\";\r\nimport {RemoveCanvasService} from \"./remove-canvas.service\";\r\nimport {SignaturesHolderService} from \"./signatures-holder.service\";\r\nimport {SignatureTabActivatorService} from \"./signature-tab-activator.service\";\r\nimport {SignatureLeftPanelComponent} from './signature-left-panel/signature-left-panel.component';\r\nimport {HandModalComponent} from './hand-modal/hand-modal.component';\r\nimport {StampModalComponent} from './stamp-modal/stamp-modal.component';\r\nimport {CopySignatureService} from \"./copy-signature.service\";\r\nimport {ClickOutsideModule} from 'ng-click-outside';\r\n\r\nexport function initializeApp(signatureConfigService: SignatureConfigService) {\r\n  const result = () => signatureConfigService.load();\r\n  return result;\r\n}\r\n\r\n// NOTE: this is required during library compilation see https://github.com/angular/angular/issues/23629#issuecomment-440942981\r\n// @dynamic\r\nexport function setupLoadingInterceptor(service: LoadingMaskService) {\r\n  return new LoadingMaskInterceptorService(service);\r\n}\r\n\r\n@NgModule({\r\n  declarations: [SignatureAppComponent,\r\n    SignatureListPanelComponent,\r\n    NewBarQrCodeComponent,\r\n    UploadSignatureComponent,\r\n    DndSignatureDirective,\r\n    Signature,\r\n    CanvasComponent,\r\n    StampCanvasComponent,\r\n    SignatureLeftPanelComponent,\r\n    HandModalComponent,\r\n    StampModalComponent],\r\n  exports: [SignatureAppComponent,\r\n    SignatureListPanelComponent,\r\n    NewBarQrCodeComponent,\r\n    UploadSignatureComponent,\r\n    DndSignatureDirective,\r\n    Signature,\r\n    CanvasComponent,\r\n    StampCanvasComponent,\r\n    SignatureLeftPanelComponent,\r\n    HandModalComponent,\r\n    StampModalComponent,\r\n    CommonComponentsModule],\r\n  imports: [CommonModule,\r\n    CommonComponentsModule,\r\n    HttpClientModule,\r\n    FontAwesomeModule,\r\n    ClickOutsideModule],\r\n  providers: [\r\n    SignatureService,\r\n    ConfigService,\r\n    SignatureConfigService,\r\n    SelectSignatureService,\r\n    DragSignatureService,\r\n    RemoveSignatureService,\r\n    ActiveSignatureService,\r\n    ActiveCanvasService,\r\n    RemoveCanvasService,\r\n    DatePipe,\r\n    SignaturesHolderService,\r\n    SignatureTabActivatorService,\r\n    CopySignatureService,\r\n    {\r\n      provide: HTTP_INTERCEPTORS,\r\n      useClass: ErrorInterceptorService,\r\n      multi: true\r\n    },\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: initializeApp,\r\n      deps: [SignatureConfigService], multi: true\r\n    },\r\n    LoadingMaskService,\r\n    {\r\n      provide: HTTP_INTERCEPTORS,\r\n      useFactory: setupLoadingInterceptor,\r\n      multi: true,\r\n      deps: [LoadingMaskService]\r\n    }\r\n  ],\r\n  entryComponents: [\r\n    Signature,\r\n    StampCanvasComponent\r\n  ]\r\n})\r\nexport class SignatureModule {\r\n  constructor() {\r\n    library.add(fas, far);\r\n  }\r\n\r\n  static forRoot(apiEndpoint: string): ModuleWithProviders {\r\n    Api.DEFAULT_API_ENDPOINT = apiEndpoint;\r\n    return {\r\n      ngModule: SignatureModule\r\n    };\r\n  }\r\n}\r\n"]}