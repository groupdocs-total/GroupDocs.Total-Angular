{"version":3,"sources":["../../../../node_modules/tslib/tslib.es6.js","ng://@groupdocs.examples.angular/signature/lib/signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-config.ts","ng://@groupdocs.examples.angular/signature/lib/signature-config.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-models.ts","ng://@groupdocs.examples.angular/signature/lib/select-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/remove-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/active-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signatures-holder.service.ts","ng://@groupdocs.examples.angular/signature/lib/copy-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature/signature.component.ts","ng://@groupdocs.examples.angular/signature/lib/drag-signature.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-tab-activator.service.ts","ng://@groupdocs.examples.angular/signature/lib/signature-app.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature-list-panel/signature-list-panel.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature-tab/signature-tab.component.ts","ng://@groupdocs.examples.angular/signature/lib/new-bar-qr-code/new-bar-qr-code.component.ts","ng://@groupdocs.examples.angular/signature/lib/upload-signature/upload-signature.component.ts","ng://@groupdocs.examples.angular/signature/lib/dnd-signature.directive.ts","ng://@groupdocs.examples.angular/signature/lib/context-menu/context-menu.component.ts","ng://@groupdocs.examples.angular/signature/lib/canvas/canvas.component.ts","ng://@groupdocs.examples.angular/signature/lib/active-canvas.service.ts","ng://@groupdocs.examples.angular/signature/lib/remove-canvas.service.ts","ng://@groupdocs.examples.angular/signature/lib/stamp-canvas/stamp-canvas.component.ts","ng://@groupdocs.examples.angular/signature/lib/text-menu/text-menu.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature-left-panel/signature-left-panel.component.ts","ng://@groupdocs.examples.angular/signature/lib/hand-modal/hand-modal.component.ts","ng://@groupdocs.examples.angular/signature/lib/stamp-modal/stamp-modal.component.ts","ng://@groupdocs.examples.angular/signature/lib/signature.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__values","o","m","Symbol","iterator","i","call","next","length","value","done","SignatureService","_http","_config","loadFiles","path","post","getSignatureApiEndpoint","Api","LOAD_FILE_TREE","httpOptionsJson","loadFile","credentials","LOAD_DOCUMENT_DESCRIPTION","upload","file","url","rewrite","signType","formData","FormData","append","String","UPLOAD_DOCUMENTS","loadPage","page","LOAD_DOCUMENT_PAGE","guid","password","getDownloadUrl","DOWNLOAD_DOCUMENTS","loadPrint","LOAD_PRINT","loadPrintPdf","LOAD_PRINT_PDF","httpOptionsJsonResponseTypeBlob","getSignatures","type","signatureType","removeSignatures","DELETE_SIGNATURE_FILE","uploadSignature","data","fileList","item","getCode","text","temp","SAVE_OPTICAL_CODE","properties","loadSignatureImage","sign","LOAD_SIGNATURE_IMAGE","pageNumber","pipe","map","props","saveTextSignature","_this","fontColor","toRgb","SAVE_TEXT","toHex","color","result","exec","r","parseInt","g","match","charAt","c","RegExp","$1","$2","$3","pad","str","len","toString","saveImage","img","SAVE_IMAGE","image","saveStamp","props_1","tslib_1.__values","props_1_1","backgroundColor","strokeColor","textColor","SAVE_STAMP","stampData","signatures","docType","FileUtil","find","format","SIGN","signaturesData","documentType","downloadSigned","DOWNLOAD_SIGNED","Injectable","args","providedIn","HttpClient","ConfigService","SignatureConfig","SignatureConfigService","_signatureConfig","BehaviorSubject","_updatedConfig","asObservable","defineProperty","load","Promise","resolve","reject","configEndpoint","getConfigEndpoint","SIGNATURE_APP","get","toPromise","then","response","signatureConfig","catch","JSON","stringify","SignatureType","getSignatureType","id","TEXT","IMAGE","DIGITAL","QR_CODE","BAR_CODE","STAMP","HAND","name","icon","title","FileListWithParams","DraggableSignature","TEMP","Position","left","top","SignatureData","position","ret","number","signatureGuid","imageWidth","width","imageHeight","height","digitalProps","reason","contact","address","signaturePassword","date","DigitalSign","AddedSignature","SignatureProps","getDefault","f","Formatting","default","font","fontSize","underline","bold","italic","RemoveSign","CopySign","CopyChanges","StampCanvasProps","textExpansion","textRepeat","init","isMobile","zIndex","strokeWidth","radius","Border","widthOptions","push","widthOption","separator","SelectSignatureService","_observer","Subject","_selectSignature","select","RemoveSignatureService","_removeSignature","remove","ActiveSignatureService","_activeChange","changeActive","signId","SignaturesHolderService","Map","add","key","set","addId","has","delete","clear","values","items","items_1","items_1_1","elem","changeTemp","imageGuid","CopySignatureService","_copySignature","_observerChanges","_changesSignature","copy","copySign","notifyChanges","changes","$","jquery","Signature","_signatureService","_removeSignatureService","_copySignatureService","_activeSignatureService","_signaturesHolderService","active","unlock","copied","baseCopied","subject","activeChange","subscribe","debounceTime","sendSaveText","ngOnInit","getData","dragOver","$event","preventDefault","stopPropagation","dragStart","oldPosition","Utils","getMousePosition","dataTransfer","setData","dragging","x","y","isOnPage","top_1","correctPosition","currentPage","document","elementFromPoint","parent","hasClass","isText","getFormatting","formatting","fillFormatting","del","activation","isDigital","drop","isInit","onCopySign","ngAfterViewInit","setTimeout","element","focus","pageHeight","pageWidth","saveText","hideMenu","getMenuShift","menuWidth","Component","selector","template","Input","DragSignatureService","SignatureTabActivatorService","_super","tslib_1.__extends","TabActivatorService","SignatureAppComponent","_modalService","configService","uploadFilesService","_navigateService","_zoomService","pagePreloadService","_renderPrintService","passwordService","_windowService","_selectSignatureService","_signatureTabActivationService","_hostingComponentsService","_addDynamicComponentService","_dragSignatureService","_onCloseService","removeSignatureService","_excMessageService","_tabActivatorService","copySignatureService","files","countPages","formatDisabled","browseFilesModal","CommonModals","BrowseFiles","signatureTypes","signatureTypeCodes","signatureComponents","fileWasDropped","activeTabChange","tabId","activeSignatureTab","changeActiveTab","copySignature","componentRef","comp","instance","compPage","_b","pages","_c","createDraggableSign","addedSignature","createAddedSignature","addSignatureComponent","changesSignature","copyChanges","ids","ids_1","ids_1_1","compRef","removeSignature","ids_2","ids_2_1","destroy","updatedConfig","uploadsChange","uploads","rewriteConfig","obj","selectFile","selectDir","checkPreload","preloadPageCountConfig","preloadPages","passChange","pass","PasswordRequired","selectSignature","isDesktop","onResize","w","defaultDocumentConfig","isLoading","pageSelector","preloadPageCount","download","downloadOriginal","defaultDocument","print","browse","enableRightClick","textSignature","imageSignature","digitalSignature","qrCodeSignature","barCodeSignature","stampSignature","handSignature","openModal","open","closeModal","close","modalId","cleanSignatures","clearData","start","end","this_1","downloadFile","window","location","assign","onRightClick","enableRightClickConfig","getSignatureTypeConfig","textSignatureConfig","imageSignatureConfig","digitalSignatureConfig","qrCodeSignatureConfig","barCodeSignatureConfig","stampSignatureConfig","handSignatureConfig","dropSignature","documentPage","offset","currentPosition","attr","split","closeTab","signature","pageModel","dynamicDirective","viewContainerRef","addDynamicComponent","size","hideAll","target","parentElement","attributes","newSign","DrawHandSignature","DrawStampSignature","addTextSign","ngOnDestroy","prepareSignaturesData","OperationSuccess","_d","ids_3","ids_3_1","isPdf","codesConfig","isVisible","notCode","activeTab","fileDropped","ModalService","UploadFilesService","NavigateService","ZoomService","PagePreloadService","RenderPrintService","PasswordService","WindowService","HostingDynamicComponentService","AddDynamicComponentService","OnCloseService","ExceptionMessageService","SignatureListPanelComponent","_datePipe","removeSignatureEvent","EventEmitter","showDigitalInputs","transform","Date","getImage","deleteSign","emit","getSign","digitalId","dragLeave","selectDigital","isActive","parseDate","empty","loading","ngOnChanges","DatePipe","Output","SignatureTabComponent","disabled","showToolTip","toggleTab","ErrorMessage","changeMessage","NewBarQrCodeComponent","_elementRef","closePanel","saveCode","encodedImage","clean","nativeElement","querySelector","addSign","saveTemp","ElementRef","UploadSignatureComponent","handleFileInput","addFiles","uploadFiles","DndSignatureDirective","_uploadFilesService","onDrop","evt","Directive","HostListener","DndDirective","ContextMenuComponent","lock","translation","changeFormatting","removeSign","lockOut","saveChanges","selectFontSize","selectFont","selectColor","toggleBold","toggleItalic","toggleUnderline","toggleLock","CanvasComponent","_isDragged","_ctx","canvas","getContext","onMouseDown","e","pos","offsetX","offsetY","wEvent","beginPath","moveTo","onMouseUp","onMouseMove","lineTo","stroke","setColor","strokeStyle","toDataURL","getWidth","getHeight","ViewChild","static","ActiveCanvasService","RemoveCanvasService","_removeCanvas","StampCanvasComponent","_activeCanvasService","colorPickerBG","colorPickerC","borderWidth","onClose","redrawCanvas","refreshRadius","drawCircle","theFirst","fillStyle","fontDecoration","textAlign","fillText","makeTextUnderline","drawTextCircle","textWidth","measureText","startY","endY","underlineHeight","startX","endX","lineWidth","arc","Math","PI","fill","closePath","save","translate","rotate","num","rad","j","restore","toggleColorPicker","bg","selectBorderWidth","deleteCanvas","getLeft","getTop","calcDiff","resize","closeColorPickerBG","closeColorPickerC","getTranslation","inactive","TextMenuComponent","decoration","outFontSize","outFont","outBold","outItalic","outUnderline","outColor","fontSizeOptions","FormattingService","getFontSizeOptions","fontOptions","getFontOptions","colorPickerShow","off","on","fontElements","getElementsByTagName","getAttribute","removeAttribute","style","event","closePicker","SignatureLeftPanelComponent","newSignatureEvent","showNewCode","showUpload","getTitleIcon","getTitle","getName","closeUploadPanel","closeCodePanel","getCodeName","closeNewSignature","openNewSignature","HandModalComponent","_tabActivationService","defaultColor","selectedColor","saveSign","canvasComponent","onCloseOpen","StampModalComponent","stampCircles","textString","showText","sizeMagnifier","textProps","removeCanvas","activeId","lastProps","ctx","drawImage","reverse","addCircle","stampCircle","addCanvas","addText","toggleText","selectTextColor","deleteText","leaveText","getTextWidth","HostDynamicDirective","initializeApp","signatureConfigService","setupLoadingInterceptor","service","LoadingMaskInterceptorService","SignatureModule","library","fas","far","forRoot","apiEndpoint","DEFAULT_API_ENDPOINT","ngModule","NgModule","declarations","exports","imports","CommonModule","CommonComponentsModule","HttpClientModule","FontAwesomeModule","ClickOutsideModule","providers","provide","HTTP_INTERCEPTORS","useClass","ErrorInterceptorService","multi","APP_INITIALIZER","useFactory","deps","LoadingMaskService","entryComponents"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import {Injectable} from '@angular/core';\nimport {HttpClient, HttpResponse} from \"@angular/common/http\";\nimport {Api, ConfigService, FileCredentials, FileUtil} from \"@groupdocs.examples.angular/common-components\";\nimport {AddedSignature, DraggableSignature, FileListWithParams, SignatureProps} from \"./signature-models\";\nimport {map} from \"rxjs/operators\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SignatureService {\n\n  constructor(private _http: HttpClient, private _config: ConfigService) {\n  }\n\n  loadFiles(path: string) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_FILE_TREE, {'path': path}, Api.httpOptionsJson);\n  }\n\n  loadFile(credentials: FileCredentials) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_DOCUMENT_DESCRIPTION, credentials, Api.httpOptionsJson);\n  }\n\n  upload(file: File, url: string, rewrite: boolean, signType: string) {\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append('rewrite', String(rewrite));\n    if (signType) {\n      formData.append(\"signatureType\", signType);\n    }\n    if (url) {\n      formData.append(\"url\", url);\n    }\n\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.UPLOAD_DOCUMENTS, formData);\n  }\n\n  loadPage(credentials: FileCredentials, page: number) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_DOCUMENT_PAGE, {\n      'guid': credentials.guid,\n      'password': credentials.password,\n      'page': page\n    }, Api.httpOptionsJson);\n  }\n\n  getDownloadUrl(credentials: FileCredentials) {\n    return this._config.getSignatureApiEndpoint() + Api.DOWNLOAD_DOCUMENTS + '/?path=' + credentials.guid;\n  }\n\n  loadPrint(credentials: FileCredentials) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_PRINT, {\n      'guid': credentials.guid,\n      'password': credentials.password,\n    }, Api.httpOptionsJson);\n  }\n\n  loadPrintPdf(credentials: FileCredentials) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_PRINT_PDF, {\n      'guid': credentials.guid,\n      'password': credentials.password,\n    }, Api.httpOptionsJsonResponseTypeBlob);\n  }\n\n  getSignatures(path: string, type: string) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_FILE_TREE, {\n      'path': path,\n      'signatureType': type\n    }, Api.httpOptionsJson);\n  }\n\n  removeSignatures(guid: string, type: string) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.DELETE_SIGNATURE_FILE, {\n      'guid': guid,\n      'signatureType': type\n    }, Api.httpOptionsJson);\n  }\n\n  uploadSignature(data: FileListWithParams, rewrite: boolean) {\n    if (data.fileList.length > 1) {\n      for (let i = 0; i < data.fileList.length - 1; i++) {\n        this.upload(data.fileList.item(i), '', rewrite, data.signType);\n      }\n    }\n    return this.upload(data.fileList.item(data.fileList.length - 1), '', rewrite, data.signType);\n  }\n\n  getCode(text: string, temp: boolean, type: string) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_OPTICAL_CODE, {\n      'properties': {'text': text, 'temp': temp},\n      'signatureType': type\n    }, Api.httpOptionsJson);\n  }\n\n  loadSignatureImage(sign: DraggableSignature) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.LOAD_SIGNATURE_IMAGE, {\n      'guid': sign.guid,\n      'page': sign.pageNumber,\n      'signatureType': sign.type,\n      'password': ''\n    }, Api.httpOptionsJson).pipe(\n      map((props: AddedSignature) => {\n        props.guid = sign.guid;\n        return props;\n      }));\n  }\n\n  saveTextSignature(data: AddedSignature) {\n    const properties = data.props;\n    properties.fontColor = this.toRgb(properties.fontColor);\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_TEXT, {\n      'properties': properties\n    }, Api.httpOptionsJson).pipe(\n      map((props: SignatureProps) => {\n        props.fontColor = this.toHex(props.fontColor);\n        return props;\n      }));\n  }\n\n  private toRgb(color: string) {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(color);\n    if (result) {\n      const r = parseInt(result[1], 16);\n      const g = parseInt(result[2], 16);\n      const b = parseInt(result[3], 16);\n      return result ? 'rgb(' + r + ',' + g + ',' + b + ')' : '';\n    }\n    return color;\n  }\n\n  private toHex(color: string) {\n    // check if color is standard hex value\n    if (color.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i)) {\n      return (color.charAt(0) === \"#\") ? color : (\"#\" + color);\n      // check if color is RGB value -> convert to hex\n    } else if (color.match(/^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/)) {\n      const c = ([parseInt(RegExp.$1, 10), parseInt(RegExp.$2, 10), parseInt(RegExp.$3, 10)]),\n        pad = function (str) {\n          if (str.length < 2) {\n            for (let i = 0, len = 2 - str.length; i < len; i++) {\n              str = '0' + str;\n            }\n          }\n          return str;\n        };\n      if (c.length === 3) {\n        const r = pad(c[0].toString(16)),\n          g = pad(c[1].toString(16)),\n          b = pad(c[2].toString(16));\n        return '#' + r + g + b;\n      }\n      // else do nothing\n    } else {\n      return '';\n    }\n  }\n\n  saveImage(img: string) {\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_IMAGE, {\n      'image': img\n    }, Api.httpOptionsJson);\n  }\n\n  saveStamp(img: string, props: any[]) {\n    for (const properties of props) {\n      properties.backgroundColor = this.toRgb(properties.backgroundColor);\n      properties.strokeColor = this.toRgb(properties.strokeColor);\n      properties.textColor = this.toRgb(properties.textColor);\n    }\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SAVE_STAMP, {\n      'image': img,\n      'stampData': props\n    }, Api.httpOptionsJson);\n  }\n\n  sign(credentials: FileCredentials, signatures: any[]) {\n    const docType = FileUtil.find(credentials.guid, false).format;\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.SIGN, {\n      guid: credentials.guid,\n      password: credentials.password ? credentials.password : \"\",\n      signaturesData: signatures,\n      documentType: docType\n    }, Api.httpOptionsJson);\n  }\n\n  downloadSigned(credentials: FileCredentials, signatures: any[]) {\n    const docType = FileUtil.find(credentials.guid, false).format;\n    return this._http.post(this._config.getSignatureApiEndpoint() + Api.DOWNLOAD_SIGNED, {\n      guid: credentials.guid,\n      password: credentials.password,\n      signaturesData: signatures,\n      documentType: docType\n    }, Api.httpOptionsJsonResponseTypeBlob);\n  }\n}\n","export class SignatureConfig {\n  rewrite: boolean;\n  pageSelector: boolean;\n  download: boolean;\n  upload: boolean;\n  print: boolean;\n  browse: boolean;\n  enableRightClick: boolean;\n\n  filesDirectory: string;\n  fontsDirectory: string;\n  defaultDocument: string;\n  preloadPageCount: 0;\n  textSignature: boolean;\n  imageSignature: boolean;\n  digitalSignature: boolean;\n  qrCodeSignature: boolean;\n  barCodeSignature: boolean;\n  stampSignature: boolean;\n  handSignature: boolean;\n  downloadOriginal: boolean;\n  downloadSigned: boolean\n}\n","import {Injectable} from '@angular/core';\nimport {BehaviorSubject, Observable} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {Api, ConfigService} from \"@groupdocs.examples.angular/common-components\";\nimport {SignatureConfig} from \"./signature-config\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SignatureConfigService {\n\n  private _signatureConfig: BehaviorSubject<SignatureConfig> = new BehaviorSubject(new SignatureConfig());\n  private _updatedConfig: Observable<SignatureConfig> = this._signatureConfig.asObservable();\n\n  constructor(private _http: HttpClient, private _config: ConfigService) {\n  }\n\n  get updatedConfig() {\n    return this._updatedConfig;\n  }\n\n  load() {\n    return new Promise<void>((resolve, reject) => {\n      const configEndpoint = this._config.getConfigEndpoint(Api.SIGNATURE_APP);\n      this._http.get(configEndpoint, Api.httpOptionsJson).toPromise().then((response: SignatureConfig) => {\n        const signatureConfig = <SignatureConfig>response;\n        this._signatureConfig.next(signatureConfig);\n        resolve();\n      }).catch((response: any) => {\n        reject(`Could not load signature config: ${JSON.stringify(response)}`);\n      });\n    });\n  }\n}\n","import {Formatting} from \"@groupdocs.examples.angular/common-components\";\n\nexport class Signature {\n  guid: string;\n  image: string;\n  name: string;\n  text: string;\n  fontColor: string;\n}\n\nexport class SignatureType {\n  public static TEXT = {id: 'text', name: 'Text signatures', icon: 'font', title: ''};\n  public static IMAGE = {id: 'image', name: 'Uploaded Images', icon: 'image', title: 'Add image signature'};\n  public static QR_CODE = {id: 'qrCode', name: 'QR codes', icon: 'qrcode', title: 'New QR code'};\n  public static BAR_CODE = {id: 'barCode', name: 'Bar codes', icon: 'barcode', title: 'New Bar code'};\n  public static DIGITAL = {\n    id: 'digital',\n    name: 'Digital signatures',\n    icon: 'fingerprint',\n    title: 'New digital signature'\n  };\n  public static STAMP = {id: 'stamp', name: 'Stamps', icon: 'stamp', title: ''};\n  public static HAND = {id: 'hand', name: 'Signatures', icon: 'signature', title: ''};\n\n  public static getSignatureType(id: string) {\n    switch (id) {\n      case SignatureType.TEXT.id:\n        return SignatureType.TEXT;\n      case SignatureType.IMAGE.id:\n        return SignatureType.IMAGE;\n      case SignatureType.DIGITAL.id:\n        return SignatureType.DIGITAL;\n      case SignatureType.QR_CODE.id:\n        return SignatureType.QR_CODE;\n      case SignatureType.BAR_CODE.id:\n        return SignatureType.BAR_CODE;\n      case SignatureType.STAMP.id:\n        return SignatureType.STAMP;\n      case SignatureType.HAND.id:\n        return SignatureType.HAND;\n    }\n  }\n}\n\nexport class FileListWithParams {\n  fileList: FileList;\n  signType: string;\n\n  constructor(fileList: FileList, signType: string) {\n    this.fileList = fileList;\n    this.signType = signType;\n  }\n}\n\nexport class OpticalCodeModel {\n  encodedImage: string;\n  text: string;\n  temp: boolean;\n}\n\nexport class DraggableSignature {\n  public static TEMP = \"temp\";\n  guid: string;\n  type: string;\n  position: Position;\n  pageNumber: number;\n  digitalProps: DigitalSign;\n}\n\nexport class Position {\n  left: number;\n  top: number;\n\n  constructor(left: number, top: number) {\n    this.left = left;\n    this.top = top;\n  }\n}\n\nexport class SignatureData {\n  reason: string;\n  contact: string;\n  address: string;\n  date: string;\n  signaturePassword: string;\n  signatureGuid: string;\n  signatureType: string;\n  pageNumber: number;\n  left: number;\n  top: number;\n  imageWidth: number;\n  imageHeight: number;\n  angle: number;\n\n  public static map(data: AddedSignature, type: string, position: Position) {\n    const ret = new SignatureData();\n    ret.signatureType = type;\n    ret.pageNumber = data.number;\n    ret.left = position.left;\n    ret.top = position.top;\n    ret.signatureGuid = data.guid;\n    ret.imageWidth = data.width;\n    ret.imageHeight = data.height;\n    if (data.digitalProps) {\n      ret.reason = data.digitalProps.reason;\n      ret.contact = data.digitalProps.contact;\n      ret.address = data.digitalProps.address;\n      ret.signaturePassword = data.digitalProps.signaturePassword;\n      ret.date = data.digitalProps.date;\n    }\n\n    return ret;\n  }\n}\n\nexport class DigitalSign {\n  reason: string;\n  contact: string;\n  address: string;\n  date: string;\n  signaturePassword: string;\n}\n\nexport class AddedSignature {\n\n  constructor() {\n    this.height = 0;\n    this.width = 0;\n  }\n\n  guid: string;\n  props: SignatureProps;\n  data: string;\n  width: number;\n  height: number;\n  number: number;\n  digitalProps: DigitalSign;\n}\n\nexport class SignatureProps {\n  imageGuid: string;\n  text: string;\n  width: number;\n  height: number;\n  bold: boolean;\n  italic: boolean;\n  underline: boolean;\n  font: string;\n  fontSize: number;\n  fontColor: string;\n\n  public static getDefault(): SignatureProps {\n    const props = new SignatureProps();\n    props.text = \"\";\n    const f = Formatting.default();\n    props.fontColor = f.color;\n    props.font = f.font;\n    props.fontSize = f.fontSize;\n    props.underline = f.underline;\n    props.bold = f.bold;\n    props.italic = f.italic;\n    return props;\n  }\n}\n\nexport class RemoveSign {\n  guid: string;\n  id: number;\n  type: string;\n}\n\nexport class CopySign {\n  guid: string;\n  id: number;\n  type: string;\n}\n\nexport class CopyChanges {\n  guid: string;\n  id: number;\n  width: number;\n  height: number;\n  position: Position;\n  props: SignatureProps;\n}\n\nexport class StampCanvasProps {\n  id: number;\n  text: string;\n  width: number;\n  height: number;\n  zIndex: number;\n  backgroundColor: string;\n  strokeColor: string;\n  strokeWidth: number;\n  fontSize: number;\n  font: string;\n  textColor: string;\n  radius: number;\n  bold: boolean;\n  italic: boolean;\n  underline: boolean;\n  textExpansion = 0.173;\n  textRepeat = 1;\n\n  constructor() {\n  }\n\n  init(isMobile) {\n    this.text = \"\";\n    this.width = isMobile ? 103 : 153;\n    this.height = isMobile ? 103 : 153;\n    this.zIndex = 10;\n    this.backgroundColor = \"rgb(255, 255, 255)\";\n    this.strokeColor = \"rgb(51, 51, 51)\";\n    this.strokeWidth = 1;\n    this.fontSize = 19;\n    this.font = \"Arial\";\n    this.textColor = \"rgb(51, 51, 51)\";\n    this.radius = 76.5;\n    this.bold = false;\n    this.italic = false;\n    this.underline = false;\n    return this;\n  }\n}\n\nexport class Border {\n  public static widthOptions() {\n    const ret = []\n    for (let i = 1; i <= 10; i++) {\n      ret.push(this.widthOption(i));\n    }\n    return ret;\n  }\n\n  public static widthOption(width: number) {\n    return {value: width, name: width + 'px', separator: false}\n  }\n}\n\nexport class Downloads {\n  public static original = 'original';\n  public static signed = 'signed';\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {DraggableSignature} from \"./signature-models\";\n\nexport class SelectSignatureService {\n  private _observer: Subject<DraggableSignature> = new Subject();\n  private readonly _selectSignature: Observable<DraggableSignature> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get selectSignature(): Observable<DraggableSignature> {\n    return this._selectSignature;\n  }\n\n  select(sign: DraggableSignature): void {\n    this._observer.next(sign);\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {RemoveSign} from \"./signature-models\";\n\nexport class RemoveSignatureService {\n  private _observer: Subject<RemoveSign> = new Subject();\n  private readonly _removeSignature: Observable<RemoveSign> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get removeSignature(): Observable<RemoveSign> {\n    return this._removeSignature;\n  }\n\n  remove(id: RemoveSign): void {\n    this._observer.next(id);\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\n\nexport class ActiveSignatureService {\n  private _observer: Subject<number> = new Subject();\n  private readonly _activeChange: Observable<number> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get activeChange(): Observable<number> {\n    return this._activeChange;\n  }\n\n  changeActive(signId: number) {\n    this._observer.next(signId);\n  }\n}\n","import {DraggableSignature} from \"./signature-models\";\n\nexport class SignaturesHolderService {\n\n  private map = new Map<string, number[]>();\n\n  constructor() {\n  }\n\n  add(key: string) {\n    this.map.set(key, []);\n  }\n\n  addId(key: string, id: number) {\n    if (!this.map.has(key)) {\n      this.add(key);\n    }\n    const item = this.map.get(key);\n    item.push(id);\n  }\n\n  delete(key: string) {\n    this.map.delete(key);\n  }\n\n  has(key: string) {\n    return this.map.has(key);\n  }\n\n  clear() {\n    this.map.clear();\n  }\n\n  values() {\n    return this.map.values();\n  }\n\n  get(key: string) {\n    return this.map.get(key);\n  }\n\n  remove(key: string, id: number) {\n    const items = this.map.get(key);\n    this.delete(key);\n    if (items.length !== 1) {\n      this.add(key);\n      for (const elem of items) {\n        if (elem !== id) {\n          this.map.get(key).push(elem);\n        }\n      }\n    }\n  }\n\n  changeTemp(imageGuid: string, id: number) {\n    this.remove(DraggableSignature.TEMP, id);\n    this.addId(imageGuid, id);\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {CopyChanges, CopySign} from \"./signature-models\";\n\nexport class CopySignatureService {\n  private _observer: Subject<CopySign> = new Subject();\n  private readonly _copySignature: Observable<CopySign> = this._observer.asObservable();\n  private _observerChanges: Subject<CopyChanges> = new Subject();\n  private readonly _changesSignature: Observable<CopyChanges> = this._observerChanges.asObservable();\n\n  constructor() {\n  }\n\n  get copySignature(): Observable<CopySign> {\n    return this._copySignature;\n  }\n\n  copy(copySign: CopySign): void {\n    this._observer.next(copySign);\n  }\n\n  get changesSignature(): Observable<CopyChanges> {\n    return this._changesSignature;\n  }\n\n  notifyChanges(changes: CopyChanges): void {\n    this._observerChanges.next(changes);\n  }\n}\n","import {AfterViewInit, Component, Input, OnInit} from '@angular/core';\nimport {\n  Position,\n  AddedSignature,\n  SignatureType,\n  SignatureProps,\n  RemoveSign,\n  DraggableSignature,\n  CopySign,\n  CopyChanges\n} from \"../signature-models\";\nimport {Formatting, Utils} from \"@groupdocs.examples.angular/common-components\";\nimport {SignatureService} from \"../signature.service\";\nimport {RemoveSignatureService} from \"../remove-signature.service\";\nimport {ActiveSignatureService} from \"../active-signature.service\";\nimport * as jquery from 'jquery';\nimport {SignaturesHolderService} from \"../signatures-holder.service\";\nimport {CopySignatureService} from \"../copy-signature.service\";\nimport {Subject} from \"rxjs\";\nimport {debounceTime} from \"rxjs/operators\";\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-signature-component',\n  templateUrl: './signature.component.html',\n  styleUrls: ['./signature.component.less']\n})\nexport class Signature implements OnInit, AfterViewInit {\n  @Input() id: number;\n  @Input() data: AddedSignature;\n  @Input() position: Position;\n  @Input() type: string;\n  @Input() pageWidth: number;\n  @Input() pageHeight: number;\n  active = true;\n  unlock = true;\n  copied = false;\n  baseCopied = false;\n  private oldPosition: { x: number; y: number };\n\n  private subject: Subject<string> = new Subject();\n\n  constructor(private _signatureService: SignatureService,\n              private _removeSignatureService: RemoveSignatureService,\n              private _copySignatureService: CopySignatureService,\n              private _activeSignatureService: ActiveSignatureService,\n              private _signaturesHolderService: SignaturesHolderService) {\n\n    this._activeSignatureService.activeChange.subscribe((id: number) => {\n      if (this.id === id) {\n        this.active = true;\n      } else {\n        this.active = false;\n      }\n    });\n\n    this.subject.pipe(\n      debounceTime(300)\n    ).subscribe(text => {\n      this.notifyChanges();\n      this.sendSaveText();\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  getData() {\n    return 'data:image/png;base64,' + this.data.data;\n  }\n\n  dragOver($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n  }\n\n  dragStart($event: DragEvent) {\n    $event.preventDefault();\n    this.oldPosition = Utils.getMousePosition($event);\n    if ($event.dataTransfer) {\n      $event.dataTransfer.setData('text', 'foo');\n    }\n  }\n\n  dragging($event) {\n    $event.preventDefault();\n    const position = Utils.getMousePosition($event);\n    if (position.x && position.y && this.isOnPage(position)) {\n      const left = position.x - this.oldPosition.x;\n      const top = position.y - this.oldPosition.y;\n      this.position.left += left;\n      this.position.top += top;\n      this.correctPosition();\n      this.oldPosition = position;\n    }\n  }\n\n  isOnPage(position) {\n    const currentPage = document.elementFromPoint(position.x, position.y);\n    return currentPage && $(currentPage).parent().parent() &&\n      ($(currentPage).parent().parent().parent().hasClass(\"page\") ||\n        $(currentPage).parent().parent().parent().parent().parent().hasClass(\"page\"));\n  }\n\n  isText() {\n    return SignatureType.TEXT.id === this.type;\n  }\n\n  getFormatting() {\n    const f = this.data.props;\n    const formatting = Formatting.default();\n    if (f) {\n      formatting.fontSize = f.fontSize;\n      formatting.font = f.font;\n      formatting.color = f.fontColor;\n      formatting.bold = f.bold;\n      formatting.underline = f.underline;\n      formatting.italic = f.italic;\n    }\n    return formatting;\n  }\n\n  saveTextSignature($event: Formatting) {\n    if (this.data.props) {\n      this.fillFormatting($event);\n      this.notifyChanges();\n      this.sendSaveText();\n    }\n  }\n\n  private fillFormatting(formatting: Formatting) {\n    this.data.props.fontSize = formatting.fontSize;\n    this.data.props.font = formatting.font;\n    this.data.props.bold = formatting.bold;\n    this.data.props.italic = formatting.italic;\n    this.data.props.underline = formatting.underline;\n    this.data.props.fontColor = formatting.color;\n  }\n\n  remove() {\n    const del = new RemoveSign();\n    del.guid = this.data.guid;\n    del.id = this.id;\n    del.type = this.type;\n    this._removeSignatureService.remove(del);\n  }\n\n  activation() {\n    this._activeSignatureService.changeActive(this.id);\n  }\n\n  isDigital() {\n    return this.type === SignatureType.DIGITAL.id;\n  }\n\n  width($event) {\n    this.data.width += $event;\n    if (!this.unlock) {\n      this.data.height += $event;\n    }\n    this.correctPosition();\n    this.notifyChanges();\n  }\n\n  height($event) {\n    this.data.height += $event;\n    if (!this.unlock) {\n      this.data.width += $event;\n    }\n    this.correctPosition();\n    this.notifyChanges();\n  }\n\n  left($event) {\n    if (this.unlock) {\n      this.position.left += $event;\n    }\n    this.correctPosition();\n    this.notifyChanges();\n  }\n\n  top($event) {\n    if (this.unlock) {\n      this.position.top += $event;\n    }\n    this.correctPosition();\n    this.notifyChanges();\n  }\n\n  notifyChanges() {\n    const changes = new CopyChanges();\n    changes.guid = this.data.guid;\n    changes.id = this.id;\n    changes.position = this.position;\n    changes.width = this.data.width;\n    changes.height = this.data.height;\n    changes.props = this.data.props;\n    this._copySignatureService.notifyChanges(changes);\n  }\n\n  drop($event: DragEvent) {\n    $event.stopPropagation();\n    $event.preventDefault();\n  }\n\n  isInit() {\n    return this.data.width === 0 && this.data.height === 0;\n  }\n\n  onCopySign() {\n    const copy = new CopySign();\n    copy.guid = this.data.guid;\n    copy.id = this.id;\n    copy.type = this.type;\n    this._copySignatureService.copy(copy);\n  }\n\n  ngAfterViewInit(): void {\n    if (this.type === SignatureType.TEXT.id) {\n      setTimeout(() => {\n        const element = $(\"#text\");\n        if (element) {\n          element.focus();\n        }\n      }, 100);\n    }\n  }\n\n  private correctPosition() {\n    if (this.position.left < 0) {\n      this.position.left = 0;\n    }\n    if (this.position.top < 0) {\n      this.position.top = 0;\n    }\n    if (this.position.top + this.data.height > this.pageHeight) {\n      this.position.top = this.pageHeight - this.data.height;\n    }\n    if (this.position.left + this.data.width > this.pageWidth) {\n      this.position.left = this.pageWidth - this.data.width;\n    }\n  }\n\n  saveText(value: string) {\n    this.data.props.text = value;\n    this.subject.next(value);\n  }\n\n  private sendSaveText() {\n    this._signatureService.saveTextSignature(this.data).subscribe((p: SignatureProps) => {\n      if (DraggableSignature.TEMP === this.data.guid) {\n        this._signaturesHolderService.changeTemp(p.imageGuid, this.id);\n        this.data.guid = p.imageGuid;\n      }\n      this.data.props = p;\n    });\n  }\n\n  hideMenu($event) {\n    this._activeSignatureService.changeActive(null);\n  }\n\n  getMenuShift() {\n    const menuWidth = this.type === SignatureType.TEXT.id ? 426 : 148;\n    return this.data.width > menuWidth ? 0 : (this.data.width - menuWidth) * 0.5;\n  }\n}\n","import {DraggableSignature} from \"./signature-models\";\n\nexport class DragSignatureService {\n  public sign: DraggableSignature;\n\n  constructor() {\n  }\n}\n","import {TabActivatorService} from \"@groupdocs.examples.angular/common-components\";\n\nexport class SignatureTabActivatorService extends TabActivatorService {\n\n  constructor() {\n    super();\n  }\n}\n","import {Component, ComponentRef, OnDestroy, OnInit} from '@angular/core';\nimport {SignatureService} from \"./signature.service\";\nimport {\n  FileDescription,\n  FileModel,\n  ModalService,\n  UploadFilesService,\n  NavigateService,\n  PagePreloadService,\n  PageModel,\n  ZoomService,\n  RenderPrintService,\n  FileUtil,\n  PasswordService,\n  FileCredentials,\n  CommonModals,\n  HostingDynamicComponentService,\n  AddDynamicComponentService,\n  OnCloseService,\n  ExceptionMessageService,\n  WindowService,\n  Utils,\n  TabActivatorService\n} from \"@groupdocs.examples.angular/common-components\";\nimport {SignatureConfig} from \"./signature-config\";\nimport {SignatureConfigService} from \"./signature-config.service\";\nimport {\n  AddedSignature,\n  CopyChanges,\n  CopySign,\n  DraggableSignature,\n  Position, RemoveSign,\n  SignatureData, SignatureProps,\n  SignatureType\n} from \"./signature-models\";\nimport {SelectSignatureService} from \"./select-signature.service\";\nimport {Signature} from \"./signature/signature.component\";\nimport {DragSignatureService} from \"./drag-signature.service\";\nimport {RemoveSignatureService} from \"./remove-signature.service\";\nimport * as jquery from 'jquery';\nimport {ActiveSignatureService} from \"./active-signature.service\";\nimport {SignaturesHolderService} from \"./signatures-holder.service\";\nimport {SignatureTabActivatorService} from \"./signature-tab-activator.service\";\nimport 'hammerjs';\nimport {CopySignatureService} from \"./copy-signature.service\";\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-signature',\n  templateUrl: './signature-app.component.html',\n  styleUrls: ['./signature-app.component.less']\n})\nexport class SignatureAppComponent implements OnDestroy, OnInit {\n  title = 'signature';\n  files: FileModel[] = [];\n  file: FileDescription;\n  signatureConfig: SignatureConfig;\n  countPages = 0;\n  formatDisabled = !this.file;\n  credentials: FileCredentials;\n  browseFilesModal = CommonModals.BrowseFiles;\n  isDesktop: boolean;\n  signatureTypes = [\n    SignatureType.TEXT,\n    SignatureType.IMAGE,\n    SignatureType.DIGITAL,\n    SignatureType.QR_CODE,\n    SignatureType.BAR_CODE,\n    SignatureType.STAMP,\n    SignatureType.HAND,\n  ];\n  signatureTypeCodes = [\n    SignatureType.QR_CODE,\n    SignatureType.BAR_CODE,\n  ];\n\n  signatureComponents = new Map<number, ComponentRef<any>>();\n  activeSignatureTab: string;\n  isLoading: boolean;\n  fileWasDropped = false;\n\n  constructor(private _signatureService: SignatureService,\n              private _modalService: ModalService,\n              configService: SignatureConfigService,\n              uploadFilesService: UploadFilesService,\n              private _navigateService: NavigateService,\n              private _zoomService: ZoomService,\n              pagePreloadService: PagePreloadService,\n              private _renderPrintService: RenderPrintService,\n              passwordService: PasswordService,\n              private _windowService: WindowService,\n              private _selectSignatureService: SelectSignatureService,\n              private _signatureTabActivationService: SignatureTabActivatorService,\n              private _hostingComponentsService: HostingDynamicComponentService,\n              private _addDynamicComponentService: AddDynamicComponentService,\n              private _dragSignatureService: DragSignatureService,\n              private _onCloseService: OnCloseService,\n              removeSignatureService: RemoveSignatureService,\n              private _activeSignatureService: ActiveSignatureService,\n              private _excMessageService: ExceptionMessageService,\n              private _signaturesHolderService: SignaturesHolderService,\n              private _tabActivatorService: TabActivatorService,\n              copySignatureService: CopySignatureService) {\n\n    this._tabActivatorService.activeTabChange.subscribe((tabId: string) => {\n      if (tabId === '1') {\n        if (this.activeSignatureTab) {\n          this._signatureTabActivationService.changeActiveTab(this.activeSignatureTab);\n        }\n        this.activeSignatureTab = null;\n      }\n    });\n\n    copySignatureService.copySignature.subscribe((copySign: CopySign) => {\n      const componentRef = this.signatureComponents.get(copySign.id);\n      if (componentRef) {\n        // @ts-ignore\n        const comp = (<Signature>componentRef).instance;\n        const compPage = comp.data.number;\n        comp.baseCopied = true;\n        for (const page of this.file.pages) {\n          if (page.number !== compPage) {\n            const sign = this.createDraggableSign(comp, copySign, page);\n            const addedSignature = this.createAddedSignature(copySign, comp, page);\n            const id = this.addSignatureComponent(addedSignature, sign, page, true);\n            this._signaturesHolderService.addId(sign.guid, id);\n          }\n        }\n      }\n    });\n\n    copySignatureService.changesSignature.subscribe((copyChanges: CopyChanges) => {\n      const componentRef = this.signatureComponents.get(copyChanges.id);\n      if (componentRef) {\n        const ids = this._signaturesHolderService.get(copyChanges.guid);\n        for (const id of ids) {\n          const compRef = this.signatureComponents.get(id);\n          if (compRef) {\n            // @ts-ignore\n            const comp = (<Signature>compRef).instance;\n            if (comp.id !== copyChanges.id && (comp.copied || comp.baseCopied)) {\n              comp.data.width = copyChanges.width;\n              comp.data.height = copyChanges.height;\n              comp.data.position = copyChanges.position;\n              comp.data.props = copyChanges.props;\n            }\n          }\n        }\n      }\n    });\n\n    removeSignatureService.removeSignature.subscribe((del: RemoveSign) => {\n      const ids = this._signaturesHolderService.get(del.guid);\n      for (const id of ids) {\n        if (del.type === SignatureType.DIGITAL.id || del.id === id) {\n          const componentRef = this.signatureComponents.get(id);\n          if (componentRef) {\n            componentRef.destroy();\n          }\n          this.signatureComponents.delete(id);\n          this._signaturesHolderService.remove(del.guid, id);\n        }\n      }\n    });\n\n    configService.updatedConfig.subscribe((signatureConfig) => {\n      this.signatureConfig = signatureConfig;\n    });\n\n    uploadFilesService.uploadsChange.subscribe((uploads) => {\n      if (uploads) {\n        let i: number;\n        for (i = 0; i < uploads.length; i++) {\n          this._signatureService.upload(uploads.item(i), '', this.rewriteConfig, null).subscribe((obj: FileCredentials) => {\n            this.fileWasDropped ? this.selectFile(obj.guid, '', '') : this.selectDir('');\n          });\n        }\n      }\n    });\n\n    pagePreloadService.checkPreload.subscribe((page: number) => {\n      if (this.preloadPageCountConfig !== 0) {\n        for (let i = page; i < page + 2; i++) {\n          if (i > 0 && i <= this.countPages && !this.file.pages[i - 1].data) {\n            this.preloadPages(i, i);\n          }\n        }\n      }\n    });\n\n    passwordService.passChange.subscribe((pass: string) => {\n      this.selectFile(this.credentials.guid, pass, CommonModals.PasswordRequired);\n    });\n\n    _selectSignatureService.selectSignature.subscribe((sign: DraggableSignature) => {\n      this.selectSignature(sign);\n    });\n\n    this.isDesktop = _windowService.isDesktop();\n    _windowService.onResize.subscribe((w) => {\n      this.isDesktop = _windowService.isDesktop();\n    });\n\n  }\n\n  private createDraggableSign(comp, copySign: CopySign, page) {\n    const sign = new DraggableSignature();\n    sign.type = comp.type;\n    sign.guid = copySign.guid;\n    sign.position = comp.position;\n    sign.pageNumber = page.number;\n    return sign;\n  }\n\n  private createAddedSignature(copySign: CopySign, comp, page) {\n    const addedSignature = new AddedSignature();\n    addedSignature.guid = copySign.guid;\n    addedSignature.data = comp.data.data;\n    if (comp.data.props) {\n      addedSignature.props = comp.data.props;\n    }\n    addedSignature.width = comp.data.width;\n    addedSignature.height = comp.data.height;\n    addedSignature.number = page.number;\n    return addedSignature;\n  }\n\n  ngOnInit(): void {\n    if (this.defaultDocumentConfig()) {\n      this.isLoading = true;\n      this.selectFile(this.defaultDocumentConfig(), \"\", \"\");\n    }\n  }\n\n  get rewriteConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.rewrite : true;\n  }\n\n  get zoomConfig(): boolean {\n    return false;\n  }\n\n  get pageSelectorConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.pageSelector : true;\n  }\n\n  get preloadPageCountConfig(): number {\n    return this.signatureConfig ? this.signatureConfig.preloadPageCount : 0;\n  }\n\n  get downloadConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.download : true;\n  }\n\n  get downloadOriginalConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.downloadOriginal : true;\n  }\n\n  get downloadSingedConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.downloadSigned : true;\n  }\n\n  get uploadConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.upload : true;\n  }\n\n  private defaultDocumentConfig() {\n    return this.signatureConfig ? this.signatureConfig.defaultDocument : \"\";\n  }\n\n  get printConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.print : true;\n  }\n\n  get browseConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.browse : true;\n  }\n\n  get htmlModeConfig(): boolean {\n    return false;\n  }\n\n  get enableRightClickConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.enableRightClick : true;\n  }\n\n  get textSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.textSignature : true;\n  }\n\n  get imageSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.imageSignature : true;\n  }\n\n  get digitalSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.digitalSignature : true;\n  }\n\n  get qrCodeSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.qrCodeSignature : true;\n  }\n\n  get barCodeSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.barCodeSignature : true;\n  }\n\n  get stampSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.stampSignature : true;\n  }\n\n  get handSignatureConfig(): boolean {\n    return this.signatureConfig ? this.signatureConfig.handSignature : true;\n  }\n\n  get currentPage(): number {\n    return this._navigateService.currentPage;\n  }\n\n  openModal(id: string) {\n    this._modalService.open(id);\n  }\n\n  closeModal(id: string) {\n    this._modalService.close(id);\n  }\n\n  selectDir($event: string) {\n    this._signatureService.loadFiles($event).subscribe((files: FileModel[]) => this.files = files || []);\n  }\n\n  selectFile($event: string, password: string, modalId: string) {\n    this.credentials = {guid: $event, password: password};\n    this.file = null;\n    this._signatureService.loadFile(this.credentials).subscribe((file: FileDescription) => {\n        this.file = file;\n        this.formatDisabled = !this.file;\n        if (file) {\n          const preloadPageCount = this.preloadPageCountConfig;\n          const countPages = file.pages ? file.pages.length : 0;\n          if (preloadPageCount > 0) {\n            this.preloadPages(1, preloadPageCount > countPages ? countPages : preloadPageCount);\n          }\n          this._navigateService.countPages = countPages;\n          this._navigateService.currentPage = 1;\n          this.countPages = countPages;\n          this.cleanSignatures();\n        }\n      }\n    );\n    if (modalId) {\n      this._modalService.close(modalId);\n    }\n    this.clearData();\n  }\n\n  preloadPages(start: number, end: number) {\n    for (let i = start; i <= end; i++) {\n      this._signatureService.loadPage(this.credentials, i).subscribe((page: PageModel) => {\n        this.file.pages[i - 1] = page;\n      });\n    }\n  }\n\n  upload($event: string) {\n    this._signatureService.upload(null, $event, this.rewriteConfig, null).subscribe(() => {\n      this.selectDir('');\n    });\n  }\n\n  downloadFile() {\n    if (this.formatDisabled)\n      return;\n    window.location.assign(this._signatureService.getDownloadUrl(this.credentials));\n  }\n\n  private clearData() {\n    if (!this.file || !this.file.pages) {\n      return;\n    }\n    for (const page of this.file.pages) {\n      page.data = null;\n    }\n  }\n\n  onRightClick($event: MouseEvent) {\n    return this.enableRightClickConfig;\n  }\n\n  getSignatureTypeConfig(id: string) {\n    switch (id) {\n      case SignatureType.TEXT.id:\n        return this.textSignatureConfig;\n      case SignatureType.IMAGE.id:\n        return this.imageSignatureConfig;\n      case SignatureType.DIGITAL.id:\n        return this.digitalSignatureConfig;\n      case SignatureType.QR_CODE.id:\n        return this.qrCodeSignatureConfig;\n      case SignatureType.BAR_CODE.id:\n        return this.barCodeSignatureConfig;\n      case SignatureType.STAMP.id:\n        return this.stampSignatureConfig;\n      case SignatureType.HAND.id:\n        return this.handSignatureConfig;\n    }\n  }\n\n  dragOver($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n  }\n\n  dropSignature($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n    const position = Utils.getMousePosition($event);\n\n    const currentPage = document.elementFromPoint(position.x, position.y);\n    if (currentPage && $(currentPage).parent().parent() && $(currentPage).parent().parent().parent().hasClass(\"page\")) {\n      const documentPage = $(currentPage).parent().parent()[0];\n      const left = position.x - $(documentPage).offset().left;\n      const top = position.y - $(documentPage).offset().top;\n      const currentPosition = new Position(left, top);\n      const sign = this._dragSignatureService.sign;\n      if (sign) {\n        const id = $(currentPage).parent().attr('id');\n        if (id) {\n          const split = id.split('-');\n          sign.pageNumber = split.length === 2 ? parseInt(split[1], 10) : sign.pageNumber;\n        }\n        sign.position = currentPosition;\n        this.selectSignature(sign);\n        this._dragSignatureService.sign = null;\n      }\n    }\n  }\n\n  private selectSignature(sign: DraggableSignature) {\n    if (sign.type === SignatureType.DIGITAL.id) {\n      const addedSignature = new AddedSignature();\n      addedSignature.digitalProps = sign.digitalProps;\n      addedSignature.guid = sign.guid;\n      addedSignature.number = sign.pageNumber;\n      for (const page of this.file.pages) {\n        const id = this.addSignatureComponent(addedSignature, sign, page);\n        this._signaturesHolderService.addId(sign.guid, id);\n      }\n      this.closeTab(sign.type);\n    } else {\n      this._signatureService.loadSignatureImage(sign).subscribe((signature: AddedSignature) => {\n        signature.number = sign.pageNumber;\n        const pageModel = this.file.pages.find(function (p) {\n          return p.number === sign.pageNumber;\n        });\n        const id = this.addSignatureComponent(signature, sign, pageModel);\n        this._signaturesHolderService.addId(sign.guid, id);\n        this.closeTab(sign.type);\n      });\n    }\n  }\n\n  private addSignatureComponent(addedSignature: AddedSignature, sign: DraggableSignature, page: PageModel, copied: boolean = false) {\n    const dynamicDirective = this._hostingComponentsService.find(page.number);\n    if (dynamicDirective) {\n      const viewContainerRef = dynamicDirective.viewContainerRef;\n      const selectSignature = this._addDynamicComponentService.addDynamicComponent(viewContainerRef, Signature);\n      const id = this.signatureComponents.size + 1;\n      while (addedSignature.width >= page.width || addedSignature.height >= page.height) {\n        addedSignature.width = addedSignature.width / 2;\n        addedSignature.height = addedSignature.height / 2;\n      }\n      (<Signature>selectSignature.instance).id = id;\n      (<Signature>selectSignature.instance).copied = copied;\n      (<Signature>selectSignature.instance).data = addedSignature;\n      (<Signature>selectSignature.instance).position = sign.position;\n      (<Signature>selectSignature.instance).type = sign.type;\n      (<Signature>selectSignature.instance).pageWidth = page.width;\n      (<Signature>selectSignature.instance).pageHeight = page.height;\n      this.signatureComponents.set(id, selectSignature);\n      this._activeSignatureService.changeActive(id);\n      return id;\n    }\n    return null;\n  }\n\n  private closeTab(type: string) {\n    this._signatureTabActivationService.changeActiveTab(type);\n  }\n\n  hideAll($event) {\n    if (($event.target.parentElement && $event.target.parentElement.attributes['name'] &&\n      $event.target.parentElement.attributes['name'].value === 'button') ||\n      ($event.target.parentElement &&\n        $event.target.parentElement.parentElement &&\n        $event.target.parentElement.parentElement.attributes['name'] &&\n        $event.target.parentElement.parentElement.attributes['name'].value === 'button') ||\n      ($event.target.parentElement &&\n        $event.target.parentElement.parentElement &&\n        $event.target.parentElement.parentElement.parentElement &&\n        $event.target.parentElement.parentElement.parentElement.parentElement &&\n        $event.target.parentElement.parentElement.parentElement.parentElement.attributes['name'] &&\n        $event.target.parentElement.parentElement.parentElement.parentElement.attributes['name'].value === 'button')) {\n\n      return;\n    }\n    this._onCloseService.close(true);\n  }\n\n  newSign($event: string) {\n    if (SignatureType.HAND.id === $event) {\n      this._modalService.open(CommonModals.DrawHandSignature);\n      this._signatureTabActivationService.changeActiveTab(SignatureType.HAND.id);\n    } else if (SignatureType.STAMP.id === $event) {\n      this._modalService.open(CommonModals.DrawStampSignature);\n      this._signatureTabActivationService.changeActiveTab(SignatureType.STAMP.id);\n    } else if (SignatureType.TEXT.id === $event) {\n      this.addTextSign();\n      this._signatureTabActivationService.changeActiveTab(SignatureType.TEXT.id);\n    }\n  }\n\n  private addTextSign() {\n    const signature = new AddedSignature();\n    signature.props = SignatureProps.getDefault();\n    signature.guid = DraggableSignature.TEMP;\n    const sign = new DraggableSignature();\n    sign.guid = DraggableSignature.TEMP;\n    sign.position = new Position(0, 0);\n    sign.type = SignatureType.TEXT.id;\n    const pageNumber = this._navigateService.currentPage;\n    signature.number = pageNumber;\n    sign.pageNumber = pageNumber;\n    const pageModel = this.file.pages.find(function (p) {\n      return p.number === pageNumber;\n    });\n    const id = this.addSignatureComponent(signature, sign, pageModel);\n    this._signaturesHolderService.addId(sign.guid, id);\n  }\n\n  ngOnDestroy(): void {\n    this.cleanSignatures();\n  }\n\n  private cleanSignatures() {\n    for (const componentRef of this.signatureComponents.values()) {\n      componentRef.destroy();\n    }\n    this.signatureComponents = new Map<number, ComponentRef<any>>();\n    this._signaturesHolderService.clear();\n  }\n\n  sign() {\n    const signatures = this.prepareSignaturesData();\n    this._signatureService.sign(this.credentials, signatures).subscribe((ret: any) => {\n      this._modalService.open(CommonModals.OperationSuccess);\n      this.selectFile(ret.guid, null, CommonModals.OperationSuccess);\n    });\n  }\n\n  private prepareSignaturesData() {\n    const signatures = [];\n    for (const ids of this._signaturesHolderService.values()) {\n      for (const id of ids) {\n        const componentRef = this.signatureComponents.get(id);\n        // @ts-ignore\n        const sign = (<Signature>componentRef).instance;\n        const data = sign.data;\n        const position = sign.position;\n        const type = sign.type;\n\n        if (DraggableSignature.TEMP !== data.guid) {\n          signatures.push(SignatureData.map(data, type, position));\n        }\n\n        if (SignatureType.DIGITAL.id === type) {\n          break;\n        }\n      }\n    }\n    return signatures;\n  }\n\n  isPdf() {\n    if (this.file) {\n      if (FileUtil.find(this.file.guid, false).format === \"Portable Document Format\") {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  codesConfig() {\n    return this.getSignatureTypeConfig(SignatureType.BAR_CODE.id) || this.getSignatureTypeConfig(SignatureType.QR_CODE.id);\n  }\n\n  isVisible(id: string) {\n    const notCode = id !== SignatureType.BAR_CODE.id && id !== SignatureType.QR_CODE.id;\n    return this.getSignatureTypeConfig(id) && (this.isDesktop || notCode);\n  }\n\n  activeTab($event: string) {\n    this.activeSignatureTab = $event;\n  }\n\n  fileDropped($event) {\n    this.fileWasDropped = $event;\n  }\n}\n","import {Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\nimport {DigitalSign, DraggableSignature, Position, Signature, SignatureType} from \"../signature-models\";\nimport {NavigateService} from \"@groupdocs.examples.angular/common-components\";\nimport {SelectSignatureService} from \"../select-signature.service\";\nimport {DragSignatureService} from \"../drag-signature.service\";\nimport {DatePipe} from \"@angular/common\";\nimport {SignaturesHolderService} from \"../signatures-holder.service\";\n\n\n@Component({\n  selector: 'gd-signature-list-panel',\n  templateUrl: './signature-list-panel.component.html',\n  styleUrls: ['./signature-list-panel.component.less']\n})\nexport class SignatureListPanelComponent implements OnInit, OnChanges {\n\n  @Input() signatures: Signature[];\n  @Input() icon: string;\n  @Input() signatureType: string;\n  @Input() isPdf: boolean;\n  @Input() loading: boolean;\n  @Output() removeSignatureEvent = new EventEmitter<string>();\n  showDigitalInputs = false;\n  digitalProps = new DigitalSign();\n  digitalId: string;\n\n  constructor(private _navigateService: NavigateService,\n              private _selectSignatureService: SelectSignatureService,\n              private _dragSignatureService: DragSignatureService,\n              private _datePipe: DatePipe,\n              private _signaturesHolderService: SignaturesHolderService) {\n    this.digitalProps.date = this._datePipe.transform(new Date(), 'dd-MM-yyyy');\n  }\n\n  ngOnInit() {\n  }\n\n  getImage(data: string) {\n    const dataImagePngBase64 = 'data:image/png;base64,';\n    return dataImagePngBase64 + data;\n  }\n\n  deleteSign(guid: string) {\n    this.removeSignatureEvent.emit(guid);\n  }\n\n  isDigital() {\n    return SignatureType.DIGITAL.id === this.signatureType;\n  }\n\n  private selectSignature(sign: DraggableSignature) {\n    this._selectSignatureService.select(sign);\n  }\n\n  private getSign(guid: string): DraggableSignature {\n    const sign = new DraggableSignature();\n    sign.type = this.signatureType;\n    sign.guid = guid;\n    sign.position = new Position(0, 0);\n    sign.pageNumber = this._navigateService.currentPage;\n    return sign;\n  }\n\n  select(guid: string) {\n    if (this.signatureType === SignatureType.DIGITAL.id) {\n      this.showDigitalInputs = this.digitalId !== guid;\n      this.digitalId = this.digitalId === guid ? null : guid;\n    } else {\n      const sign = this.getSign(guid);\n      this.selectSignature(sign);\n    }\n  }\n\n  dragOver($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n  }\n\n  dragLeave($event: DragEvent, guid: string) {\n    this._dragSignatureService.sign = this.getSign(guid);\n  }\n\n  selectDigital(guid: string) {\n    if (!this.isActive(guid)) {\n      return;\n    }\n    const sign = this.getSign(guid);\n    sign.digitalProps = this.digitalProps;\n    this.selectSignature(sign);\n  }\n\n  parseDate(value) {\n    return this._datePipe.transform(value, 'dd-MM-yyyy');\n  }\n\n  isActive(guid: string) {\n    return !this._signaturesHolderService.has(guid);\n  }\n\n  dragStart($event: DragEvent) { // for ff\n    $event.dataTransfer.setData('text', 'foo');\n  }\n\n  empty() {\n    return !this.loading && (!this.signatures || this.signatures.length === 0);\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.showDigitalInputs) {\n      this.showDigitalInputs = this.signatureType === SignatureType.DIGITAL.id;\n    }\n  }\n\n  drop($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {\n  CommonModals,\n  ExceptionMessageService, ModalService\n} from \"@groupdocs.examples.angular/common-components\";\nimport {SignatureTabActivatorService} from \"../signature-tab-activator.service\";\n\n@Component({\n  selector: 'gd-signature-tab',\n  templateUrl: './signature-tab.component.html',\n  styleUrls: ['./signature-tab.component.less']\n})\nexport class SignatureTabComponent implements OnInit {\n  @Input() id: string;\n  @Input() icon: string;\n  @Input() disabled = false;\n  @Input() tooltip: string;\n  @Output() activeTab = new EventEmitter<string>();\n  public active = false;\n  public showToolTip = false;\n\n  constructor(private _tabActivatorService: SignatureTabActivatorService,\n              private _modalService: ModalService,\n              private _excMessageService: ExceptionMessageService) {\n    this._tabActivatorService.activeTabChange.subscribe((tabId: string) => {\n      this.activation(tabId);\n    });\n  }\n\n  private activation(tabId: string) {\n    if (this.id === tabId) {\n      this.active = !this.active;\n      if (this.active) {\n        this.activeTab.emit(this.id);\n      } else {\n        this.activeTab.emit(\"\");\n      }\n    } else {\n      this.active = false;\n    }\n  }\n\n  ngOnInit() {\n  }\n\n  toggleTab() {\n    if (this.disabled) {\n      this._modalService.open(CommonModals.ErrorMessage);\n      this._excMessageService.changeMessage(\"Please open document first\");\n      return;\n    }\n    this._tabActivatorService.changeActiveTab(this.id);\n  }\n\n}\n","import {Component, ElementRef, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {SignatureService} from \"../signature.service\";\nimport {OpticalCodeModel} from \"../signature-models\";\nimport {Subject} from \"rxjs\";\nimport {debounceTime} from \"rxjs/operators\";\n\n@Component({\n  selector: 'gd-new-bar-qr-code',\n  templateUrl: './new-bar-qr-code.component.html',\n  styleUrls: ['./new-bar-qr-code.component.less']\n})\nexport class NewBarQrCodeComponent implements OnInit {\n  @Input() type: string;\n  @Input() icon: string;\n  @Input() name: string;\n  @Output() closePanel = new EventEmitter<boolean>();\n  encodedImage: string;\n\n  private subject: Subject<string> = new Subject();\n\n  constructor(private _signatureService: SignatureService,\n              private _elementRef: ElementRef) {\n    this.subject.pipe(\n      debounceTime(500)\n    ).subscribe(text => {\n      this.saveCode(text, true);\n    });\n  }\n\n  private saveCode(text: string, temp: boolean) {\n    if (text) {\n      this._signatureService.getCode(text, temp, this.type).subscribe((data: OpticalCodeModel) => {\n        this.encodedImage = data.encodedImage;\n        if (!temp) {\n          this.closePanel.emit(true);\n        }\n      });\n    } else {\n      this.clean();\n    }\n  }\n\n  private clean() {\n    this.encodedImage = null;\n  }\n\n  ngOnInit() {\n    this.clean();\n    setTimeout(() => {\n      const element = this._elementRef.nativeElement.querySelector(\"#text-input\");\n      element.focus();\n    }, 100);\n  }\n\n  addSign(text: string) {\n    this.saveCode(text, false);\n  }\n\n  saveTemp(text: string) {\n    this.subject.next(text);\n  }\n\n  getData() {\n    return 'data:image/png;base64,' + this.encodedImage;\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {FileListWithParams} from \"../signature-models\";\nimport {SignatureService} from \"../signature.service\";\n\n@Component({\n  selector: 'gd-upload-signature',\n  templateUrl: './upload-signature.component.html',\n  styleUrls: ['./upload-signature.component.less']\n})\nexport class UploadSignatureComponent implements OnInit {\n  @Input() signatureType: string;\n  @Input() rewrite: boolean;\n  @Output() closePanel = new EventEmitter<boolean>();\n\n  constructor(private _signatureService: SignatureService) {\n  }\n\n  ngOnInit() {\n  }\n\n  handleFileInput(files: FileList) {\n    this.addFiles(files);\n  }\n\n  addFiles(files) {\n    const data = new FileListWithParams(files, this.signatureType);\n    this._signatureService.uploadSignature(data, this.rewrite).subscribe(() => {\n      this.closePanel.emit(true);\n    });\n  }\n\n  uploadFiles($event: any) {\n    this.addFiles($event);\n  }\n}\n","import {Directive, EventEmitter, HostListener, Output} from '@angular/core';\nimport {DndDirective, UploadFilesService} from \"@groupdocs.examples.angular/common-components\";\n\n@Directive({\n  selector: '[gdDndSignature]'\n})\nexport class DndSignatureDirective extends DndDirective {\n  @Output() files = new EventEmitter();\n\n  constructor(_uploadFilesService: UploadFilesService) {\n    super(_uploadFilesService);\n  }\n\n  @HostListener('drop', ['$event'])\n  public onDrop(evt) {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const files = evt.dataTransfer.files;\n    if (files.length > 0) {\n      this.active = false;\n      this.files.emit(files);\n    }\n  }\n\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {\n  Formatting,\n  WindowService\n} from \"@groupdocs.examples.angular/common-components\";\n\n@Component({\n  selector: 'gd-context-menu',\n  templateUrl: './context-menu.component.html',\n  styleUrls: ['./context-menu.component.less']\n})\nexport class ContextMenuComponent implements OnInit {\n  @Input() formatting: Formatting = Formatting.default();\n  @Input() textMenu: boolean;\n  @Input() topPosition: number;\n  @Input() lock = false;\n  @Input() translation = 0;\n  @Output() changeFormatting = new EventEmitter<Formatting>();\n  @Output() removeSign = new EventEmitter<boolean>();\n  @Output() copySign = new EventEmitter<boolean>();\n  @Output() lockOut = new EventEmitter<boolean>();\n\n  isMobile: boolean;\n\n  constructor(private _windowService: WindowService) {\n    this.isMobile = _windowService.isMobile();\n    _windowService.onResize.subscribe((w) => {\n      this.isMobile = _windowService.isMobile();\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  saveChanges() {\n    this.changeFormatting.emit(this.formatting);\n  }\n\n  selectFontSize($event: number) {\n    this.formatting.fontSize = $event;\n    this.saveChanges();\n  }\n\n  selectFont($event: string) {\n    this.formatting.font = $event;\n    this.saveChanges();\n  }\n\n  selectColor($event: string) {\n    this.formatting.color = $event;\n    this.saveChanges();\n  }\n\n  toggleBold($event) {\n    this.formatting.bold = $event;\n    this.saveChanges();\n  }\n\n  toggleItalic($event) {\n    this.formatting.italic = $event;\n    this.saveChanges();\n  }\n\n  toggleUnderline($event) {\n    this.formatting.underline = $event;\n    this.saveChanges();\n  }\n\n  deleteSign() {\n    this.removeSign.emit(true);\n  }\n\n  toggleLock() {\n    this.lock = !this.lock;\n    this.lockOut.emit(this.lock);\n  }\n\n  onCopySign() {\n    this.copySign.emit(true);\n  }\n}\n","import {Component, ElementRef, Input, OnChanges, OnInit, SimpleChanges, ViewChild} from '@angular/core';\nimport {WindowService} from \"@groupdocs.examples.angular/common-components\";\n\n@Component({\n  selector: 'gd-canvas',\n  templateUrl: './canvas.component.html',\n  styleUrls: ['./canvas.component.less']\n})\nexport class CanvasComponent implements OnInit, OnChanges {\n\n  @Input() color: string;\n\n  _ctx: CanvasRenderingContext2D;\n  _isDragged = false;\n  private isDesktop: boolean;\n\n  @ViewChild('canvas', {static: true}) canvas: ElementRef;\n\n  constructor(private _windowService: WindowService) {\n    this.isDesktop = _windowService.isDesktop();\n    _windowService.onResize.subscribe((w) => {\n      this.isDesktop = _windowService.isDesktop();\n    });\n  }\n\n  ngOnInit() {\n    this._ctx = this.canvas.nativeElement.getContext('2d');\n  }\n\n  onMouseDown(e) {\n    let pos;\n    if (this.isDesktop) {\n      pos = {x: e.offsetX, y: e.offsetY};\n    } else {\n      const wEvent: DragEvent = <DragEvent>window.event;\n      pos = {x: wEvent.offsetX, y: wEvent.offsetY};\n    }\n    e.preventDefault();\n    this._isDragged = true;\n    this._ctx.beginPath();\n    this._ctx.moveTo(pos.x, pos.y);\n  }\n\n  onMouseUp(e) {\n    e.preventDefault();\n    this._isDragged = false;\n  }\n\n  onMouseMove(e) {\n    let pos;\n    if (this.isDesktop) {\n      pos = {x: e.offsetX, y: e.offsetY};\n    } else {\n      const wEvent: DragEvent = <DragEvent>window.event;\n      pos = {x: wEvent.offsetX, y: wEvent.offsetY};\n    }\n    e.preventDefault();\n    if (this._isDragged) {\n      this._ctx.lineTo(pos.x, pos.y);\n      this._ctx.stroke();\n    }\n  }\n\n  setColor(color) {\n    if (this._ctx) {\n      this._ctx.strokeStyle = color;\n    }\n  }\n\n  getImage(): string {\n    return this.canvas.nativeElement.toDataURL('image/png');\n  }\n\n  clear() {\n    this.canvas.nativeElement.width = this.canvas.nativeElement.width;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.setColor(this.color);\n  }\n\n  getWidth() {\n    return this.isDesktop ? 1079 : this._windowService.getWidth();\n  }\n\n  getHeight() {\n    return this.isDesktop ? 540 : this._windowService.getHeight();\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\n\nexport class ActiveCanvasService {\n  private _observer: Subject<number> = new Subject();\n  private readonly _activeChange: Observable<number> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get activeChange(): Observable<number> {\n    return this._activeChange;\n  }\n\n  changeActive(signId: number) {\n    this._observer.next(signId);\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\n\nexport class RemoveCanvasService {\n  private _observer: Subject<number> = new Subject();\n  private readonly _removeCanvas: Observable<number> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get removeCanvas(): Observable<number> {\n    return this._removeCanvas;\n  }\n\n  remove(id: number): void {\n    this._observer.next(id);\n  }\n}\n","import {AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild} from '@angular/core';\nimport {Border, StampCanvasProps} from \"../signature-models\";\nimport {ActiveCanvasService} from \"../active-canvas.service\";\nimport {RemoveCanvasService} from \"../remove-canvas.service\";\nimport {OnCloseService, WindowService} from \"@groupdocs.examples.angular/common-components\";\n\n@Component({\n  selector: 'gd-stamp-canvas',\n  templateUrl: './stamp-canvas.component.html',\n  styleUrls: ['./stamp-canvas.component.less']\n})\nexport class StampCanvasComponent implements OnInit, AfterViewInit {\n  @Input() id: number;\n  @Input() theFirst: boolean;\n  @Input() active: boolean;\n  @Input() props: StampCanvasProps;\n  @Input() width: number;\n  @Input() height: number;\n\n  _ctx: CanvasRenderingContext2D;\n  @ViewChild('canvas', {static: true}) canvas: ElementRef;\n  colorPickerBG = false;\n  colorPickerC = false;\n  borderWidth = Border.widthOptions();\n  isMobile: boolean;\n\n  constructor(private _activeCanvasService: ActiveCanvasService,\n              private _removeCanvas: RemoveCanvasService,\n              private _onCloseService: OnCloseService,\n              private _windowService: WindowService) {\n\n    this._onCloseService.onClose.subscribe((c) => {\n      this.colorPickerC = false;\n      this.colorPickerBG = false;\n    });\n\n    this._activeCanvasService.activeChange.subscribe((id: number) => {\n      this.active = this.id === id;\n    });\n\n    this.isMobile = _windowService.isMobile();\n    _windowService.onResize.subscribe((w) => {\n      this.isMobile = _windowService.isMobile();\n    });\n  }\n\n  get ctx(): CanvasRenderingContext2D {\n    return this._ctx;\n  }\n\n  activation() {\n    this._activeCanvasService.changeActive(this.id);\n  }\n\n  ngOnInit() {\n  }\n\n  ngAfterViewInit(): void {\n    this._ctx = this.canvas.nativeElement.getContext('2d');\n    this.redrawCanvas();\n  }\n\n  redrawCanvas() {\n    this.refreshRadius();\n    this.drawCircle();\n    if (this.props.text) {\n      if (this.theFirst) {\n        this._ctx.fillStyle = this.props.textColor;\n        this._ctx.font = this.fontDecoration() + \" \" + this.props.fontSize + 'px ' + this.props.font;\n        this._ctx.textAlign = 'center';\n        this._ctx.fillText(this.props.text, this.props.width / 2, this.props.height / 2 + this.props.fontSize / 2);\n        if (this.props.underline) {\n          this.makeTextUnderline();\n        }\n      } else {\n        this.drawTextCircle();\n      }\n    }\n  }\n\n  private fontDecoration(): string {\n    const bold = (this.props.bold) ? \"bold\" : \"\";\n    const italic = (this.props.italic) ? \"italic\" : \"\";\n    return bold + \" \" + italic;\n  }\n\n  private makeTextUnderline() {\n    const x = this.props.width / 2;\n    const y = this.props.height / 2;\n    const textWidth = this._ctx.measureText(this.props.text).width;\n    const startY = y + this.props.fontSize;\n    const endY = startY;\n    let underlineHeight = this.props.fontSize / 15;\n    if (underlineHeight < 1) {\n      underlineHeight = 1;\n    }\n    this._ctx.beginPath();\n    const startX = x - (textWidth / 2);\n    const endX = x + (textWidth / 2);\n    this._ctx.strokeStyle = this.props.textColor;\n    this._ctx.lineWidth = underlineHeight;\n    this._ctx.moveTo(startX, startY);\n    this._ctx.lineTo(endX, endY);\n    this._ctx.strokeStyle = 'blue';\n    this._ctx.stroke();\n  }\n\n  private drawCircle() {\n    const backgroundColor = (this.props.backgroundColor === \"\") ? \"rgb(255, 255, 255)\" : this.props.backgroundColor;\n    const x = this.props.width / 2;\n    const y = this.props.height / 2;\n    this._ctx.beginPath();\n    this._ctx.arc(x, y, this.props.radius, 0, 2 * Math.PI);\n    this._ctx.lineWidth = this.props.strokeWidth;\n    this._ctx.strokeStyle = this.props.strokeColor;\n    this._ctx.stroke();\n    this._ctx.fillStyle = backgroundColor;\n    this._ctx.fill();\n    this._ctx.closePath();\n  };\n\n  private drawTextCircle() {\n    const x = this.props.width / 2;\n    const y = this.props.height / 2;\n    this._ctx.save();\n    this._ctx.translate(x, y);\n    this._ctx.rotate(Math.PI / 2);\n    this._ctx.fillStyle = this.props.textColor;\n    this._ctx.font = this.fontDecoration() + \" \" + this.props.fontSize + 'px ' + this.props.font;\n\n    const num = this.props.textExpansion + (this.props.fontSize / 100);\n    const rad = this.props.radius - (this.props.fontSize / 2);\n    for (let i = 0; i < this.props.textRepeat; i++) {\n      for (let j = 0; j < this.props.text.length; j++) {\n        this._ctx.save();\n        this._ctx.rotate(j * num + num * this.props.text.length * i);\n        this._ctx.fillText(this.props.text[j], 0, -(rad));\n        this._ctx.restore();\n      }\n    }\n    this._ctx.restore();\n  };\n\n  private refreshRadius() {\n    if (this.props.strokeWidth > 1) {\n      this.props.radius = (this.props.width / 2) - (this.props.strokeWidth / 2);\n    } else {\n      this.props.radius = (this.props.width / 2);\n    }\n  }\n\n  toggleColorPicker($event, bg: boolean) {\n    $event.preventDefault();\n    $event.stopPropagation();\n    if (bg) {\n      this.colorPickerBG = !this.colorPickerBG;\n    } else {\n      this.colorPickerC = !this.colorPickerC;\n    }\n  }\n\n  selectColor(bg: boolean, $event) {\n    if (bg) {\n      this.props.backgroundColor = $event;\n      this.colorPickerBG = false;\n    } else {\n      this.props.strokeColor = $event;\n      this.colorPickerC = false;\n    }\n    this.redrawCanvas();\n  }\n\n  selectBorderWidth($event) {\n    this.props.strokeWidth = $event.value;\n    this.redrawCanvas();\n  }\n\n  deleteCanvas() {\n    this._removeCanvas.remove(this.id);\n    this.redrawCanvas();\n  }\n\n  getLeft() {\n    return (this.width - this.props.width) / 2;\n  }\n\n  getTop() {\n    return (this.height - (this.isMobile ? 62 : 0) - this.props.height) / 2 - this.calcDiff();\n  }\n\n  private calcDiff() {\n    return (this.active && !this.isMobile) ? 37 : 0;\n  }\n\n  resize($event) {\n    this.props.width += $event;\n    this.props.height += $event;\n  }\n\n  closeColorPickerBG($event) {\n    this.colorPickerBG = !$event;\n  }\n\n  closeColorPickerC($event) {\n    this.colorPickerC = !$event;\n  }\n\n  getTranslation() {\n    this.refreshRadius();\n    const menuWidth = 148 * 0.5;\n    return this.props.radius < menuWidth ? (menuWidth - this.props.radius) : (this.props.radius - menuWidth);\n  }\n\n  inactive($event: Event) {\n    this._activeCanvasService.changeActive(null);\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {FormattingService, OnCloseService, Option} from \"@groupdocs.examples.angular/common-components\";\nimport * as jquery from 'jquery';\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-text-menu',\n  templateUrl: './text-menu.component.html',\n  styleUrls: ['./text-menu.component.less']\n})\nexport class TextMenuComponent implements OnInit {\n  @Input() blur: boolean;\n  @Input() fontSize: number;\n  @Input() font: string;\n  @Input() bold: boolean;\n  @Input() italic: boolean;\n  @Input() underline: boolean;\n  @Input() color: string;\n  @Input() decoration = true;\n\n  @Output() outFontSize = new EventEmitter<number>();\n  @Output() outFont = new EventEmitter<string>();\n  @Output() outBold = new EventEmitter<boolean>();\n  @Output() outItalic = new EventEmitter<boolean>();\n  @Output() outUnderline = new EventEmitter<boolean>();\n  @Output() outColor = new EventEmitter<string>();\n\n  fontSizeOptions = FormattingService.getFontSizeOptions();\n  fontOptions = FormattingService.getFontOptions();\n  colorPickerShow = false;\n\n\n  constructor(private _onCloseService: OnCloseService) {\n    _onCloseService.onClose.subscribe(() => {\n      this.colorPickerShow = false;\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  selectFontSize($event: Option) {\n    $(\".gd-wrapper\").off(\"keyup\");\n    this.outFontSize.emit($event.value);\n    $(\".gd-wrapper\").on(\"keyup\", () => {\n      const fontElements = document.getElementsByTagName(\"font\");\n      for (let i = 0, len = fontElements.length; i < len; ++i) {\n        if (fontElements[i].getAttribute('size') === \"7\") {\n          fontElements[i].removeAttribute(\"size\");\n          fontElements[i].style.fontSize = $event + \"px\";\n        }\n      }\n    });\n  }\n\n  selectFont($event: Option) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.outFont.emit($event.value);\n  }\n\n  toggleColorPicker($event) {\n    $event.preventDefault();\n    $event.stopPropagation();\n    this.colorPickerShow = !this.colorPickerShow;\n  }\n\n  selectColor($event: string) {\n    this.colorPickerShow = false;\n    this.outColor.emit($event);\n  }\n\n  toggleBold(event) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.outBold.emit(!this.bold);\n  }\n\n  toggleItalic(event) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.outItalic.emit(!this.italic);\n  }\n\n  toggleUnderline(event) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.outUnderline.emit(!this.underline);\n  }\n\n  closePicker($event) {\n    this.colorPickerShow = !$event;\n  }\n}\n","import {Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges} from '@angular/core';\nimport {Signature, SignatureType} from \"../signature-models\";\nimport {SignatureService} from \"../signature.service\";\n\n@Component({\n  selector: 'gd-signature-left-panel',\n  templateUrl: './signature-left-panel.component.html',\n  styleUrls: ['./signature-left-panel.component.less']\n})\nexport class SignatureLeftPanelComponent implements OnInit, OnChanges {\n  @Input() rewrite: boolean;\n  @Input() isPdf: boolean;\n  @Input() id: string;\n  @Output() newSignatureEvent = new EventEmitter<string>();\n  public showNewCode = false;\n  public showUpload = false;\n  signatures: Signature[];\n  loading = true;\n\n  constructor(private _signatureService: SignatureService) {\n  }\n\n  getSignatures(tabId: string) {\n    this._signatureService.getSignatures('', tabId).subscribe((signatures: Signature[]) => {\n      this.signatures = signatures || [];\n      this.loading = false;\n    });\n  }\n\n  ngOnInit() {\n    this.init();\n  }\n\n  private init() {\n    this.loading = true;\n    this.signatures = [];\n    this.getSignatures(this.id);\n    this.showNewCode = false;\n    this.showUpload = false;\n  }\n\n  getTitleIcon() {\n    return this.showUpload || this.showNewCode ? 'times' : 'plus';\n  }\n\n  getTitle() {\n    if (!this.id) {\n      return \"\";\n    }\n    const signatureType = SignatureType.getSignatureType(this.id);\n    return (this.showUpload || this.showNewCode) ? signatureType.title : signatureType.name;\n  }\n\n  getName() {\n    if (!this.id) {\n      return \"\";\n    }\n    const signatureType = SignatureType.getSignatureType(this.id);\n    return signatureType.name;\n  }\n\n  removeSignature($event: string, type: string) {\n    this._signatureService.removeSignatures($event, type).subscribe(() => this.getSignatures(type));\n  }\n\n  closeUploadPanel($event: boolean) {\n    this.showUpload = !$event;\n    this.getSignatures(this.id);\n  }\n\n  closeCodePanel($event: boolean) {\n    this.showNewCode = !$event;\n    this.getSignatures(this.id);\n  }\n\n  getCodeName() {\n    if (!this.id) {\n      return \"\";\n    }\n    return SignatureType.QR_CODE.id === this.id ? 'Qr Code' : (SignatureType.BAR_CODE.id === this.id ? 'Bar Code' : '');\n  }\n\n  icon() {\n    if (!this.id) {\n      return \"\";\n    }\n    return SignatureType.getSignatureType(this.id).icon;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    this.init();\n  }\n\n  closeNewSignature() {\n    if (SignatureType.DIGITAL.id === this.id || SignatureType.IMAGE.id === this.id) {\n      this.showUpload = false;\n    } else if (SignatureType.BAR_CODE.id === this.id || SignatureType.QR_CODE.id === this.id) {\n      this.showNewCode = false;\n    }\n  }\n\n  openNewSignature() {\n    if (this.showUpload || this.showNewCode) {\n      return;\n    }\n    if (SignatureType.DIGITAL.id === this.id || SignatureType.IMAGE.id === this.id) {\n      this.showUpload = true;\n    } else if (SignatureType.BAR_CODE.id === this.id || SignatureType.QR_CODE.id === this.id) {\n      this.showNewCode = true;\n    } else {\n      this.newSignatureEvent.emit(this.id);\n    }\n  }\n}\n","import {Component, OnInit} from '@angular/core';\nimport {SignatureService} from \"../signature.service\";\nimport {SignatureTabActivatorService} from \"../signature-tab-activator.service\"\nimport {CanvasComponent} from \"../canvas/canvas.component\";\nimport {SignatureType} from \"../signature-models\";\nimport {CommonModals, ModalService} from \"@groupdocs.examples.angular/common-components\";\n\n@Component({\n  selector: 'gd-hand-modal',\n  templateUrl: './hand-modal.component.html',\n  styleUrls: ['./hand-modal.component.less']\n})\nexport class HandModalComponent implements OnInit {\n  defaultColor = '#000000';\n  selectedColor = this.defaultColor;\n  colorPickerShow = false;\n\n  constructor(private _signatureService: SignatureService,\n              private _tabActivationService: SignatureTabActivatorService,\n              private _modalService: ModalService) {\n  }\n\n  ngOnInit() {\n  }\n\n  selectColor(color: string) {\n    this.selectedColor = color;\n    this.colorPickerShow = false;\n  }\n\n  saveSign(canvasComponent: CanvasComponent) {\n    const img = canvasComponent.getImage();\n    this._signatureService.saveImage(img).subscribe(() => {\n      this._tabActivationService.changeActiveTab(SignatureType.HAND.id);\n    });\n    this.clear(canvasComponent);\n    this.close();\n  }\n\n  private close() {\n    this._modalService.close(CommonModals.DrawHandSignature);\n  }\n\n  toggleColorPicker($event) {\n    $event.preventDefault();\n    $event.stopPropagation();\n    this.colorPickerShow = !this.colorPickerShow;\n  }\n\n  closePicker($event) {\n    this.colorPickerShow = !$event;\n  }\n\n  onCloseOpen(canvasComponent: CanvasComponent, $event) {\n    this.clear(canvasComponent);\n  }\n\n  private clear(canvasComponent: CanvasComponent) {\n    this.selectedColor = this.defaultColor;\n    canvasComponent.clear();\n  }\n}\n","import {Component, ComponentRef, ElementRef, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {SignatureType, StampCanvasProps} from \"../signature-models\";\nimport {ActiveCanvasService} from './../active-canvas.service'\nimport {SignatureService} from './../signature.service'\nimport {SignatureTabActivatorService} from \"./../signature-tab-activator.service\";\nimport {RemoveCanvasService} from \"../remove-canvas.service\";\nimport {StampCanvasComponent} from \"../stamp-canvas/stamp-canvas.component\";\nimport {\n  AddDynamicComponentService, CommonModals, Formatting,\n  HostDynamicDirective, ModalService,\n  WindowService\n} from \"@groupdocs.examples.angular/common-components\";\nimport * as jquery from \"jquery\";\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-stamp-modal',\n  templateUrl: './stamp-modal.component.html',\n  styleUrls: ['./stamp-modal.component.less']\n})\nexport class StampModalComponent implements OnInit, OnDestroy {\n  stampCircles = new Map<number, ComponentRef<any>>();\n  textString = '';\n  showText = false;\n\n  @ViewChild(HostDynamicDirective, {static: true}) dynamicDirective: HostDynamicDirective;\n\n  private isMobile: boolean;\n  private sizeMagnifier = 40;\n  private activeId: number;\n  textProps = Formatting.default();\n\n  constructor(private _addDynamicComponentService: AddDynamicComponentService,\n              private _activeCanvasService: ActiveCanvasService,\n              private _windowService: WindowService,\n              private _removeCanvas: RemoveCanvasService,\n              private _signatureService: SignatureService,\n              private _tabActivationService: SignatureTabActivatorService,\n              private _modalService: ModalService) {\n\n    this._removeCanvas.removeCanvas.subscribe((id: number) => {\n      const componentRef = this.stampCircles.get(id);\n      componentRef.destroy();\n      this.stampCircles.delete(id);\n    });\n\n    this.isMobile = _windowService.isMobile();\n    _windowService.onResize.subscribe((w) => {\n      this.isMobile = _windowService.isMobile();\n    });\n\n    this._activeCanvasService.activeChange.subscribe((id: number) => {\n      this.activeId = id;\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  saveSign() {\n    const componentRef = this.stampCircles.get(this.stampCircles.size);\n    const canvasComponent = <StampCanvasComponent>componentRef.instance;\n    const lastProps = canvasComponent.props;\n    const ctx = canvasComponent.ctx;\n    const props = [];\n    props.push(lastProps);\n    for (let i = this.stampCircles.size - 1; i > 0; i--) {\n      const comp = <StampCanvasComponent>this.stampCircles.get(i).instance;\n      const canvas = comp.canvas.nativeElement;\n      let offset = lastProps.width - comp.props.width;\n      if (offset !== 0) {\n        offset = offset / 2;\n      }\n      ctx.drawImage(canvas, offset, offset);\n      props.push(comp.props);\n    }\n    props.reverse();\n    const img = canvasComponent.canvas.nativeElement.toDataURL(\"image/png\");\n    this._signatureService.saveStamp(img, props).subscribe(() => {\n      this._tabActivationService.changeActiveTab(SignatureType.STAMP.id);\n    });\n    this.close();\n  }\n\n  private close() {\n    this._modalService.close(CommonModals.DrawStampSignature);\n  }\n\n  onCloseOpen($event) {\n    if ($event) {\n      this.textString = '';\n      const props = new StampCanvasProps().init(this.isMobile);\n      props.id = this.stampCircles.size + 1;\n      this.addCircle(props, true);\n    } else {\n      this.clear();\n    }\n  }\n\n  clear() {\n    for (const comp of this.stampCircles.values()) {\n      comp.destroy();\n    }\n    this.stampCircles = new Map<number, ComponentRef<any>>();\n    this.showText = false;\n  }\n\n  private addCircle(props: StampCanvasProps, theFirst: boolean) {\n    if (this.dynamicDirective) {\n      const viewContainerRef = this.dynamicDirective.viewContainerRef;\n      const stampCircle = this._addDynamicComponentService.addDynamicComponent(viewContainerRef, StampCanvasComponent);\n      (<StampCanvasComponent>stampCircle.instance).id = props.id;\n      (<StampCanvasComponent>stampCircle.instance).theFirst = theFirst;\n      (<StampCanvasComponent>stampCircle.instance).active = true;\n      (<StampCanvasComponent>stampCircle.instance).props = props;\n      (<StampCanvasComponent>stampCircle.instance).width = this.getWidth();\n      (<StampCanvasComponent>stampCircle.instance).height = this.getHeight();\n      this.stampCircles.set(props.id, stampCircle);\n      this._activeCanvasService.changeActive(props.id);\n    }\n  }\n\n  addCanvas() {\n    const props = new StampCanvasProps();\n    props.init(this.isMobile);\n    props.id = this.stampCircles.size + 1;\n    const componentRef = this.stampCircles.get(this.stampCircles.size);\n    if (componentRef) {\n      const lastProps = (<StampCanvasComponent>componentRef.instance).props;\n      props.width = lastProps.width + this.sizeMagnifier;\n      props.height = lastProps.height + this.sizeMagnifier;\n      props.zIndex = lastProps.zIndex - 1;\n    }\n    this.addCircle(props, false);\n    this.showText = false;\n  }\n\n  ngOnDestroy(): void {\n    this.clear();\n  }\n\n  addText(value: string) {\n    this.textString = value;\n    const componentRef = this.stampCircles.get(1);\n    if (this.textString && componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.text = value;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n      this.showText = false;\n    }\n  }\n\n  toggleText() {\n    this.showText = !this.showText;\n    if (this.showText) {\n      this._activeCanvasService.changeActive(null);\n    }\n    if (this.showText) {\n      setTimeout(() => {\n        const element = $(\"#text-input\");\n        if (element) {\n          element.focus();\n        }\n      }, 100);\n    }\n  }\n\n  toggleUnderline($event: boolean) {\n    this.textProps.underline = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.underline = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  toggleBold($event: boolean) {\n    this.textProps.bold = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.bold = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  toggleItalic($event: boolean) {\n    this.textProps.italic = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.italic = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  selectTextColor($event: string) {\n    this.textProps.color = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.textColor = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  selectFont($event: string) {\n    this.textProps.font = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.font = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  selectFontSize($event: number) {\n    this.textProps.fontSize = $event;\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.fontSize = $event;\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n    }\n  }\n\n  getWidth() {\n    return this.isMobile ? this._windowService.getWidth() : 1036;\n  }\n\n  getHeight() {\n    return this.isMobile ? this._windowService.getHeight() : 501;\n  }\n\n  deleteText() {\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      props.text = \"\";\n      (<StampCanvasComponent>componentRef.instance).redrawCanvas();\n      this.showText = false;\n    }\n  }\n\n  leaveText($event: Event) {\n    this.showText = false;\n  }\n\n  getTextWidth() {\n    const componentRef = this.stampCircles.get(1);\n    if (componentRef) {\n      const props = (<StampCanvasComponent>componentRef.instance).props;\n      return props.radius * 2;\n    }\n    return 100;\n  }\n}\n","import {APP_INITIALIZER, ModuleWithProviders, NgModule} from '@angular/core';\nimport {CommonModule, DatePipe} from '@angular/common';\nimport {\n  Api,\n  CommonComponentsModule,\n  ConfigService,\n  ErrorInterceptorService,\n  LoadingMaskInterceptorService,\n  LoadingMaskService\n} from \"@groupdocs.examples.angular/common-components\";\nimport {HTTP_INTERCEPTORS, HttpClientModule} from \"@angular/common/http\";\nimport {SignatureService} from \"./signature.service\";\nimport {SignatureConfigService} from \"./signature-config.service\";\nimport {SignatureAppComponent} from \"./signature-app.component\";\nimport {SignatureListPanelComponent} from './signature-list-panel/signature-list-panel.component';\nimport {FontAwesomeModule} from '@fortawesome/angular-fontawesome';\nimport {library} from '@fortawesome/fontawesome-svg-core';\nimport {fas} from '@fortawesome/free-solid-svg-icons';\nimport {far} from '@fortawesome/free-regular-svg-icons';\nimport {SignatureTabComponent} from './signature-tab/signature-tab.component';\nimport {NewBarQrCodeComponent} from './new-bar-qr-code/new-bar-qr-code.component';\nimport {UploadSignatureComponent} from './upload-signature/upload-signature.component';\nimport {DndSignatureDirective} from './dnd-signature.directive';\nimport {Signature} from './signature/signature.component';\nimport {ContextMenuComponent} from './context-menu/context-menu.component';\nimport {SelectSignatureService} from \"./select-signature.service\";\nimport {DragSignatureService} from \"./drag-signature.service\";\nimport {RemoveSignatureService} from \"./remove-signature.service\";\nimport {ActiveSignatureService} from \"./active-signature.service\";\nimport {CanvasComponent} from './canvas/canvas.component';\nimport {StampCanvasComponent} from './stamp-canvas/stamp-canvas.component';\nimport {ActiveCanvasService} from \"./active-canvas.service\";\nimport {RemoveCanvasService} from \"./remove-canvas.service\";\nimport {TextMenuComponent} from './text-menu/text-menu.component';\nimport {SignaturesHolderService} from \"./signatures-holder.service\";\nimport {SignatureTabActivatorService} from \"./signature-tab-activator.service\";\nimport {SignatureLeftPanelComponent} from './signature-left-panel/signature-left-panel.component';\nimport {HandModalComponent} from './hand-modal/hand-modal.component';\nimport {StampModalComponent} from './stamp-modal/stamp-modal.component';\nimport {CopySignatureService} from \"./copy-signature.service\";\nimport {ClickOutsideModule} from 'ng-click-outside';\n\nexport function initializeApp(signatureConfigService: SignatureConfigService) {\n  const result = () => signatureConfigService.load();\n  return result;\n}\n\n// NOTE: this is required during library compilation see https://github.com/angular/angular/issues/23629#issuecomment-440942981\n// @dynamic\nexport function setupLoadingInterceptor(service: LoadingMaskService) {\n  return new LoadingMaskInterceptorService(service);\n}\n\n@NgModule({\n  declarations: [SignatureAppComponent,\n    SignatureListPanelComponent,\n    SignatureTabComponent,\n    NewBarQrCodeComponent,\n    UploadSignatureComponent,\n    DndSignatureDirective,\n    Signature,\n    ContextMenuComponent,\n    CanvasComponent,\n    StampCanvasComponent,\n    TextMenuComponent,\n    SignatureLeftPanelComponent,\n    HandModalComponent,\n    StampModalComponent],\n  exports: [SignatureAppComponent,\n    SignatureListPanelComponent,\n    SignatureTabComponent,\n    NewBarQrCodeComponent,\n    UploadSignatureComponent,\n    DndSignatureDirective,\n    Signature,\n    ContextMenuComponent,\n    CanvasComponent,\n    StampCanvasComponent,\n    TextMenuComponent,\n    SignatureLeftPanelComponent,\n    HandModalComponent,\n    StampModalComponent],\n  imports: [CommonModule,\n    CommonComponentsModule,\n    HttpClientModule,\n    FontAwesomeModule,\n    ClickOutsideModule],\n  providers: [\n    SignatureService,\n    ConfigService,\n    SignatureConfigService,\n    SelectSignatureService,\n    DragSignatureService,\n    RemoveSignatureService,\n    ActiveSignatureService,\n    ActiveCanvasService,\n    RemoveCanvasService,\n    DatePipe,\n    SignaturesHolderService,\n    SignatureTabActivatorService,\n    CopySignatureService,\n    {\n      provide: HTTP_INTERCEPTORS,\n      useClass: ErrorInterceptorService,\n      multi: true\n    },\n    {\n      provide: APP_INITIALIZER,\n      useFactory: initializeApp,\n      deps: [SignatureConfigService], multi: true\n    },\n    LoadingMaskService,\n    {\n      provide: HTTP_INTERCEPTORS,\n      useFactory: setupLoadingInterceptor,\n      multi: true,\n      deps: [LoadingMaskService]\n    }\n  ],\n  entryComponents: [\n    Signature,\n    StampCanvasComponent\n  ]\n})\nexport class SignatureModule {\n  constructor() {\n    library.add(fas, far);\n  }\n\n  static forRoot(apiEndpoint: string): ModuleWithProviders {\n    Api.DEFAULT_API_ENDPOINT = apiEndpoint;\n    return {\n      ngModule: SignatureModule\n    };\n  }\n}\n"]}