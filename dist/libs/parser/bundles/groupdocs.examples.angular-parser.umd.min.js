!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@groupdocs.examples.angular/common-components"),require("@fortawesome/angular-fontawesome"),require("@fortawesome/fontawesome-svg-core"),require("@fortawesome/free-solid-svg-icons"),require("@fortawesome/free-regular-svg-icons"),require("@angular/platform-browser"),require("ng-click-outside"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators"),require("jquery")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/parser",["exports","@angular/core","@groupdocs.examples.angular/common-components","@fortawesome/angular-fontawesome","@fortawesome/fontawesome-svg-core","@fortawesome/free-solid-svg-icons","@fortawesome/free-regular-svg-icons","@angular/platform-browser","ng-click-outside","rxjs","@angular/common/http","rxjs/operators","jquery"],t):t(((e=e||self).groupdocs=e.groupdocs||{},e.groupdocs.examples=e.groupdocs.examples||{},e.groupdocs.examples.angular=e.groupdocs.examples.angular||{},e.groupdocs.examples.angular.parser={}),e.ng.core,e.commonComponents,e.angularFontawesome,e.fontawesomeSvgCore,e.freeSolidSvgIcons,e.freeRegularSvgIcons,e.ng.platformBrowser,e.ngClickOutside,e.rxjs,e.ng.common.http,e.rxjs.operators,e.jquery)}(this,(function(e,t,i,n,o,r,a,s,l,c,p,d,u){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};var f=function(e){this.rows=[];for(var t=0;t<e.length;t++){var i=[];if(e[t])for(var n=0;n<e[t].length;n++)i.push(e[t][n]);this.rows.push(i)}};var h=function(){function e(){this._state=0,this.enabled=!0}return Object.defineProperty(e.prototype,"isReadyToRun",{get:function(){return 0===this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFailed",{get:function(){return-1===this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCompleted",{get:function(){return 1===this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isProcessing",{get:function(){return null==this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prompt",{get:function(){return this._prompt},set:function(e){this._prompt=e,this._error=null,this._result=null,this._state=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},set:function(e){this._prompt=null,this._error=e,this._result=null,this._state=-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"result",{get:function(){return this._result},set:function(e){this._prompt=null,this._error=null,this._result=e,this._state=1},enumerable:!0,configurable:!0}),e.prototype.execute=function(){this._state=null},e}();var g=function(e,t){this.guid=e,this.password=t};!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(function(e,t){function i(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(t,e)}(g);var b=function(e,t){this.x=e,this.y=t};var v=function(e,t){this.width=e,this.height=t};var y=function(){function e(){this._id=null,this._name="template name",this._fields=[],this._addFieldSubject=new c.Subject,this._removeFieldSubject=new c.Subject,this._modifiedSubject=new c.Subject,this._fieldChangedSubscriptions=new Map,this.addedField=this._addFieldSubject.asObservable(),this.removedField=this._removeFieldSubject.asObservable(),this.modified=this._modifiedSubject.asObservable(),this._id=e.NotSaved}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e,this.notifyModified()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isStored",{get:function(){return this._id!==e.NotSaved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._fields.length},enumerable:!0,configurable:!0}),e.prototype.addField=function(e){var t=this;this._fieldChangedSubscriptions.set(e,e.changed.subscribe((function(e){return t.notifyModified()}))),this._fields.push(e),this._addFieldSubject.next(e),this.notifyModified()},e.prototype.removeField=function(e){var t=this._fields.indexOf(e);t>-1&&(this._fieldChangedSubscriptions.get(e).unsubscribe(),this._fieldChangedSubscriptions.delete(e),this._fields.splice(t,1)),this._removeFieldSubject.next(e),this.notifyModified()},e.prototype.removeFieldByName=function(e){var t=this.getFieldByName(e);t&&this.removeField(t)},e.prototype.getFieldByName=function(e){if(!e)return null;for(var t=e.toLocaleLowerCase(),i=0;i<this._fields.length;i++)if(this._fields[i].name.toLocaleLowerCase()===t)return this._fields[i];return null},e.prototype.createField=function(e){var t=new w(this);return t.name=this.getNextFieldName(e),t.size=new v(60,20),t.pageNumber=1,t.position=new b(10,10),t},e.prototype.getNextFieldName=function(e){for(var t=0;t<1e3;t++){var i=e+t.toString();if(!this.getFieldByName(i))return i}return null},e.prototype.notifyModified=function(){this._modifiedSubject.next(this)},e.NotSaved="NotSaved",e}();var x=function(){function e(){}return e.FIXED="FIXED",e.TABLE="TABLE",e}();var w=function(){function e(e){this._template=e,this._fieldType=x.FIXED,this._changedSubject=new c.Subject,this.changed=this._changedSubject.asObservable(),this._columns=[]}return Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e,t){var i=new _(null==e?this.getNextColumnName():e,t,this._changedSubject);this._columns.push(i),this._changedSubject.next("columns")},e.prototype.removeColumn=function(e){var t=this._columns.indexOf(e);t>-1&&(this._columns.splice(t,1),this._changedSubject.next("columns"))},e.prototype.getColumnByName=function(e){if(!e)return null;for(var t=e.toLocaleLowerCase(),i=0;i<this._columns.length;i++)if(this._columns[i].name.toLocaleLowerCase()===t)return this._columns[i];return null},Object.defineProperty(e.prototype,"fieldType",{get:function(){return this._fieldType},set:function(e){this._fieldType=e,this._changedSubject.next("fieldType")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e,this._changedSubject.next("name")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this._pageNumber},set:function(e){this._pageNumber=e,this._changedSubject.next("pageNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e,this._changedSubject.next("position")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(e){this._size=e,this._changedSubject.next("size")},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{fieldType:this.fieldType,name:this.name,pageNumber:this.pageNumber,x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height,columns:this._columns}},e.prototype.getNextColumnName=function(){for(var e=0;e<1e3;e++){var t="TC:"+e.toString();if(!this.getColumnByName(t))return t}return null},e}();var _=function(){function e(e,t,i){this._name=e,this._value=t,this._changedSubject=i}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._changedSubject.next("table-separator")},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{name:this.name,value:this.value}},e}();var S=function(){function e(e,t){this._http=e,this._config=t}return e.prototype.loadFiles=function(e){return this._http.post(this._config.getParserApiEndpoint()+i.Api.LOAD_FILE_TREE,{path:e},i.Api.httpOptionsJson)},e.prototype.upload=function(e,t,n){var o=new FormData;return o.append("file",e),o.append("rewrite",String(n)),t&&o.append("url",t),this._http.post(this._config.getParserApiEndpoint()+i.Api.UPLOAD_DOCUMENTS,o)},e.prototype.loadDocumentDescription=function(e){var t=this,n=new c.Subject,o={next:function(e){return n.next(e)},complete:function(){return n.complete()},error:function(e){t.logToServer(e),console.error(e),n.error(e)}};return this._http.post(this._config.getParserApiEndpoint()+i.Api.LOAD_DOCUMENT_DESCRIPTION,e,i.Api.httpOptionsJson).pipe(d.timeout(25e3)).subscribe(o),n},e.prototype.parseByTemplate=function(e,t,n){var o=this,r=new c.Subject,a={next:function(e){return r.next(e)},complete:function(){return r.complete()},error:function(e){o.logToServer(e),console.error(e),r.error(e)}};return this._http.post(this._config.getParserApiEndpoint()+i.Api.PARSE,{guid:e.guid,password:e.password,fields:n.fields},i.Api.httpOptionsJson).pipe(d.timeout(25e3)).subscribe(a),r},e.prototype.getErrorMessage=function(e){return 404===e.status?"The requested file was not found.":e.error&&"string"==typeof e.error.title?e.error.title:"string"==typeof e.error?e.error:"string"==typeof e.title?e.title:"The error occured while opening the file."},e.prototype.logToServer=function(e){var t={error:JSON.stringify(e)},n=localStorage.getItem("parser.logclienterror");n&&this._http.post(n,t,i.Api.httpOptionsJson).subscribe({next:function(){return console.log("Sent to server")},error:function(){return console.log("Can't send to server")}})},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:p.HttpClient},{type:i.ConfigService}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(p.HttpClient),t.ɵɵinject(i.ConfigService))},token:e,providedIn:"root"}),e}();var k=function(){function e(){this._templatePattern="parser.template.",this._currentTemplateChangedSubject=new c.Subject,this._templateAddedSubject=new c.Subject,this._templateRemovedSubject=new c.Subject,this.currentTemplateChanged=this._currentTemplateChangedSubject.asObservable(),this.templateAddedSubject=this._templateAddedSubject.asObservable(),this.templateRemovedSubject=this._templateRemovedSubject.asObservable(),this._templates=[],this.loadTemplatesFromLocalStorage(),this.createTemplate()}return Object.defineProperty(e.prototype,"currentTemplate",{get:function(){return this._currentTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"templateIds",{get:function(){return this._templates},enumerable:!0,configurable:!0}),e.prototype.selectTemplate=function(e){var t=this.getTemplateById(e);t&&this.setCurrentTemplate(t)},e.prototype.createTemplate=function(){var e=new y;e.name=this.getNextTemplateName("Template"),this.setCurrentTemplate(e)},e.prototype.renameTemplate=function(e){if(e){var t=this.getTemplateByName(e.name);if(t&&t.id!==e.id)throw Error("Template with the same name already exists");if(e.id===this.currentTemplate.id)this.currentTemplate.name=e.name;else{var i=this.getTemplateById(e);i.name=e.name,this.saveTemplate(i)}}},e.prototype.removeTemplate=function(e){var t=this.getTemplateById(e),i=this._templates.indexOf(t);i>-1&&this._templates.splice(i,1),this.onTemplateRemoved(t),t===this._currentTemplate&&(0===this._templates.length?this.createTemplate():(i>0&&(i-=1),this.setCurrentTemplate(this._templates[i])))},e.prototype.serialize=function(e){if(e){var t=this.getTemplateById(e);if(t)return JSON.stringify({name:t.name,fields:t.fields})}},e.prototype.deserialize=function(e){if(e)try{var t=this.loadTemplateFromJson(e);t.id=y.NotSaved,this.saveTemplate(t),this.selectTemplate(t)}catch(e){throw Error("Error while parsing template file")}},e.prototype.setCurrentTemplate=function(e){var t=this;this._currentTemplateModifiedSubscription&&this._currentTemplateModifiedSubscription.unsubscribe(),this._currentTemplate=e,this._currentTemplateModifiedSubscription=this._currentTemplate.modified.pipe(d.throttle((function(e){return c.interval(500)}))).subscribe((function(e){return t.saveTemplate(e)})),this._currentTemplateChangedSubject.next(this._currentTemplate)},e.prototype.onTemplateAdded=function(e){this._templateAddedSubject.next(e)},e.prototype.onTemplateRemoved=function(e){this._templateRemovedSubject.next(e);for(var t=0;t<localStorage.length;t++){var i=localStorage.key(t);if(i===this._templatePattern+e.id)return void localStorage.removeItem(i)}},e.prototype.loadTemplatesFromLocalStorage=function(){for(var e=0;e<localStorage.length;e++){var t=localStorage.key(e);if(t.startsWith(this._templatePattern)){var i=this.loadTemplateFromJson(localStorage.getItem(t));this._templates.push(i),this.onTemplateAdded(i)}}},e.prototype.loadTemplateFromJson=function(e){var t=JSON.parse(e),i=this.getNextTemplateName(t.name),n=new y;n.id=t.id?t.id:this.getNextTemplateId(),n.name=i;for(var o=0;o<t.fields.length;o++){var r=t.fields[o],a=new w(n);if(r.fieldType&&(a.fieldType=r.fieldType),a.name=r.name,a.pageNumber=r.pageNumber,a.position=new b(r.x,r.y),a.size=new v(r.width,r.height),r.columns)for(var s=0;s<r.columns.length;s++)a.addColumn(r.columns[s].name,r.columns[s].value);n.addField(a)}return n},e.prototype.saveTemplateToLocalStorage=function(e){if(e){var t=this._templatePattern+e.id;localStorage.setItem(t,JSON.stringify({name:e.name,id:e.id,fields:e.fields}))}},e.prototype.saveTemplate=function(e){e&&(e.isStored||(e.id=this.getNextTemplateId(),this._templates.push(e),this.onTemplateAdded(e)),this.saveTemplateToLocalStorage(e))},e.prototype.getTemplateById=function(e){if(!e)return null;for(var t=0;t<this._templates.length;t++)if(this._templates[t].id===e.id)return this._templates[t];return null},e.prototype.getTemplateByName=function(e){if(!e)return null;for(var t=e.toLocaleLowerCase(),i=0;i<this._templates.length;i++)if(this._templates[i].name.toLocaleLowerCase()===t)return this._templates[i];return null},e.prototype.getNextTemplateId=function(){for(var e={id:"",name:""},t=0;t<1e3;t++)if(e.id=t.toString(),!this.getTemplateById(e))return e.id;return null},e.prototype.getNextTemplateName=function(e){for(var t=0;t<1e3;t++){var i=e+(0===t?"":" "+t.toString());if(!this.getTemplateByName(i))return i}return null},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var T=function(){function e(){this._sourceFileChangedSubject=new c.Subject,this.sourceFileChanged=this._sourceFileChangedSubject.asObservable()}return Object.defineProperty(e.prototype,"sourceFile",{get:function(){return this._sourceFile},set:function(e){this._sourceFile=e,this._sourceFileChangedSubject.next(e)},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var C=function(){function e(){this._descriptionSubject=new c.Subject,this._stateSubject=new c.Subject,this.descriptionChanged=this._descriptionSubject.asObservable(),this.stateChanged=this._stateSubject.asObservable()}return e.prototype.startOperation=function(e){var t=new c.Subject;return this._descriptionSubject.next(e),this._stateSubject.next(t),t},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var j=function(){function e(){this._activePageChangedSubject=new c.Subject,this._activePage=null,this.activePageChanged=this._activePageChangedSubject.asObservable()}return Object.defineProperty(e.prototype,"activePage",{get:function(){return this._activePage},enumerable:!0,configurable:!0}),e.prototype.setActivePage=function(e){this._activePage=e,this._activePageChangedSubject.next(e)},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();var I=function(){function e(e,t,n,o,r,a,s,l,c,p,d){var u=this;this._modalService=e,this._zoomService=r,this._navigateService=a,this._uploadFilesService=c,this._passwordService=p,this.CREATE_FIELD_MODE="createFieldMode",this.browseFilesModal=i.CommonModals.BrowseFiles,this.documentError=null,this.isApiAvaible=!0,this.fileWasDropped=!1,this.files=[],this.parserService=t,this.sourceFileService=n,this.templateService=o,this.placeholderService=s,this.documentPageService=l,d.onResize.subscribe((function(e){u.refreshZoom()})),this.sourceFileService.sourceFileChanged.subscribe((function(e){return u.loadDocumentDescription(e)})),this._uploadFilesService.uploadsChange.subscribe((function(e){e&&e.length>0&&u.parserService.upload(e.item(0),"",u.rewriteConfig).subscribe((function(e){u.fileWasDropped?u.selectFile(e.guid,"",""):u.selectDir("")}))})),this._passwordService.passChange.subscribe((function(e){u.selectFile(u.sourceFileService.sourceFile.guid,e,i.CommonModals.PasswordRequired)}))}return e.prototype.zoomIn=function(){var e=this._zoomService.zoom;e<490&&this._zoomService.changeZoom(e+10)},e.prototype.zoomOut=function(){var e=this._zoomService.zoom;e>30&&this._zoomService.changeZoom(e-10)},e.prototype.addFieldClick=function(){var e=this.templateService.currentTemplate;if(e){var t=e.createField("Field");t.fieldType=x.FIXED,t.pageNumber=this.documentPageService.activePage,e.addField(t)}},e.prototype.addTableClick=function(){var e=this.templateService.currentTemplate;if(e){var t=e.createField("Table");t.fieldType=x.TABLE,t.pageNumber=this.documentPageService.activePage,e.addField(t)}},e.prototype.isFileLoaded=function(){return!this.documentError&&this.document},e.prototype.openModal=function(e,t){t&&!this.isFileLoaded()||this._modalService.open(e)},e.prototype.selectDir=function(e){var t=this;this.parserService.loadFiles(e).subscribe((function(e){return t.files=e||[]}))},e.prototype.upload=function(e){var t=this;this.parserService.upload(null,e,this.rewriteConfig).subscribe((function(){t.selectDir("")}))},e.prototype.fileDropped=function(e){this.fileWasDropped=e},e.prototype.selectFile=function(e,t,n){this.credentials=new i.FileCredentials(e,t),this.sourceFileService.sourceFile=new g(e,t),n&&this._modalService.close(n)},Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.parserConfig||this.parserConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.parserConfig||this.parserConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.parserConfig||this.parserConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"returnUrl",{get:function(){return localStorage.getItem("returnUrl")},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.reloadCurrentPage=function(){window.location.reload()},e.prototype.loadDocumentDescription=function(e){var t=this;this.isApiAvaible=!0,this.documentError=null,this._document=null;var i=this.placeholderService.startOperation("Loading document..."),n={next:function(e){t.documentPageService.setActivePage(1),t._document=e,i.complete(),t.templateService.createTemplate(),t.refreshZoom(),t._navigateService.countPages=t.document.pages?t.document.pages.length:0,t._navigateService.currentPage=1},error:function(e){t.documentError=t.parserService.getErrorMessage(e),i.error(e)},complete:function(){return i.complete()}};this.parserService.loadDocumentDescription(e).subscribe(n)},Object.defineProperty(e.prototype,"document",{get:function(){return this._document},enumerable:!0,configurable:!0}),e.prototype.refreshZoom=function(){this._zoomService.changeZoom(this.getFitToWidth())},e.prototype.getFitToWidth=function(){if(!this.document)return 100;var e=window.innerWidth,t=this.ptToPx(this.document.pages[0].width),i=t||e;return this.ptToPx(this.document.pages[0].height)>t&&Math.round(i/e)<2?200-Math.round(100*i/e):Math.round(100*e/i)},e.prototype.ptToPx=function(e){return 96*e/72},e.decorators=[{type:t.Component,args:[{selector:"gd-app-parser",template:'<gd-loading-mask></gd-loading-mask>\n<div class="wrapper">\n  <div class="row">\n    <div class="column" [ngClass]="{\'document-loaded\': isFileLoaded()}">\n      <div class="top-panel">\n        <a class="logo-link" [href]="returnUrl">\n          <gd-logo [logo]="\'parser\'" icon="glasses"></gd-logo>\n        </a>\n        <gd-top-toolbar class="toolbar-panel">\n          <gd-button [icon]="\'folder-open\'" [tooltip]="\'Browse files\'" (click)="openModal(browseFilesModal, false)"\n            *ngIf="browseConfig"></gd-button>\n\n          <gd-button *ngIf="!documentError && document" [icon]="\'search-plus\'" [tooltip]="\'Zoom In\'" (click)="zoomIn()"></gd-button>\n          <gd-button *ngIf="!documentError && document" [icon]="\'search-minus\'" [tooltip]="\'Zoom Out\'" (click)="zoomOut()"></gd-button>\n          <gd-button *ngIf="!documentError && document" [icon]="\'expand\'" [tooltip]="\'Add text field\'" (click)="addFieldClick()"></gd-button>\n          <gd-button *ngIf="!documentError && document" [icon]="\'table\'" [tooltip]="\'Add table\'" (click)="addTableClick()"></gd-button>\n        </gd-top-toolbar>\n      </div>\n       <gd-init-state [icon]="\'glasses\'" [text]="\'Drop file here to upload\'" *ngIf="documentError || !document" (fileDropped)="fileDropped($event)">\n        Click <fa-icon [icon]="[\'fas\',\'folder-open\']"></fa-icon> to open file<br>\n        Or drop file here\n      </gd-init-state>\n\n      <div class="parser-wrapper" *ngIf="!documentError && document">\n        <gd-surface [document]="document"></gd-surface>\n      </div>\n    </div>\n\n    <gd-parser-side-panel [fileNameForCsv]="" *ngIf="!documentError && document"></gd-parser-side-panel>\n  </div>\n\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\n    (selectedFileGuid)="selectFile($event, null, browseFilesModal)" [uploadConfig]="uploadConfig">\n  </gd-browse-files-modal>\n\n  <gd-error-modal></gd-error-modal>\n  <gd-password-required></gd-password-required>\n  <gd-success-modal></gd-success-modal>\n</div>',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.wrapper{-webkit-box-align:stretch;align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.logo-link{color:inherit;text-decoration:inherit}.doc-panel{display:-webkit-box;display:flex;height:calc(100vh - 60px);-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.top-panel{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%}.toolbar-panel{background-color:#3e4e5a;width:100%}.parser-wrapper{z-index:100;left:0;top:0;right:0;bottom:0}gd-parser-side-panel{position:absolute;right:0;top:60px;width:300px;height:calc(100vh - 60px);background-color:#fff}::ng-deep .tools .button{color:#fff!important;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column}::ng-deep .tools .button.inactive{color:#959da5!important}::ng-deep .tools .icon-button{margin:0 0 0 7px!important}.row{display:-webkit-box;display:flex}.column{width:100%;height:100vh;background-color:#e7e7e7;overflow:hidden}::ng-deep .gd-side-panel-body{background-color:#f4f4f4}::ng-deep .gd-side-panel-wrapper{width:464px!important}::ng-deep .page.excel{overflow:unset!important}@media (max-width:1037px){::ng-deep .tools gd-button:nth-child(1)>.icon-button{margin:0 0 0 10px!important}::ng-deep .tools .icon-button{height:60px;width:60px}::ng-deep .gd-side-panel-wrapper{width:375px!important}}"]}]}],e.ctorParameters=function(){return[{type:i.ModalService},{type:S},{type:T},{type:k},{type:i.ZoomService},{type:i.NavigateService},{type:C},{type:j},{type:i.UploadFilesService},{type:i.PasswordService},{type:i.WindowService}]},e.propDecorators={sourceFile:[{type:t.Input}]},e}();var P=function(){function e(e){this.rendererFactory2=e,this._destroy=new c.Subject,this._isMoving=!1,this._mouseMoveSubject=new c.Subject,this._mouseUpSubject=new c.Subject,this._activeChangedSubject=new c.Subject,this.mouseMove=this._mouseMoveSubject.asObservable(),this.mouseUp=this._mouseUpSubject.asObservable(),this.activeChanged=this._activeChangedSubject.asObservable();var t=this.rendererFactory2.createRenderer(null,null);this.createMouseObservables(t)}return e.prototype.createMouseObservables=function(e){var t,i,n=this;c.fromEventPattern((function(i){t=e.listen("document","mousemove",i)}),(function(){return t()})).pipe(d.takeUntil(this._destroy)).subscribe((function(e){return n.onMouseMove(e)}));var o;c.fromEventPattern((function(t){i=e.listen("document","mouseup",t)}),(function(){return i()})).pipe(d.takeUntil(this._destroy)).subscribe((function(e){return n.onMouseUp(e)}));var r;c.fromEventPattern((function(t){o=e.listen("document","panmove",t)}),(function(){return o()})).pipe(d.takeUntil(this._destroy)).subscribe((function(e){return n.onMouseMove(e)}));c.fromEventPattern((function(t){r=e.listen("document","panend",t)}),(function(){return r()})).pipe(d.takeUntil(this._destroy)).subscribe((function(e){return n.onMouseUp(e)}))},e.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},Object.defineProperty(e.prototype,"isMoving",{get:function(){return this._isMoving},enumerable:!0,configurable:!0}),e.prototype.setActive=function(e){this._activeChangedSubject.next(e)},e.prototype.beginMove=function(e){var t=i.Utils.getMousePosition(e);return this._isMoving=!0,t},e.prototype.onMouseMove=function(e){if(this.isMoving){var t=i.Utils.getMousePosition(e);this._mouseMoveSubject.next(t)}},e.prototype.onMouseUp=function(e){if(this.isMoving){var t=i.Utils.getMousePosition(e);this._mouseUpSubject.next(t),this._isMoving=!1}},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:t.RendererFactory2}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(t.RendererFactory2))},token:e,providedIn:"root"}),e}();var F=function(e,t){this.fieldName=e,this.action=t};var M=function(){function e(e,i){var n=this;this._fieldService=e,this._zoomService=i,this._destroy=new c.Subject,this.contextMenuClick=new t.EventEmitter,e.activeChanged.pipe(d.takeUntil(this._destroy)).subscribe((function(e){n.isActive=n._field&&n._field.name===e}))}return e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},Object.defineProperty(e.prototype,"isFixed",{get:function(){return this.field.fieldType===x.FIXED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTable",{get:function(){return this.field.fieldType===x.TABLE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._left},set:function(e){this.pageSize&&(this._left=Math.min(this.pageSize.width,Math.max(0,e)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},set:function(e){this.pageSize&&(this._top=Math.min(this.pageSize.height,Math.max(0,e)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._right},set:function(e){this.pageSize&&(this._right=Math.min(Math.max(0,e),this.pageSize.width))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._bottom},set:function(e){this.pageSize&&(this._bottom=Math.min(Math.max(0,e),this.pageSize.height))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var e=this.right-this.left;return e||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var e=this.bottom-this.top;return e||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._zoomService.zoom/100},enumerable:!0,configurable:!0}),e.prototype.renameFieldClick=function(){this.contextMenuClick.emit(new F(this.field.name,"rename"))},e.prototype.deleteFieldClick=function(){this.contextMenuClick.emit(new F(this.field.name,"remove"))},e.prototype.addColumnLeft=function(){this.field.addColumn(null,.1*this.width)},e.prototype.addColumnRight=function(){this.field.addColumn(null,.9*this.width)},e.prototype.removeColumn=function(e){this.field.removeColumn(e)},Object.defineProperty(e.prototype,"field",{get:function(){return this._field},set:function(e){this._field=e,this.left=this.field.position.x,this.top=this.field.position.y,this.right=this.field.position.x+this.field.size.width,this.bottom=this.field.position.y+this.field.size.height},enumerable:!0,configurable:!0}),e.prototype.mouseDown=function(e,t){var i=this;e.preventDefault(),this._fieldService.setActive(this.field.name);var n=this._fieldService.beginMove(e),o=this.left,r=this.top,a=this.right,s=this.bottom,l=this.field.getColumnByName(t),c=l?l.value:null,p=this._fieldService.mouseUp.subscribe((function(e){i._field.position=new b(i.left,i.top),i._field.size=new v(i.width,i.height),p.unsubscribe()}));this._fieldService.mouseMove.pipe(d.takeUntil(this._fieldService.mouseUp)).subscribe((function(e){if(e&&i.pageSize){var p=i.width,d=i.height,u=new b((e.x-n.x)/i.scale,(e.y-n.y)/i.scale);if(c){var m=c+u.x;l.value=Math.max(0,Math.min(i.width,m))}else switch(t){case"Move":i.left=Math.min(o+u.x,i.pageSize.width-i.width),i.top=Math.min(r+u.y,i.pageSize.height-i.height),i.right=i.left+p,i.bottom=i.top+d;break;case"W":i.left=o+u.x,i.width<40&&(i.left=i.right-40);break;case"E":i.right=a+u.x,i.width<40&&(i.right=i.left+40);break;case"N":i.top=r+u.y,i.height<40&&(i.top=i.bottom-15);break;case"S":i.bottom=s+u.y,i.height<15&&(i.bottom=i.top+15);break;case"NW":i.left=o+u.x,i.top=r+u.y,i.width<40&&(i.left=i.right-40),i.height<40&&(i.top=i.bottom-15);break;case"SW":i.left=o+u.x,i.bottom=s+u.y,i.width<40&&(i.left=i.right-40),i.height<15&&(i.bottom=i.top+15);break;case"NE":i.right=a+u.x,i.top=r+u.y,i.width<40&&(i.right=i.left+40),i.height<15&&(i.top=i.bottom-15);break;case"SE":i.right=a+u.x,i.bottom=s+u.y,i.width<40&&(i.right=i.left+40),i.height<15&&(i.bottom=i.top+15)}}}))},e.prototype.rightClick=function(e){e.preventDefault()},e.decorators=[{type:t.Component,args:[{selector:"gd-field",template:'<div class="field" (clickOutside)="isActive = false" (contextmenu)="rightClick($event)"\n    [clickOutsideEvents]="\'mousedown\'" [clickOutsideEnabled]="isActive" [style.left.px]="left" [style.top.px]="top"\n    [style.width.px]="width" [style.height.px]="height">\n\n    <div class="field-text" (dblclick)="renameFieldClick()" (mousedown)="mouseDown($event, \'Move\')"\n        (panstart)="mouseDown($event, \'Move\')">\n        <div *ngIf="!isActive">{{ field.name }}</div>\n    </div>\n    <div class="resizable-handle ne-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'NE\')"\n        (panstart)="mouseDown($event, \'NE\')"></div>\n    <div class="resizable-handle se-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'SE\')"\n        (panstart)="mouseDown($event, \'SE\')"></div>\n    <div class="resizable-handle sw-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'SW\')"\n        (panstart)="mouseDown($event, \'SW\')"></div>\n    <div class="resizable-handle nw-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'NW\')"\n        (panstart)="mouseDown($event, \'NW\')"></div>\n\n    <div class="resizable-v-edge w-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'W\')"\n        (panstart)="mouseDown($event, \'W\')"></div>\n    <div class="resizable-v-edge e-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'E\')"\n        (panstart)="mouseDown($event, \'E\')"></div>\n    <div class="resizable-h-edge n-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'N\')"\n        (panstart)="mouseDown($event, \'N\')"></div>        \n    <div class="resizable-h-edge s-resize" *ngIf="isActive" (mousedown)="mouseDown($event, \'S\')"\n        (panstart)="mouseDown($event, \'S\')"></div>\n\n    <div *ngIf="isTable && isActive">\n        <div *ngFor="let column of field.columns" class="tc-top resizable-handle" [style.left.px]="column.value"></div>\n        <div *ngFor="let column of field.columns" class="tc-bottom resizable-handle" [style.left.px]="column.value"></div>\n        <div *ngFor="let column of field.columns" class="tc" [style.left.px]="column.value"\n            (mousedown)="mouseDown($event, column.name)">\n            <div class="tc-background"></div>\n            <div class="tc-remove image-btn" title="Remove column separator" (click)="removeColumn(column)">\n                <fa-icon [icon]="\'trash\'"></fa-icon>\n            </div>\n        </div>\n    </div>\n\n    <div *ngIf="isTable && !isActive">\n        <div *ngFor="let column of field.columns" class="tc-deactived" [style.left.px]="column.value">\n        </div>\n    </div>\n\n    <div class="tc-add-left image-btn" *ngIf="isTable && isActive" title="Add new column separator" (click)="addColumnLeft()">\n        <fa-icon [icon]="\'plus\'"></fa-icon>\n    </div>\n\n    <div class="tc-add-right image-btn" *ngIf="isTable && isActive" title="Add new column separator" (click)="addColumnRight()">\n        <fa-icon [icon]="\'plus\'"></fa-icon>\n    </div>\n\n    <div class="context-menu" *ngIf="isActive">\n        <div class="image-btn" (click)="renameFieldClick()" title="Rename the field">\n            <fa-icon [icon]="\'edit\'"></fa-icon>\n        </div>\n        <div class="image-btn" (click)="deleteFieldClick()" title="Remove the field">\n            <fa-icon [icon]="\'trash\'"></fa-icon>\n        </div>\n    </div>\n\n    <div class="field-name" *ngIf="isActive">\n        {{ field.name }}\n    </div>\n\n</div>',styles:[".btn{padding:5px 20px;background-color:#25c2d4;cursor:pointer;color:#fff!important}.btn:hover{background-color:#688296;color:#ccd0d4!important}.image-btn{text-align:center;cursor:pointer;margin:1px;color:#c4c4c4}.image-btn:hover{color:#688296!important}.image-btn>fa-icon{padding:5px;font-size:16px}.list-item:nth-of-type(even){background-color:#f4f4f4}.list-item:hover{background-color:#e5e5e5}.tc{position:absolute;display:block;border-left:4px solid #679ffa;width:4px;top:-5px;bottom:-5px;cursor:col-resize;z-index:1000}.tc-deactived{position:absolute;display:block;border-left:4px solid #738a9cc9;width:4px;top:0;bottom:0;cursor:col-resize;z-index:1000}.tc-background{-webkit-transform:translatex(-9px);transform:translatex(-9px);background-color:#fffFFF01;width:15px;height:100%}.tc-top{top:-5px;-webkit-transform:translatex(-3px);transform:translatex(-3px);cursor:col-resize}.tc-bottom{bottom:-5px;-webkit-transform:translatex(-3px);transform:translatex(-3px);cursor:col-resize}.tc-remove{background:#fff;display:none;position:absolute;top:15px}.tc:hover>.tc-remove{display:block}.tc-add-left{position:absolute;left:-5px;top:50%;-webkit-transform:translate(-100%,-50%);transform:translate(-100%,-50%)}.tc-add-right{position:absolute;right:-5px;top:50%;-webkit-transform:translate(100%,-50%);transform:translate(100%,-50%)}.resizable-v-edge{background-color:#fffFFF01;position:absolute;font-size:.1px;display:block;width:10px;top:5px;bottom:5px}.resizable-h-edge{background-color:#fffFFF01;position:absolute;font-size:.1px;display:block;height:10px;left:5px;right:5px}.w-resize{cursor:w-resize;left:-5px}.e-resize{cursor:e-resize;right:-5px}.n-resize{cursor:n-resize;top:-5px}.s-resize{cursor:s-resize;bottom:-5px}.resizable-handle{background-color:#679ffa;width:10px;height:10px;position:absolute;font-size:.1px;display:block}.se-resize{bottom:-5px;right:-5px;cursor:se-resize}.ne-resize{top:-5px;right:-5px;cursor:ne-resize}.sw-resize{bottom:-5px;left:-5px;cursor:sw-resize}.nw-resize{top:-5px;left:-5px;cursor:nw-resize}.field{position:absolute}.field-text{background-color:#99b1c440;cursor:move;color:#000;width:inherit;height:inherit}.field-text>div{background-color:#99b1c4DD;box-sizing:border-box;width:100%;height:100%;padding:1px 5px;font-size:10px;overflow:hidden;text-overflow:ellipsis;pointer-events:none}.field-name{position:absolute;width:auto;left:50%;top:0;-webkit-transform:translate(-50%,calc(-100% - 5px));transform:translate(-50%,calc(-100% - 5px));padding:2px 5px;background-color:#fff;border:#688296;box-shadow:rgba(0,0,0,.52) 0 0 5px;font-size:8px;color:#688296;cursor:context-menu}.context-menu{position:absolute;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;width:auto;left:50%;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);margin-top:5px;background-color:#fff;border:#688296;box-shadow:rgba(0,0,0,.52) 0 0 5px}"]}]}],e.ctorParameters=function(){return[{type:P},{type:i.ZoomService}]},e.propDecorators={contextMenuClick:[{type:t.Output}]},e}();var O=function(){function e(){this.acceptEvent=new t.EventEmitter,this.cancelEvent=new t.EventEmitter,this._error=null}return Object.defineProperty(e.prototype,"hasError",{get:function(){return null!=this.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},set:function(e){this._error=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.hasError&&(this._error=null)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.initialValue||(this.initialValue=""),this.value=this.initialValue},e.prototype.refresh=function(e){var t=this;e&&(this._error=null,this._value=this.initialValue,setTimeout((function(){t.inputBox.nativeElement.focus()}),0))},e.prototype.acceptClick=function(){null!==this.value&&""!==this.value||(this._error="A new value can't be empty"),this.hasError||this.acceptEvent.emit({id:this.operationId,newValue:this.value})},e.prototype.cancelClick=function(){this.modalElement&&this.modalElement.cancelClose()},e.decorators=[{type:t.Component,args:[{selector:"gd-rename-modal",template:'<gd-modal #modal [id]="id" [title]="title" (visible)="refresh($event)">\n  <div class="window">\n    <div class="prompt">{{ promptText }}</div>\n    <input #inputBox type="text" [value]="value" (input)="value=$event.target.value" (keyup.enter)="acceptClick()" (keyup.esc)="cancelClick()"/>\n\n    <div class="error" *ngIf="error">{{ error }}</div>\n\n    <div class="buttons">      \n      <div class="btn" (click)="acceptClick()">{{ acceptText }}</div>\n      <div class="btn" (click)="cancelClick()">Cancel</div>\n    </div>\n  </div>\n</gd-modal>',styles:[".btn{padding:5px 20px;background-color:#25c2d4;cursor:pointer;color:#fff!important}.btn:hover{background-color:#688296;color:#ccd0d4!important}.image-btn{text-align:center;color:#fff;cursor:pointer;margin:1px}.image-btn:hover{color:#688296!important}.image-btn>fa-icon{padding:5px;font-size:16px}.list-item:nth-of-type(even){background-color:#f4f4f4}.list-item:hover{background-color:#e5e5e5}input{margin-top:20px;margin-bottom:20px;padding:5px}.window{min-width:400px;min-height:auto;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:24px}.buttons{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-left:auto;margin-top:auto}.buttons>div{margin-left:10px}.error{color:red;padding-top:1px;padding-bottom:20px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={id:[{type:t.Input}],title:[{type:t.Input}],promptText:[{type:t.Input}],acceptText:[{type:t.Input}],operationId:[{type:t.Input}],initialValue:[{type:t.Input}],acceptEvent:[{type:t.Output}],cancelEvent:[{type:t.Output}],modalElement:[{type:t.ViewChild,args:["modal",{static:!0}]}],inputBox:[{type:t.ViewChild,args:["inputBox",{static:!0}]}],error:[{type:t.Input}]},e}();var E=function(){function e(e,t,i,n,o,r){var a=this;this._modalService=e,this.hostingComponentsService=t,this.addDynamicComponentService=i,this._zoomService=n,this._templateService=o,this._documentPageService=r,this.fieldWrappers=new Map,this._zoom=n.zoom,n.zoomChange.subscribe((function(e){a._zoom=e})),this._currentTemplateChangedSubscription=o.currentTemplateChanged.subscribe((function(e){return a.setTemplate(e)})),this.setTemplate(this._templateService.currentTemplate),this._documentPageService.activePageChanged.subscribe((function(e){return a.updateActivePage()}))}return Object.defineProperty(e.prototype,"document",{get:function(){return this._document},set:function(e){this._document=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._zoom/100},enumerable:!0,configurable:!0}),e.prototype.addField=function(e){var t=this,i=this.hostingComponentsService.find(e.pageNumber);if(i){var n=i.viewContainerRef,o=this.addDynamicComponentService.addDynamicComponent(n,M),r=new z(o),a=this.document.pages.find((function(t){return t.number===e.pageNumber}));r.fieldComponent.pageSize=new v(a.width,a.height),r.fieldComponent.field=e,r.contextMenuSubscription=r.fieldComponent.contextMenuClick.subscribe((function(e){return t.fieldContextMenuClick(e)})),this.fieldWrappers.set(e,r)}},e.prototype.fieldContextMenuClick=function(e){if("rename"===e.action)return this.fieldNameModal.operationId=e.fieldName,this.fieldNameModal.initialValue=e.fieldName,void this._modalService.open("FieldNameModal");"remove"!==e.action||this._template.removeFieldByName(e.fieldName)},e.prototype.fieldNameModalAccept=function(e){var t=e.id,i=e.newValue;if(t!==i&&this._template.getFieldByName(i))return void(this.fieldNameModal.error="Field with the same name already exists");this._modalService.close("FieldNameModal");var n=this._template.getFieldByName(t);n&&(n.name=i)},e.prototype.removeFields=function(){this.fieldWrappers.forEach((function(e){e.destroy()})),this.fieldWrappers.clear()},e.prototype.removeField=function(e){var t=this.fieldWrappers.get(e);t&&t.destroy(),this.fieldWrappers.delete(e)},e.prototype.getCurrentPosition=function(e,t){var i=e.x-t.offset().left,n=e.y-t.offset().top;return new b(i,n)},e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){this.updateActivePage()},e.prototype.ngOnDestroy=function(){this._fieldAddedSubscription&&this._fieldAddedSubscription.unsubscribe(),this._fieldRemovedSubscription&&this._fieldRemovedSubscription.unsubscribe(),this._currentTemplateChangedSubscription&&this._currentTemplateChangedSubscription.unsubscribe()},e.prototype.doubleTap=function(e){},e.prototype.setActivePage=function(e){e.preventDefault();var t=i.Utils.getMousePosition(e),n=document.elementsFromPoint(t.x,t.y).find((function(e){return e.id&&e.id.startsWith("page-")}));n&&this._documentPageService.setActivePage(parseInt(n.id.substring("page-".length),10))},e.prototype.updateActivePage=function(){var e="page-"+this._documentPageService.activePage;this.surface.nativeElement.querySelectorAll("gd-page").forEach((function(t){var i=t.children[0];i.id===e?(i.style.opacity="1",i.parentElement.parentElement.style.background="#FFFFFF"):(i.style.opacity="0.5",i.parentElement.parentElement.style.background="#688296")}))},e.prototype.setTemplate=function(e){var t=this;this._template=e,this._fieldAddedSubscription&&this._fieldAddedSubscription.unsubscribe(),this._fieldRemovedSubscription&&this._fieldRemovedSubscription.unsubscribe(),this._template&&(this._fieldAddedSubscription=this._template.addedField.subscribe((function(e){return t.addField(e)})),this._fieldRemovedSubscription=this._template.removedField.subscribe((function(e){return t.removeField(e)})),this.removeFields(),this._template=e,this._template.fields.forEach((function(e){t.addField(e)})))},e.decorators=[{type:t.Component,args:[{selector:"gd-surface",template:'<div #surface class="doc-panel">\n  <gd-document class="gd-document" *ngIf="document" [mode]="false" [file]="document" gdScrollable gdRenderPrint\n    [htmlMode]="false" (click)="setActivePage($event)"></gd-document>\n\n  <gd-rename-modal #fieldNameModal [id]="\'FieldNameModal\'" [title]="\'Rename Field\'"\n    [promptText]="\'Enter a new field name:\'" [acceptText]="\'Save\'" (acceptEvent)="fieldNameModalAccept($event)">\n  </gd-rename-modal>\n</div>',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);.red{box-shadow:10px 5px 5px red}:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}::ng-deep .top-panel{align-content:flex-start}.gd-document{position:absolute;height:calc(100vh - 60px);width:calc(100vw - 300px);left:0;top:60px;right:-300px;overflow:auto}::ng-deep .panzoom{-webkit-box-pack:unset!important;justify-content:unset!important}::ng-deep .page{position:relative}::ng-deep .gd-page-image{width:unset;height:unset}"]}]}],e.ctorParameters=function(){return[{type:i.ModalService},{type:i.HostingDynamicComponentService},{type:i.AddDynamicComponentService},{type:i.ZoomService},{type:k},{type:j}]},e.propDecorators={fieldNameModal:[{type:t.ViewChild,args:["fieldNameModal",{static:!0}]}],surface:[{type:t.ViewChild,args:["surface",{static:!0}]}],document:[{type:t.Input}]},e}();var z=function(){function e(e){this.ref=e,this.fieldComponent=e.instance}return e.prototype.destroy=function(){this.ref&&this.ref.destroy(),this.contextMenuSubscription&&this.contextMenuSubscription.unsubscribe()},e}();var A=function(){function e(){this.acceptEvent=new t.EventEmitter,this.cancelEvent=new t.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.acceptClick=function(){this.acceptEvent.emit(this.operationId)},e.prototype.cancelClick=function(){this.modalElement&&this.modalElement.cancelClose()},e.decorators=[{type:t.Component,args:[{selector:"gd-confirmation-modal",template:'<gd-modal #modal [id]="id" [title]="title">\n  <div class="window">\n    <div class="prompt" [innerHTML]="promptText"></div>\n\n    <div class="buttons">      \n      <div class="btn" (click)="acceptClick()">{{ acceptText }}</div>\n      <div class="btn" (click)="cancelClick()">Cancel</div>\n    </div>\n  </div>\n</gd-modal>\n',styles:[".btn{padding:5px 20px;background-color:#25c2d4;cursor:pointer;color:#fff!important}.btn:hover{background-color:#688296;color:#ccd0d4!important}.image-btn{text-align:center;color:#fff;cursor:pointer;margin:1px}.image-btn:hover{color:#688296!important}.image-btn>fa-icon{padding:5px;font-size:16px}.list-item:nth-of-type(even){background-color:#f4f4f4}.list-item:hover{background-color:#e5e5e5}.window{min-width:400px;min-height:auto;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:24px}.buttons{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-left:auto;margin-top:20px}.buttons>div{margin-left:10px}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={id:[{type:t.Input}],title:[{type:t.Input}],promptText:[{type:t.Input}],acceptText:[{type:t.Input}],operationId:[{type:t.Input}],acceptEvent:[{type:t.Output}],cancelEvent:[{type:t.Output}],modalElement:[{type:t.ViewChild,args:["modal",{static:!0}]}]},e}();var N=function(){function e(){}return e.prototype.generateCsvForParseResults=function(e){for(var t="field, value",i=0;i<e.length;i++)if(t+="\r\n",Array.isArray(e[i].value))for(var n=new f(e[i].value),o=0;o<n.rows.length;o++){t+=this.prepareCsvItem(e[i].name)+",";for(var r=0;r<n.rows[o].length;r++)r>0&&(t+=","),t+=this.prepareCsvItem(n.rows[o][r]);o<n.rows.length-1&&(t+="\r\n")}else t+=this.prepareCsvItem(e[i].name)+","+this.prepareCsvItem(e[i].value);return t},e.prototype.prepareCsvItem=function(e){if(!e)return"";var t=e.replace(/"/g,'""');return t.indexOf(",")>-1||t.indexOf("\r")>-1||t.indexOf('"')>-1||t.indexOf("'")>-1?'"'+t+'"':t},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),D=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"gd-table-viewer",template:'<gd-modal #modal [id]="\'TableViewer\'" [title]="\'Table Viewer\'">\n    <div class="window" *ngIf="table">\n        <table>\n            <tr *ngFor="let r of table.rows">\n                <td *ngFor="let c of r">{{c}}</td>\n            </tr>\n        </table>\n\n    </div>\n</gd-modal>',styles:[".window{min-width:400px;min-height:auto;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:24px}table{border-collapse:collapse;border:1px solid #e5e5e5}td{border:1px solid #e5e5e5;padding:5px}tr:nth-of-type(odd){background-color:#f4f4f4}tr:hover{background-color:#e5e5e5}"]}]}],e.ctorParameters=function(){return[]},e}();var R=function(){function e(e,t,i,n,o,r){var a=this;this._modalService=e,this._parserService=t,this._sourceFileService=i,this._templateService=n,this._utilsService=o,this._placeholderService=r,this._parseState=new h,this.isDataMode=!0,this.isTemplateMode=!1,this._currentTemplateChangedSubscription=this._templateService.currentTemplateChanged.subscribe((function(e){return a.currentTemplate=e})),this._templateAddedSubscription=this._templateService.templateAddedSubject.subscribe((function(e){return a.templateIds.push(e)})),this._templateRemovedSubscription=this._templateService.templateRemovedSubject.subscribe((function(e){return a.removeTemplateId(e)})),this.currentTemplate=this._templateService.currentTemplate,this.templateIds=[],this._templateService.templateIds.forEach((function(e){a.templateIds.push(e)}))}return Object.defineProperty(e.prototype,"parseState",{get:function(){return this._parseState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTemplate",{get:function(){return this._currentTemplate},set:function(e){var t=this;this._currentTemplateModifiedSubscription&&this._currentTemplateModifiedSubscription.unsubscribe(),this._currentTemplate=e,this._currentTemplateModifiedSubscription=this._currentTemplate.modified.subscribe((function(e){return t.parseState.prompt="Template was changed. Please parse data again."})),this.parseState.prompt="Press Parser to extract data by this template"},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this._currentTemplateChangedSubscription&&this._currentTemplateChangedSubscription.unsubscribe(),this._templateAddedSubscription&&this._templateAddedSubscription.unsubscribe(),this._templateRemovedSubscription&&this._templateRemovedSubscription.unsubscribe()},e.prototype.ngOnInit=function(){},e.prototype.manageTemplates=function(){this.isDataMode=!1,this.isTemplateMode=!0},e.prototype.isCurrentTemplate=function(e){return this.currentTemplate&&this.currentTemplate.id===e.id},e.prototype.selectTemplateClick=function(e){e&&(this._templateService.selectTemplate(e),this.showData())},e.prototype.createTemplateClick=function(){this._templateService.createTemplate()},e.prototype.renameTemplateClick=function(e,t){t.stopPropagation(),t.preventDefault(),e&&this.templateNameModal&&(this.templateNameModal.operationId=e.id,this.templateNameModal.initialValue=e.name,this._modalService.open("TemplateNameModal"))},e.prototype.templateNameModalAccept=function(e){var t=e.id,i=e.newValue;try{this._templateService.renameTemplate({id:t,name:i})}catch(e){return void(this.templateNameModal.error=e)}this._modalService.close("TemplateNameModal")},e.prototype.removeTemplateClick=function(e,t){t.stopPropagation(),t.preventDefault(),this.templateRemoveModal&&(this.templateRemoveModal.operationId=e.id,this.templateRemoveModal.promptText="Remove template <b>"+e.name+"</b>?",this._modalService.open("TemplateRemoveModal"))},e.prototype.templateRemoveModalAccept=function(e){this._modalService.close("TemplateRemoveModal"),this._templateService.removeTemplate({id:e,name:""})},e.prototype.downloadTemplateClick=function(e,t){t.stopPropagation(),t.preventDefault();var i=this._templateService.serialize(e),n=new File([i],e.name+".json",{type:"text/plain"}),o=window.URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=n.name,r.click(),URL.revokeObjectURL(o)},e.prototype.onFileSelected=function(e){var t=this,i=e.target.files[0];if(i){var n=new FileReader;n.readAsText(i),n.onload=function(e){t._templateService.deserialize(n.result.toString()),t.uploadTemplate.nativeElement.value=null}}},e.prototype.showData=function(){this.isTemplateMode=!1,this.isDataMode=!0},e.prototype.parse=function(){var e=this;this.parseState.execute();var t=this._placeholderService.startOperation("Parsing data..."),i={next:function(t){e.parseState.result=t.data},error:function(i){e.parseState.error=e._parserService.getErrorMessage(i),t.error(i)},complete:function(){return t.complete()}};this._parserService.parseByTemplate(this._sourceFileService.sourceFile,null,this._templateService.currentTemplate).subscribe(i)},e.prototype.downloadResultsAsCsv=function(){if(this.parseState.isCompleted&&0!==this.parseState.result.length){var e=this._utilsService.generateCsvForParseResults(this.parseState.result),t=new File([e],this.fileNameForCsv?this.fileNameForCsv+" - data.csv":this._sourceFileService.sourceFile.guid+" - data.csv",{type:"text/plain"}),i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=t.name,n.click(),URL.revokeObjectURL(i)}},e.prototype.isArray=function(e){return Array.isArray(e)},e.prototype.showTableValue=function(e){var t=new f(e);this.tableViewer.table=t,this._modalService.open("TableViewer")},e.prototype.removeTemplateId=function(e){for(var t=0;t<this.templateIds.length;t++)if(this.templateIds[t].id===e.id)return void this.templateIds.splice(t,1)},e.decorators=[{type:t.Component,args:[{selector:"gd-parser-side-panel",template:'<div class="side-panel">\n    <input type="file" #uploadTemplate (change)="onFileSelected($event)" />\n\n    <div *ngIf="isDataMode">\n        <div class="side-panel-title">\n            <div>{{ currentTemplate?.name }}</div>\n            <div class="image-btn" (click)="manageTemplates()">\n                <fa-icon [icon]="\'bars\'"></fa-icon>\n            </div>\n        </div>\n\n        <div class="side-panel-toolbar">\n            <div class="image-btn" (click)="createTemplateClick()" title="Create a new template">\n                <fa-icon [icon]="\'file\'"></fa-icon>\n            </div>\n            <div class="image-btn" (click)="uploadTemplate.click()" title="Upload the existing template">\n                <fa-icon [icon]="\'upload\'"></fa-icon>\n            </div>\n\n            <div class="side-panel-toolbar-space"></div>\n\n            <div class="image-btn" (click)="renameTemplateClick(currentTemplate, $event)" title="Rename the current template">\n                <fa-icon [icon]="\'edit\'"></fa-icon>\n            </div>\n            <div class="image-btn" *ngIf="currentTemplate?.isStored" (click)="removeTemplateClick(currentTemplate, $event)"\n                title="Remove the current template">\n                <fa-icon [icon]="\'trash\'"></fa-icon>\n            </div>\n            <div class="image-btn" *ngIf="currentTemplate?.isStored" (click)="downloadTemplateClick(currentTemplate, $event)"\n                title="Download the current template">\n                <fa-icon [icon]="\'file-download\'"></fa-icon>\n            </div>\n        </div>\n\n        <div class="side-panel-content" *ngIf="parseState.isProcessing">\n            <div>Parsing data...</div>\n        </div>\n\n        <div class="side-panel-content" *ngIf="parseState.isFailed">\n            <div class="side-panel-content-text error-text">Error occurs while parsing data.</div>\n            <div class="btn" (click)="parse()">Parse again</div>\n        </div>\n\n        <div class="side-panel-content" *ngIf="parseState.isReadyToRun">\n            <div class="side-panel-content-text" [innerHTML]="parseState.prompt"></div>\n            <div class="btn" (click)="parse()">Parse</div>\n        </div>\n\n        <div class="side-panel-content" *ngIf="parseState.isCompleted && !(parseState.result?.length > 0)">\n            <div class="side-panel-content-text">\n                No data is extracted. Try to change the template.\n            </div>\n        </div>\n\n        <div class="data-panel" *ngIf="parseState.result?.length > 0">\n            <div class="side-panel-toolbar">\n                <div class="btn" (click)="downloadResultsAsCsv()">Download as CSV</div>\n            </div>\n            <div class="data-item list-item" *ngFor="let r of parseState.result">\n                <div class="data-item-field">{{ r.name }}</div>\n                <div class="data-item-value" *ngIf="r.value && !isArray(r.value)">{{ r.value }}</div>\n                <div class="data-item-value" *ngIf="r.value && isArray(r.value)">\n                    <div class="btn" (click)="showTableValue(r.value)">Show Table</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div *ngIf="isTemplateMode">\n        <div class="side-panel-title">\n            <div>Manage Templates</div>\n            <div class="image-btn" (click)="showData()">\n                <fa-icon [icon]="\'times\'"></fa-icon>\n            </div>\n        </div>\n        <div class="no-data-panel" *ngIf="templateIds.length == 0">\n            <div class="side-panel-content-text">There are no templates. Try to create a new one or upload the existing\n                one.</div>\n        </div>\n\n        <div class="template-list">\n            <div class="template-item list-item" *ngFor="let t of templateIds" (click)="selectTemplateClick(t)">\n                <div class="template-item-text" [ngClass]="{\'template-item-current\': isCurrentTemplate(t)}">{{ t?.name\n                    }} </div>\n                <div class="image-btn" (click)="renameTemplateClick(t, $event)" title="Rename a template">\n                    <fa-icon [icon]="\'edit\'"></fa-icon>\n                </div>\n                <div class="image-btn" (click)="downloadTemplateClick(t, $event)" title="Download a template">\n                    <fa-icon [icon]="\'file-download\'"></fa-icon>\n                </div>\n                <div class="image-btn" (click)="removeTemplateClick(t, $event)" title="Remove a template">\n                    <fa-icon [icon]="\'trash\'"></fa-icon>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<gd-rename-modal #templateNameModal [id]="\'TemplateNameModal\'" [title]="\'Rename Template\'"\n    [promptText]="\'Enter a new template name:\'" [acceptText]="\'Save\'" (acceptEvent)="templateNameModalAccept($event)">\n</gd-rename-modal>\n<gd-confirmation-modal #templateRemoveModal [id]="\'TemplateRemoveModal\'" [title]="\'Remove Template\'"\n    [acceptText]="\'Remove\'" (acceptEvent)="templateRemoveModalAccept($event)">\n</gd-confirmation-modal>\n<gd-table-viewer #tableViewer></gd-table-viewer>',styles:[".btn{padding:5px 20px;background-color:#25c2d4;cursor:pointer;color:#fff!important}.btn:hover{background-color:#688296;color:#ccd0d4!important}.image-btn{text-align:center;color:#fff;cursor:pointer;margin:1px}.image-btn:hover{color:#688296!important}.image-btn>fa-icon{padding:5px;font-size:16px}.list-item:nth-of-type(even){background-color:#f4f4f4}.list-item:hover{background-color:#e5e5e5}.list-item .image-btn,input{display:none}.list-item:hover .image-btn{display:block;color:#c4c4c4}.error-text{color:red}.side-panel{width:100%;height:100%}.side-panel>div{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;height:100%}.side-panel-title{background-color:#25c2d4;color:#fff;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;padding:10px}.side-panel-title>div{padding-left:5px}.side-panel-toolbar{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;padding:10px}.side-panel-toolbar>div{color:#acacac}.side-panel-toolbar-space{margin-left:10px}.side-panel-content-text{padding:20px;text-align:center}.side-panel-content{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;height:100%;width:100%}.data-panel{overflow-x:hidden;overflow-y:auto;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center;-webkit-box-pack:stretch;justify-content:stretch;height:100%;width:100%}.data-item{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:center;align-items:center;-webkit-box-pack:stretch;justify-content:stretch;width:100%}.data-item>div{padding:10px}.data-item-field,.data-item-value{-webkit-box-flex:1;flex:1}.template-list{position:relative;overflow-x:hidden;overflow-y:auto}.template-item{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:5px;height:2em;cursor:pointer}.template-item-text{-webkit-box-flex:1;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:5px 15px}.template-item-current{font-weight:700}.template-item-btn>fa-icon{padding:5px;font-size:16px}"]}]}],e.ctorParameters=function(){return[{type:i.ModalService},{type:S},{type:T},{type:k},{type:N},{type:C}]},e.propDecorators={fileNameForCsv:[{type:t.Input}],templateNameModal:[{type:t.ViewChild,args:["templateNameModal",{static:!0}]}],templateRemoveModal:[{type:t.ViewChild,args:["templateRemoveModal",{static:!0}]}],uploadTemplate:[{type:t.ViewChild,args:["uploadTemplate",{static:!0}]}],tableViewer:[{type:t.ViewChild,args:["tableViewer",{static:!0}]}]},e}();var L=function(){function e(e){var t,i=this;this._destroy=new c.Subject,this.progress=null,e.descriptionChanged.pipe(d.takeUntil(this._destroy)).subscribe((function(e){i.description=e,i.progress=null,i.isVisible=!0})),e.stateChanged.pipe(d.takeUntil(this._destroy)).subscribe((function(e){t&&t.unsubscribe();var n={next:function(e){return i.progress=e},error:function(e){return i.isVisible=!1},complete:function(){return i.isVisible=!1}};t=e.subscribe(n)}))}return e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},e.decorators=[{type:t.Component,args:[{selector:"gd-placeholder",template:'<div class="loading-wrapper" *ngIf="isVisible">\n    <div class="loading-message">\n        <fa-icon [icon]="[\'fas\',\'circle-notch\']" [spin]="true"></fa-icon>\n        <div>{{ description }}</div>\n    </div>\n</div>',styles:[".loading-wrapper{background:rgba(0,0,0,.5);width:100%;height:100%;font-size:14px;color:#fff;position:fixed;top:0;left:0;z-index:99999}.loading-message{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.loading-message>fa-icon{margin-bottom:10px;font-size:25px;text-align:center}"]}]}],e.ctorParameters=function(){return[{type:C}]},e}();var U=function(){};var $=function(){function e(e,t){this._http=e,this._config=t,this._parserConfig=new c.BehaviorSubject(new U),this._updatedConfig=this._parserConfig.asObservable()}return Object.defineProperty(e.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;return new Promise((function(t,n){var o=e._config.getConfigEndpoint(i.Api.PARSER_APP);e._http.get(o,i.Api.httpOptionsJson).toPromise().then((function(i){var n=i;e._parserConfig.next(n),t()})).catch((function(e){n("Could not load parser config: "+JSON.stringify(e))}))}))},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:p.HttpClient},{type:i.ConfigService}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(p.HttpClient),t.ɵɵinject(i.ConfigService))},token:e,providedIn:"root"}),e}();function B(e){return function(){return e.load()}}function V(e){return new i.LoadingMaskInterceptorService(e)}var W=function(){function e(){o.library.add(r.fas,a.far)}return e.forRoot=function(t){return i.Api.DEFAULT_API_ENDPOINT=t,{ngModule:e}},e.decorators=[{type:t.NgModule,args:[{declarations:[I,E,M,A,R,O,L,D],imports:[s.BrowserModule,i.CommonComponentsModule,p.HttpClientModule,l.ClickOutsideModule,n.FontAwesomeModule],exports:[I,M,i.CommonComponentsModule,E,R],providers:[S,i.ConfigService,i.ExceptionMessageService,$,{provide:p.HTTP_INTERCEPTORS,useClass:i.ErrorInterceptorService,multi:!0},{provide:t.APP_INITIALIZER,useFactory:B,deps:[$],multi:!0},i.LoadingMaskService,{provide:p.HTTP_INTERCEPTORS,useFactory:V,multi:!0,deps:[i.LoadingMaskService]}],entryComponents:[M]}]}],e.ctorParameters=function(){return[]},e}();e.DocumentPageService=j,e.ParserAppComponent=I,e.ParserModule=W,e.ParserService=S,e.PlaceholderService=C,e.SourceFileService=T,e.TemplateService=k,e.initializeApp=B,e.setupLoadingInterceptor=V,e.ɵa=E,e.ɵb=M,e.ɵc=P,e.ɵd=A,e.ɵe=R,e.ɵf=N,e.ɵg=O,e.ɵh=L,e.ɵi=D,e.ɵj=$,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=groupdocs.examples.angular-parser.umd.min.js.map