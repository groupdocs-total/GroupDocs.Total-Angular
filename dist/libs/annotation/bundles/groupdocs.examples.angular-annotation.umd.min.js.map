{"version":3,"sources":["../../../../node_modules/tslib/tslib.es6.js","ng://@groupdocs.examples.angular/annotation/lib/annotation-config.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation-config.service.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation.service.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation-models.ts","ng://@groupdocs.examples.angular/annotation/lib/active-annotation.service.ts","ng://@groupdocs.examples.angular/annotation/lib/remove-annotation.service.ts","ng://@groupdocs.examples.angular/annotation/lib/comment-annotation.service.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation/annotation.component.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation-app.component.ts","ng://@groupdocs.examples.angular/annotation/lib/comment-panel/comment-panel.component.ts","ng://@groupdocs.examples.angular/annotation/lib/comment/comment.component.ts","ng://@groupdocs.examples.angular/annotation/lib/create-comment/create-comment.component.ts","ng://@groupdocs.examples.angular/annotation/lib/annotation.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__values","o","m","Symbol","iterator","i","call","next","length","value","done","AnnotationConfig","AnnotationConfigService","_http","_config","this","_annotationConfig","BehaviorSubject","_updatedConfig","asObservable","defineProperty","prototype","load","_this","Promise","resolve","reject","configEndpoint","getConfigEndpoint","Api","ANNOTATION_APP","get","httpOptionsJson","toPromise","then","response","annotationConfig","catch","JSON","stringify","Injectable","args","providedIn","HttpClient","ConfigService","AnnotationService","loadFiles","path","post","getAnnotationApiEndpoint","LOAD_FILE_TREE","loadFile","credentials","LOAD_DOCUMENT_DESCRIPTION","upload","file","url","rewrite","formData","FormData","append","String","UPLOAD_DOCUMENTS","loadPage","page","LOAD_DOCUMENT_PAGE","guid","password","getDownloadUrl","DOWNLOAD_DOCUMENTS","annotate","annotationsData","print","data","documentType","FileUtil","find","format","ANNOTATE","AnnotationType","getAnnotationType","id","TEXT","AREA","POINT","TEXT_STRIKEOUT","POLYLINE","TEXT_FIELD","WATERMARK","TEXT_REPLACEMENT","ARROW","TEXT_REDACTION","TEXT_UNDERLINE","DISTANCE","name","icon","_super","PageAnnotationModel","__","constructor","create","tslib_1.__extends","PageModel","Position","left","top","clone","position","Dimension","width","height","isNone","AnnotationData","text","fontColor","CommentAnnotation","Comment","time","Date","now","userName","comment","ret","RemoveAnnotation","ActiveAnnotationService","_observer","Subject","_activeChange","changeActive","annId","RemoveAnnotationService","_removeAnnotation","remove","CommentAnnotationService","_commentAnnotation","_observerAddComment","_addCommentObserve","addComment","$","jquery","AnnotationComponent","_activeAnnotationService","_removeAnnotationService","_commentAnnotationService","active","dimension","textValue","distanceValue","pointsValue","svgPath","formatting","Formatting","default","points","activeChange","subscribe","setTextFocus","isOnPage","currentPage","document","elementFromPoint","x","y","parent","hasClass","ngOnInit","leftTop","isPolyline","parsedPoints","replace","split","x_1","parseFloat","y_1","comp_1","forEach","point","index","addPoint","isPath","type","end","setEndPosition","getDistance","initPoint","ngAfterViewInit","activation","$event","checkDragging","correctPosition","refreshLeftTop","pageHeight","pageWidth","dragOver","preventDefault","stopPropagation","dragStart","oldPosition","Utils","getMousePosition","dataTransfer","setData","dragging","top_1","_b","tslib_1.__values","_c","endPosition","pathValue","getAnnotationClass","isStrikeoutOrUnderline","isTextReplacement","saveText","draw","onPage","calcPositionAndDimension","setStyles","stroke","stroke-width","fill-opacity","isDistance","class","Number","MAX_VALUE","rightBottom","MIN_VALUE","Math","min","max","calcDimensions","currentPosition","getHeight","undefined","abs","getWidth","isPoint","isSVG","distanceTextOptions","font-size","push","xs","ys","round","sqrt","bottom","window","location","head","getTextX","isText","getFormatting","f","fontSize","font","color","saveFormatting","getMenuShift","menuWidth","getMenuType","MenuType","FOR_ANNOTATION","setTimeout","element","focus","textAreaHeight","key","textarea","scrollHeight","scrollWidth","hideMenu","getAnnotationData","annotationData","parseInt","toHex","pageNumber","getSvgPath","previousX","previousY","Component","selector","template","AnnotationAppComponent","_annotationService","_modalService","_navigateService","_tabActivatorService","_hostingComponentsService","_addDynamicComponentService","uploadFilesService","pagePreloadService","passwordService","_windowService","title","files","browseFilesModal","CommonModals","BrowseFiles","formatDisabled","annotationTypes","annotationTypeFirst","annotationTypeSecond","annotationTypeThird","countPages","comments","Map","fileWasDropped","annotations","activeAnnotationId","commentOpenedId","commentAnnotation","set","addCommentObserve","removeAnnotation","componentRef","destroy","delete","uploadsChange","uploads","item","rewriteConfig","obj","selectFile","selectDir","checkPreload","preloadPageCountConfig","pages","preloadPages","passChange","pass","PasswordRequired","isDesktop","onResize","w","getComments","zoom","pageSelector","preloadPageCount","download","downloadOriginal","downloadAnnotated","defaultDocumentConfig","defaultDocument","browse","enableRightClick","textAnnotation","areaAnnotation","pointAnnotation","textStrikeoutAnnotation","polylineAnnotation","textFieldAnnotation","watermarkAnnotation","textReplacementAnnotation","arrowAnnotation","textRedactionAnnotation","textUnderlineAnnotation","distanceAnnotation","openModal","open","closeModal","close","modalId","FileCredentials","cleanAnnotations","importAnnotations","clearData","start","this_1","annotations_1","annotations_1_1","annotation","addAnnotationComponent","onRightClick","enableRightClickConfig","downloadFile","assign","values","OperationSuccess","isVisible","supported","supportedAnnotations","getAnnotationTypeConfig","activeTab","activeAnnotationTab","codesConfigFirst","checkConfig","codesConfigSecond","annotationList","annotationList_1","annotationList_1_1","annotationType","codesConfigThird","textAnnotationConfig","areaAnnotationConfig","pointAnnotationConfig","textStrikeoutAnnotationConfig","polylineAnnotationConfig","textFieldAnnotationConfig","watermarkAnnotationConfig","textReplacementAnnotationConfig","arrowAnnotationConfig","textRedactionAnnotationConfig","textUnderlineAnnotationConfig","distanceAnnotationConfig","fileDropped","createAnnotation","elementsFromPoint","startsWith","documentPage","getCurrentPosition","pageId","creatingAnnotationId","changeActiveTab","dynamicDirective","viewContainerRef","annotationComponent","addDynamicComponent","getNextId","toString","pageModel","number","resizingCreatingAnnotation","offset","finishCreatingAnnotation","closeComments","maxId","keys","ModalService","NavigateService","TopTabActivatorService","HostingDynamicComponentService","AddDynamicComponentService","UploadFilesService","PagePreloadService","PasswordService","WindowService","CommentPanelComponent","EventEmitter","closePanel","emit","newComment","currentComment","annotationId","clearComment","Input","Output","CommentComponent","getTime","hours","sec","CreateCommentComponent","removeComment","onAddComment","saveName","initializeApp","annotationConfigService","setupLoadingInterceptor","service","LoadingMaskInterceptorService","AnnotationModule","library","add","fas","far","forRoot","apiEndpoint","DEFAULT_API_ENDPOINT","ngModule","NgModule","declarations","exports","CommonComponentsModule","imports","CommonModule","HttpClientModule","FontAwesomeModule","ClickOutsideModule","providers","provide","HTTP_INTERCEPTORS","useClass","ErrorInterceptorService","multi","APP_INITIALIZER","useFactory","deps","LoadingMaskService","entryComponents"],"mappings":";;;;;;;;;;;;;;oFAgBA,IAAIA,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,IAwFrB,SAASO,EAASC,GACrB,IAAIC,EAAsB,mBAAXC,QAAyBF,EAAEE,OAAOC,UAAWC,EAAI,EAChE,OAAIH,EAAUA,EAAEI,KAAKL,GACd,CACHM,KAAM,WAEF,OADIN,GAAKI,GAAKJ,EAAEO,SAAQP,OAAI,GACrB,CAAEQ,MAAOR,GAAKA,EAAEI,KAAMK,MAAOT,KClHhD,IAAAU,EAAA,aCAA,IAAAC,EAAA,WAcE,SAAAA,EAAoBC,EAA2BC,GAA3BC,KAAAF,MAAAA,EAA2BE,KAAAD,QAAAA,EAHvCC,KAAAC,kBAAuD,IAAIC,EAAAA,gBAAgB,IAAIN,GAC/EI,KAAAG,eAA+CH,KAAKC,kBAAkBG,sBAK9EzB,OAAA0B,eAAIR,EAAAS,UAAA,gBAAa,KAAjB,WACE,OAAON,KAAKG,gDAGdN,EAAAS,UAAAC,KAAA,WAAA,IAAAC,EAAAR,KACE,OAAO,IAAIS,SAAO,SAAQC,EAASC,OAC3BC,EAAiBJ,EAAKT,QAAQc,kBAAkBC,EAAAA,IAAIC,gBAC1DP,EAAKV,MAAMkB,IAAIJ,EAAgBE,EAAAA,IAAIG,iBAAiBC,YAAYC,MAAI,SAAEC,OAC9DC,EAAgB,EACtBb,EAAKP,kBAAkBT,KAAK6B,GAC5BX,OACCY,OAAK,SAAEF,GACRT,EAAO,qCAAqCY,KAAKC,UAAUJ,+BAvBlEK,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDALNC,EAAAA,kBACKC,EAAAA,8KAHb,GCAA,IAAAC,EAAA,WASE,SAAAA,EAAoBhC,EAA2BC,GAA3BC,KAAAF,MAAAA,EAA2BE,KAAAD,QAAAA,SAG/C+B,EAAAxB,UAAAyB,UAAA,SAAUC,GACR,OAAOhC,KAAKF,MAAMmC,KAAKjC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIqB,eAAgB,CAACH,KAAQA,GAAOlB,EAAAA,IAAIG,kBAG3Ga,EAAAxB,UAAA8B,SAAA,SAASC,GACP,OAAOrC,KAAKF,MAAMmC,KAAKjC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIwB,0BAA2BD,EAAavB,EAAAA,IAAIG,kBAGnHa,EAAAxB,UAAAiC,OAAA,SAAOC,EAAYC,EAAaC,OACxBC,EAAW,IAAIC,SAOrB,OANAD,EAASE,OAAO,OAAQL,GACxBG,EAASE,OAAO,UAAWC,OAAOJ,IAC9BD,GACFE,EAASE,OAAO,MAAOJ,GAGlBzC,KAAKF,MAAMmC,KAAKjC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIiC,iBAAkBJ,IAGzFb,EAAAxB,UAAA0C,SAAA,SAASX,EAA8BY,GACrC,OAAOjD,KAAKF,MAAMmC,KAAKjC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIoC,mBAAoB,CACvFC,KAAQd,EAAYc,KACpBC,SAAYf,EAAYe,SACxBH,KAAQA,GACPnC,EAAAA,IAAIG,kBAGTa,EAAAxB,UAAA+C,eAAA,SAAehB,GACb,OAAOrC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIwC,mBAAqB,UAAYjB,EAAYc,MAGpGrB,EAAAxB,UAAAiD,SAAA,SAASlB,EAA8BmB,EAAsBC,OACrDC,EAAO,CACXP,KAAQd,EAAYc,KACpBC,SAAYf,EAAYe,SACxBI,gBAAmBA,EACnBG,aAAgBC,EAAAA,SAASC,KAAKxB,EAAYc,MAAM,GAAOW,OACvDL,MAASA,GAEX,OAAOzD,KAAKF,MAAMmC,KAAKjC,KAAKD,QAAQmC,2BAA6BpB,EAAAA,IAAIiD,SAAUL,EAAM5C,EAAAA,IAAIG,sCA/C5FQ,EAAAA,WAAUC,KAAA,CAAC,CACVC,WAAY,oDAJNC,EAAAA,kBACKC,EAAAA,8KAFb,GCEA,IAAAmC,EAAA,WAAA,SAAAA,KA0CA,OA5BgBA,EAAAC,kBAAd,SAAgCC,GAC9B,OAAQA,GACN,KAAKF,EAAeG,KAAKD,GACvB,OAAOF,EAAeG,KACxB,KAAKH,EAAeI,KAAKF,GACvB,OAAOF,EAAeI,KACxB,KAAKJ,EAAeK,MAAMH,GACxB,OAAOF,EAAeK,MACxB,KAAKL,EAAeM,eAAeJ,GACjC,OAAOF,EAAeM,eACxB,KAAKN,EAAeO,SAASL,GAC3B,OAAOF,EAAeO,SACxB,KAAKP,EAAeQ,WAAWN,GAC7B,OAAOF,EAAeQ,WACxB,KAAKR,EAAeS,UAAUP,GAC5B,OAAOF,EAAeS,UACxB,KAAKT,EAAeU,iBAAiBR,GACnC,OAAOF,EAAeU,iBACxB,KAAKV,EAAeW,MAAMT,GACxB,OAAOF,EAAeW,MACxB,KAAKX,EAAeY,eAAeV,GACjC,OAAOF,EAAeY,eACxB,KAAKZ,EAAea,eAAeX,GACjC,OAAOF,EAAea,eACxB,KAAKb,EAAec,SAASZ,GAC3B,OAAOF,EAAec,WAtCdd,EAAAG,KAAO,CAACD,GAAI,OAAQa,KAAM,OAAQC,KAAM,eACxChB,EAAAI,KAAO,CAACF,GAAI,OAAQa,KAAM,OAAQC,KAAM,iBACxChB,EAAAK,MAAQ,CAACH,GAAI,QAASa,KAAM,QAASC,KAAM,aAC3ChB,EAAAM,eAAiB,CAACJ,GAAI,gBAAiBa,KAAM,iBAAkBC,KAAM,iBACrEhB,EAAAO,SAAW,CAACL,GAAI,WAAYa,KAAM,WAAYC,KAAM,aACpDhB,EAAAQ,WAAa,CAACN,GAAI,YAAaa,KAAM,aAAcC,KAAM,YACzDhB,EAAAS,UAAY,CAACP,GAAI,YAAaa,KAAM,YAAaC,KAAM,QACvDhB,EAAAU,iBAAmB,CAACR,GAAI,kBAAmBa,KAAM,mBAAoBC,KAAM,QAC3EhB,EAAAW,MAAQ,CAACT,GAAI,QAASa,KAAM,QAASC,KAAM,iBAC3ChB,EAAAY,eAAiB,CAACV,GAAI,gBAAiBa,KAAM,iBAAkBC,KAAM,SACrEhB,EAAAa,eAAiB,CAACX,GAAI,gBAAiBa,KAAM,iBAAkBC,KAAM,aACrEhB,EAAAc,SAAW,CAACZ,GAAI,WAAYa,KAAM,WAAYC,KAAM,SA8BpEhB,EA1CA,IAkDA,SAAAiB,GAAA,SAAAC,oDJ7BO,SAAmBzG,EAAGC,GAEzB,SAASyG,IAAOnF,KAAKoF,YAAc3G,EADnCD,EAAcC,EAAGC,GAEjBD,EAAE6B,UAAkB,OAAN5B,EAAaC,OAAO0G,OAAO3G,IAAMyG,EAAG7E,UAAY5B,EAAE4B,UAAW,IAAI6E,II0B1CG,CAAAA,EAAAA,GAAzC,CAAyCC,EAAAA,WAIzC,IAAAC,EAAA,WAIE,SAAAA,EAAYC,EAAcC,GACxB1F,KAAKyF,KAAOA,EACZzF,KAAK0F,IAAMA,EAMf,OAHSF,EAAAG,MAAP,SAAaC,GACX,OAAO,IAAIJ,EAASI,EAASH,KAAMG,EAASF,MAEhDF,EAZA,GAcA,IAAAK,EAAA,WAIE,SAAAA,EAAYC,EAAeC,GACzB/F,KAAK8F,MAAQA,EACb9F,KAAK+F,OAASA,EAMlB,OAHEF,EAAAvF,UAAA0F,OAAA,WACE,OAAsB,IAAfhG,KAAK8F,OAA+B,IAAhB9F,KAAK+F,QAEpCF,EAZA,GAcA,IAAAI,EAEE,WACEjG,KAAKkG,KAAO,GACZlG,KAAKmG,UAAY,SAkBrB,IAAAC,EACE,SAAYlC,GACVlE,KAAKkE,GAAKA,GAMd,IAAAmC,EAAA,WAOE,SAAAA,EAAYnC,GACVlE,KAAKkE,GAAKA,EACVlE,KAAKsG,KAAOC,KAAKC,MACjBxG,KAAKkG,KAAO,GACZlG,KAAKyG,SAAW,GAUpB,OAPSJ,EAAAhB,OAAP,SAAcqB,OACNC,EAAM,IAAIN,EAAQK,EAAQxC,IAIhC,OAHAyC,EAAIT,KAAOQ,EAAQR,KACnBS,EAAIF,SAAWC,EAAQD,SACvBE,EAAIL,KAAOI,EAAQJ,KACZK,GAEXN,EArBA,GAuBA,IAAAO,EACE,SAAY1C,GACVlE,KAAKkE,GAAKA,GC3Id,IAAA2C,EAAA,WAME,SAAAA,IAHQ7G,KAAA8G,UAA6B,IAAIC,EAAAA,QACxB/G,KAAAgH,cAAoChH,KAAK8G,UAAU1G,eAYtE,OAPEzB,OAAA0B,eAAIwG,EAAAvG,UAAA,eAAY,KAAhB,WACE,OAAON,KAAKgH,+CAGdH,EAAAvG,UAAA2G,aAAA,SAAaC,GACXlH,KAAK8G,UAAUtH,KAAK0H,IAExBL,EAhBA,GCAA,IAAAM,EAAA,WAOE,SAAAA,IAHQnH,KAAA8G,UAAuC,IAAIC,EAAAA,QAClC/G,KAAAoH,kBAAkDpH,KAAK8G,UAAU1G,eAYpF,OAPEzB,OAAA0B,eAAI8G,EAAA7G,UAAA,mBAAgB,KAApB,WACE,OAAON,KAAKoH,mDAGdD,EAAA7G,UAAA+G,OAAA,SAAOnD,GACLlE,KAAK8G,UAAUtH,KAAK0E,IAExBiD,EAjBA,GCAA,IAAAG,EAAA,WASE,SAAAA,IALQtH,KAAA8G,UAAwC,IAAIC,EAAAA,QACnC/G,KAAAuH,mBAAoDvH,KAAK8G,UAAU1G,eAC5EJ,KAAAwH,oBAAwC,IAAIT,EAAAA,QACnC/G,KAAAyH,mBAA0CzH,KAAKwH,oBAAoBpH,eAqBtF,OAhBEzB,OAAA0B,eAAIiH,EAAAhH,UAAA,oBAAiB,KAArB,WACE,OAAON,KAAKuH,oDAGdD,EAAAhH,UAAAoG,QAAA,SAAQxC,GACNlE,KAAK8G,UAAUtH,KAAK0E,IAGtBvF,OAAA0B,eAAIiH,EAAAhH,UAAA,oBAAiB,KAArB,WACE,OAAON,KAAKyH,oDAGdH,EAAAhH,UAAAoH,WAAA,SAAWhB,GACT1G,KAAKwH,oBAAoBhI,KAAKkH,IAGlCY,EA5BA,OCeMK,EAAIC,EAEVC,EAAA,WA2BE,SAAAA,EAAoBC,EACAC,EACAC,GAFpB,IAAAxH,EAAAR,KAAoBA,KAAA8H,yBAAAA,EACA9H,KAAA+H,yBAAAA,EACA/H,KAAAgI,0BAAAA,EAhBpBhI,KAAAiI,QAAS,EACTjI,KAAAkI,UAAY,IAAIrC,EAAU,EAAG,GAE7B7F,KAAAmI,UAAY,GAEZnI,KAAAoI,cAAgB,MAChBpI,KAAAqI,YAAc,GACdrI,KAAAsI,QAAU,GACVtI,KAAAuI,WAAaC,EAAAA,WAAWC,UAGhBzI,KAAA0I,OAAS,GAMf1I,KAAK8H,yBAAyBa,aAAaC,WAAS,SAAE1E,GACpD1D,EAAKyH,OAASzH,EAAK0D,KAAOA,EACtB1D,EAAKyH,QACPzH,EAAKqI,kBA+ab,OA1aShB,EAAAiB,SAAP,SAAgBlD,OACRmD,EAAcC,SAASC,iBAAiBrD,EAASsD,EAAGtD,EAASuD,GACnE,OAAOJ,GAAepB,EAAEoB,GAAaK,SAASA,WAC3CzB,EAAEoB,GAAaK,SAASA,SAASA,SAASC,SAAS,SAClD1B,EAAEoB,GAAaK,SAASA,SAASA,SAASA,SAASA,SAASC,SAAS,UAG3ExB,EAAAvH,UAAAgJ,SAAA,WAEE,GADAtJ,KAAKuJ,QAAU/D,EAASG,MAAM3F,KAAK4F,UAC/B5F,KAAKwJ,aACP,GAAIxJ,KAAKsI,QAAS,KACVmB,EAAezJ,KAAKsI,QAAQoB,QAAQ,IAAK,IAAIC,MAAM,KACrDC,EAAIC,WAAWJ,EAAa,GAAGE,MAAM,KAAK,IAC1CG,EAAID,WAAWJ,EAAa,GAAGE,MAAM,KAAK,IACxCI,EAAO/J,KACbyJ,EAAaO,SAAO,SAAWC,EAAOC,GACtB,IAAVA,GACY,KAAVD,IACFF,EAAKI,SAAS,IAAI3E,EAASoE,EAAGE,IAC9BF,GAASC,WAAWI,EAAMN,MAAM,KAAK,IACrCG,GAASD,WAAWI,EAAMN,MAAM,KAAK,aAK3C3J,KAAKmK,SAASnK,KAAK4F,eAEhB,GAAI5F,KAAKoK,SAAU,CACxB,GAAIpK,KAAKsI,SAAYtI,KAAKqK,OAASrG,EAAeW,MAAMT,KAAOlE,KAAKkI,UAAUlC,SAAW,KACjFsE,EAAM,IAAI9E,EAASxF,KAAK4F,SAASH,KAAOzF,KAAKkI,UAAUpC,MAAO9F,KAAK4F,SAASF,IAAM1F,KAAKkI,UAAUnC,QACvG/F,KAAKuK,eAAeD,GAChBtK,KAAKkI,UAAUnC,OAAS,IAC1B/F,KAAKuJ,QAAQ7D,KAAO1F,KAAKkI,UAAUnC,OACnC/F,KAAKkI,UAAUnC,QAAmC,EAA1B/F,KAAKkI,UAAUnC,QAErC/F,KAAKkI,UAAUpC,MAAQ,IACzB9F,KAAKuJ,QAAQ9D,MAAQzF,KAAKkI,UAAUpC,MACpC9F,KAAKkI,UAAUpC,OAAiC,EAAzB9F,KAAKkI,UAAUpC,YAGxC9F,KAAKuK,eAAevK,KAAK4F,UAE3B5F,KAAKoI,cAAgBpI,KAAKwK,cAAgB,UACjCxK,KAAKqK,OAASrG,EAAeK,MAAMH,GAC5ClE,KAAKyK,YAELzK,KAAKuK,eAAevK,KAAK4F,WAI7BiC,EAAAvH,UAAAoK,gBAAA,WACE1K,KAAK6I,gBAGPhB,EAAAvH,UAAAqK,WAAA,WACE3K,KAAK8H,yBAAyBb,aAAajH,KAAKkE,KAGlD2D,EAAAvH,UAAAwF,MAAA,SAAM8E,GACA5K,KAAK6K,cAAcD,EAAQ,KAC7B5K,KAAKkI,UAAUpC,OAAS8E,IAI5B/C,EAAAvH,UAAAyF,OAAA,SAAO6E,GACD5K,KAAK6K,cAAc,EAAGD,KACxB5K,KAAKkI,UAAUnC,QAAU6E,IAI7B/C,EAAAvH,UAAAmF,KAAA,SAAKmF,GACH5K,KAAK4F,SAASH,MAAQmF,EACtB5K,KAAK8K,kBACL9K,KAAK+K,kBAGPlD,EAAAvH,UAAAoF,IAAA,SAAIkF,GACF5K,KAAK4F,SAASF,KAAOkF,EACrB5K,KAAK8K,kBACL9K,KAAK+K,kBAGClD,EAAAvH,UAAAyK,eAAR,WACE/K,KAAKuJ,QAAQ9D,KAAOzF,KAAK4F,SAASH,KAClCzF,KAAKuJ,QAAQ7D,IAAM1F,KAAK4F,SAASF,KAG3BmC,EAAAvH,UAAAwK,gBAAR,WACM9K,KAAK4F,SAASH,KAAO,IACvBzF,KAAK4F,SAASH,KAAO,GAEnBzF,KAAK4F,SAASF,IAAM,IACtB1F,KAAK4F,SAASF,IAAM,GAElB1F,KAAK4F,SAASF,IAAM1F,KAAKkI,UAAUnC,OAAS/F,KAAKgL,aACnDhL,KAAK4F,SAASF,IAAM1F,KAAKgL,WAAahL,KAAKkI,UAAUnC,QAEnD/F,KAAK4F,SAASH,KAAOzF,KAAKkI,UAAUpC,MAAQ9F,KAAKiL,YACnDjL,KAAK4F,SAASH,KAAOzF,KAAKiL,UAAYjL,KAAKkI,UAAUpC,QAIzD+B,EAAAvH,UAAA4K,SAAA,SAASN,GACPA,EAAOO,iBACPP,EAAOQ,mBAGTvD,EAAAvH,UAAA+K,UAAA,SAAUT,GACRA,EAAOO,iBACPnL,KAAKsL,YAAcC,EAAAA,MAAMC,iBAAiBZ,GACtCA,EAAOa,cACTb,EAAOa,aAAaC,QAAQ,OAAQ,QAIxC7D,EAAAvH,UAAAmK,UAAA,WACEzK,KAAKkI,UAAY,IAAIrC,EAAU,GAAI,IACnC7F,KAAK4F,SAASH,KAAOzF,KAAK4F,SAASH,KAAO,GAC1CzF,KAAK4F,SAASF,IAAM1F,KAAK4F,SAASF,IAAM,GACxC1F,KAAKuJ,QAAU/D,EAASG,MAAM3F,KAAK4F,WAGrCiC,EAAAvH,UAAAqL,SAAA,SAASf,WACPA,EAAOO,qBACDvF,EAAW2F,EAAAA,MAAMC,iBAAiBZ,GACxC,GAAIhF,EAASsD,GAAKtD,EAASuD,GAAKtB,EAAoBiB,SAASlD,GAAW,KAChEH,EAAOG,EAASsD,EAAIlJ,KAAKsL,YAAYpC,EACrC0C,EAAMhG,EAASuD,EAAInJ,KAAKsL,YAAYnC,EAC1C,GAAInJ,KAAKwJ,aAAc,CACrB,IAAKxJ,KAAK6K,cAAcpF,EAAMmG,GAC5B,OAEF5L,KAAKqI,YAAc,OACnB,IAAoB,IAAAwD,EAAAC,EAAA9L,KAAK0I,QAAMqD,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA5B,IAAMyK,EAAK8B,EAAArM,MACduK,EAAMxE,KAAOwE,EAAMxE,KAAOA,EAC1BwE,EAAMvE,IAAMuE,EAAMvE,IAAMkG,EACxB5L,KAAKqI,aAAe4B,EAAMxE,KAAO,IAAMwE,EAAMvE,IAAM,sGAErD1F,KAAKuJ,QAAQ9D,MAAQA,EACrBzF,KAAKuJ,QAAQ7D,KAAOkG,OACf,GAAI5L,KAAKoK,SAAU,CACxB,IAAKpK,KAAK6K,cAAcpF,EAAMmG,GAC5B,OAEF5L,KAAK4F,SAASH,MAAQA,EACtBzF,KAAK4F,SAASF,KAAOkG,EACrB5L,KAAKgM,YAAYvG,MAAQA,EACzBzF,KAAKgM,YAAYtG,KAAOkG,EACxB5L,KAAKiM,UAAY,IAAMjM,KAAK4F,SAASH,KAAO,IAAMzF,KAAK4F,SAASF,IAAM,KAAO1F,KAAKgM,YAAYvG,KAAO,IAAMzF,KAAKgM,YAAYtG,IAC5H1F,KAAKoI,cAAgBpI,KAAKwK,cAAgB,KAC1CxK,KAAKuJ,QAAQ9D,MAAQA,EACrBzF,KAAKuJ,QAAQ7D,KAAOkG,OAEpB5L,KAAK4F,SAASH,MAAQA,EACtBzF,KAAK4F,SAASF,KAAOkG,EACrB5L,KAAK8K,kBACL9K,KAAK+K,iBAEP/K,KAAKsL,YAAc1F,IAIvBiC,EAAAvH,UAAA4L,mBAAA,WACE,OAAQlM,KAAKqK,MACX,KAAKrG,EAAeG,KAAKD,GACvB,MAAO,kDACT,KAAKF,EAAeM,eAAeJ,GACjC,MAAO,+EACT,KAAKF,EAAea,eAAeX,GACjC,MAAO,+EACT,KAAKF,EAAeY,eAAeV,GACjC,MAAO,4DACT,KAAKF,EAAeU,iBAAiBR,GACnC,MAAO,8DACT,KAAKF,EAAeK,MAAMH,GACxB,MAAO,GACT,QACE,MAAO,iCAIb2D,EAAAvH,UAAA6L,uBAAA,WACE,OAAOnM,KAAKqK,OAASrG,EAAeM,eAAeJ,IAAMlE,KAAKqK,OAASrG,EAAea,eAAeX,IAGvG2D,EAAAvH,UAAA8L,kBAAA,WACE,OAAOpM,KAAKqK,OAASrG,EAAeU,iBAAiBR,IAGvD2D,EAAAvH,UAAA+L,SAAA,SAAS3M,GACPM,KAAKmI,UAAYzI,GAGnBmI,EAAAvH,UAAAgM,KAAA,SAAK1G,GACC5F,KAAKuM,OAAO3G,KACV5F,KAAKwJ,aACPxJ,KAAKmK,SAASvE,GACL5F,KAAKoK,WACdpK,KAAKuK,eAAe3E,GACpB5F,KAAKoI,cAAgBpI,KAAKwK,cAAgB,MAE5CxK,KAAKwM,6BAIT3E,EAAAvH,UAAAmM,UAAA,WACE,MAAO,CACLC,OAAU,UACVC,eAAgB,EAChBC,eAAgB,EAChB1I,IAAOlE,KAAKwJ,aAAe,0BAA6BxJ,KAAK6M,aAAe,0BAA4B,wBAA2B7M,KAAKkE,GACxI4I,MAAS,mBAIbjF,EAAAvH,UAAAkJ,WAAA,WACE,OAAOxJ,KAAKqK,OAASrG,EAAeO,SAASL,IAGvC2D,EAAAvH,UAAAkM,yBAAR,mBACQjD,EAAU,IAAI/D,EAASuH,OAAOC,UAAWD,OAAOC,WAChDC,EAAc,IAAIzH,EAASuH,OAAOG,UAAWH,OAAOG,WAC1D,GAAIlN,KAAKwJ,iBACP,IAAoB,IAAAqC,EAAAC,EAAA9L,KAAK0I,QAAMqD,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA5B,IAAMyK,EAAK8B,EAAArM,MACd6J,EAAQ9D,KAAO0H,KAAKC,IAAInD,EAAMxE,KAAM8D,EAAQ9D,MAC5C8D,EAAQ7D,IAAMyH,KAAKC,IAAInD,EAAMvE,IAAK6D,EAAQ7D,KAC1CuH,EAAYxH,KAAO0H,KAAKE,IAAIpD,EAAMxE,KAAMwH,EAAYxH,MACpDwH,EAAYvH,IAAMyH,KAAKE,IAAIpD,EAAMvE,IAAKuH,EAAYvH,4GAGpD6D,EAAQ9D,KAAO0H,KAAKC,IAAIpN,KAAK4F,SAASH,KAAMzF,KAAKgM,YAAYvG,MAC7D8D,EAAQ7D,IAAMyH,KAAKC,IAAIpN,KAAK4F,SAASF,IAAK1F,KAAKgM,YAAYtG,KAC3DuH,EAAYxH,KAAO0H,KAAKE,IAAIrN,KAAK4F,SAASH,KAAMzF,KAAKgM,YAAYvG,MACjEwH,EAAYvH,IAAMyH,KAAKE,IAAIrN,KAAK4F,SAASF,IAAK1F,KAAKgM,YAAYtG,KAEjE1F,KAAKkI,UAAUpC,MAAQmH,EAAYxH,KAAO8D,EAAQ9D,KAClDzF,KAAKkI,UAAUnC,OAASkH,EAAYvH,IAAM6D,EAAQ7D,IAClD1F,KAAKuJ,QAAUA,GAGjB1B,EAAAvH,UAAAgN,eAAA,SAAeC,GACTA,EAAgB9H,MAAQzF,KAAKiL,WAAasC,EAAgB9H,MAAQ,IACpEzF,KAAKkI,UAAUpC,MAAQyH,EAAgB9H,KAAOzF,KAAK4F,SAASH,MAE1D8H,EAAgB7H,KAAO1F,KAAKgL,YAAcuC,EAAgB7H,KAAO,IACnE1F,KAAKkI,UAAUnC,OAASwH,EAAgB7H,IAAM1F,KAAK4F,SAASF,MAIhEmC,EAAAvH,UAAAkN,UAAA,WACE,YAAiCC,IAA1BzN,KAAKkI,UAAUnC,YAAuB0H,EAAYN,KAAKO,IAAI1N,KAAKkI,UAAUnC,SAGnF8B,EAAAvH,UAAAqN,SAAA,WACE,YAAgCF,IAAzBzN,KAAKkI,UAAUpC,WAAsB2H,EAAYN,KAAKO,IAAI1N,KAAKkI,UAAUpC,QAG1E+B,EAAAvH,UAAAuK,cAAR,SAAsBpF,EAAcC,GAClC,QAAS1F,KAAKuJ,QAAQ9D,KAAOA,EAAO,GAAKzF,KAAKuJ,QAAQ7D,IAAMA,EAAM,GAChE1F,KAAKuJ,QAAQ7D,IAAMA,EAAM1F,KAAKkI,UAAUnC,OAAS/F,KAAKgL,YACtDhL,KAAKuJ,QAAQ9D,KAAOA,EAAOzF,KAAKkI,UAAUpC,MAAQ9F,KAAKiL,YAG3DpD,EAAAvH,UAAAsN,QAAA,WACE,OAAO5N,KAAKqK,OAASrG,EAAeK,MAAMH,IAG5C2D,EAAAvH,UAAAuN,MAAA,WACE,OAAO7N,KAAKqK,OAASrG,EAAeO,SAASL,IAC3ClE,KAAKqK,OAASrG,EAAec,SAASZ,IACtClE,KAAKqK,OAASrG,EAAeW,MAAMT,IAGvC2D,EAAAvH,UAAAuM,WAAA,WACE,OAAO7M,KAAKqK,OAASrG,EAAec,SAASZ,IAG/C2D,EAAAvH,UAAAwN,oBAAA,WACE,MAAO,CAACC,YAAa,SAGvBlG,EAAAvH,UAAA8J,OAAA,WACE,OAAOpK,KAAKqK,OAASrG,EAAec,SAASZ,IAC3ClE,KAAKqK,OAASrG,EAAeW,MAAMT,IAG/B2D,EAAAvH,UAAAiK,eAAR,SAAuB3E,GACrB5F,KAAKgM,YAAcxG,EAASG,MAAMC,GAClC5F,KAAKiM,UAAY,IAAMjM,KAAK4F,SAASH,KAAO,IAAMzF,KAAK4F,SAASF,IAAM,KAAO1F,KAAKgM,YAAYvG,KAAO,IAAMzF,KAAKgM,YAAYtG,KAGtHmC,EAAAvH,UAAA6J,SAAR,SAAiBvE,GACf5F,KAAK0I,OAAOsF,KAAKpI,GACjB5F,KAAKqI,aAAezC,EAASH,KAAO,IAAMG,EAASF,IAAM,KAGnDmC,EAAAvH,UAAAkK,YAAR,eACQyD,EAAKjO,KAAK4F,SAASH,KAAOzF,KAAKgM,YAAYvG,KAC3CyI,EAAKlO,KAAK4F,SAASF,IAAM1F,KAAKgM,YAAYtG,IAChD,OAAOyH,KAAKgB,MAAMhB,KAAKiB,KAAKH,EAAKA,EAAKC,EAAKA,KAG7CrG,EAAAvH,UAAA+N,OAAA,WACE,MAAO,OAASC,OAAOC,SAAW,SAGpC1G,EAAAvH,UAAAkO,KAAA,WACE,OAAOxO,KAAK6M,aAAe,OAASyB,OAAOC,SAAW,UAAY,IAGpE1G,EAAAvH,UAAAmO,SAAA,WACE,OAAOzO,KAAKwK,cAAgB,GAG9B3C,EAAAvH,UAAAoO,OAAA,WACE,OAAO1O,KAAKqK,OAASrG,EAAeQ,WAAWN,IAAMlE,KAAKqK,OAASrG,EAAeS,UAAUP,IAG9F2D,EAAAvH,UAAAqO,cAAA,eACQC,EAAI5O,KAAKuI,WACTA,EAAaC,EAAAA,WAAWC,UAM9B,OALImG,IACFrG,EAAWsG,SAAWD,EAAEC,SACxBtG,EAAWuG,KAAOF,EAAEE,KACpBvG,EAAWwG,MAAQH,EAAEG,OAEhBxG,GAGTV,EAAAvH,UAAA0O,eAAA,SAAepE,GACb5K,KAAKuI,WAAWsG,SAAWjE,EAAOiE,SAClC7O,KAAKuI,WAAWuG,KAAOlE,EAAOkE,KAC9B9O,KAAKuI,WAAWwG,MAAQnE,EAAOmE,OAGjClH,EAAAvH,UAAA+G,OAAA,WACErH,KAAK+H,yBAAyBV,OAAO,IAAIT,EAAiB5G,KAAKkE,MAGjE2D,EAAAvH,UAAA2O,aAAA,eACQC,EAAYlP,KAAK0O,SAAW,IAAM,IACxC,OAAO1O,KAAKkI,UAAUpC,MAAQoJ,EAAY,EAAyC,IAApClP,KAAKkI,UAAUpC,MAAQoJ,IAGxErH,EAAAvH,UAAA6O,YAAA,WACE,OAAOC,EAAAA,SAASC,gBAGlBxH,EAAAvH,UAAAoH,WAAA,WACE1H,KAAKgI,0BAA0BtB,QAAQ,IAAIN,EAAkBpG,KAAKkE,MAG5D2D,EAAAvH,UAAAuI,aAAR,WAAA,IAAArI,EAAAR,MACMA,KAAK0O,UAAY1O,KAAKoM,sBACxBkD,YAAU,eACFC,EAAU5H,EAAE,SAAWnH,EAAK0D,IAC9BqL,GACFA,EAAQC,UAET,MAIP3H,EAAAvH,UAAAmP,eAAA,SAAeC,EAAUC,GACvB3P,KAAKkI,UAAUnC,OAAS,UAAY2J,EAAMC,EAASC,aAAe5P,KAAKuI,WAAWsG,SAAWc,EAASC,aACtG5P,KAAKkI,UAAUpC,MAAQ6J,EAASE,aAGlChI,EAAAvH,UAAAwP,SAAA,SAASlF,GACP5K,KAAK8H,yBAAyBb,aAAa,OAG7CY,EAAAvH,UAAAyP,kBAAA,eACQC,EAAiB,IAAI/J,EAoB3B,OAnBA+J,EAAe9L,GAAKlE,KAAKkE,GACzB8L,EAAe9J,KAAOlG,KAAKmI,UAC3B6H,EAAe7J,UAAY8J,SAAS1E,EAAAA,MAAM2E,MAAMlQ,KAAKuI,WAAWwG,OAAOrF,QAAQ,IAAK,IAAK,IACzFsG,EAAenB,SAAW7O,KAAKuI,WAAWsG,SAC1CmB,EAAelB,KAAO9O,KAAKuI,WAAWuG,KAClC9O,KAAKqK,OAASrG,EAAeK,MAAMH,IACrC8L,EAAevK,KAAOzF,KAAKuJ,QAAQ9D,KAAO,GAC1CuK,EAAetK,IAAM1F,KAAKuJ,QAAQ7D,IAAM,GACxCsK,EAAejK,OAAS,EACxBiK,EAAelK,MAAQ,IAEvBkK,EAAevK,KAAOzF,KAAKuJ,QAAQ9D,KACnCuK,EAAetK,IAAM1F,KAAKuJ,QAAQ7D,IAClCsK,EAAejK,OAAS/F,KAAKkI,UAAUnC,OACvCiK,EAAelK,MAAQ9F,KAAKkI,UAAUpC,OAExCkK,EAAeG,WAAanQ,KAAKmQ,WACjCH,EAAe3F,KAAOrK,KAAKqK,KAC3B2F,EAAe1H,QAAUtI,KAAKoQ,aACvBJ,GAGDnI,EAAAvH,UAAA8P,WAAR,mBACM9H,EAAU,IACd,GAAItI,KAAKqK,OAASrG,EAAeO,SAASL,GAAI,KACxCgG,EAAQ,EACRmG,EAAY,EAAGC,EAAY,MAC/B,IAAoB,IAAAzE,EAAAC,EAAA9L,KAAK0I,QAAMqD,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA5B,IAAMyK,EAAK8B,EAAArM,MACA,IAAVwK,GACF5B,GAAW2B,EAAMxE,KAAO,IAAMwE,EAAMvE,IAAM,IAC1CwE,EAAQ,GAIR5B,IAFA+H,EAAYpG,EAAMxE,KAAO4K,GAEF,KADvBC,EAAYrG,EAAMvE,IAAM4K,GACiB,IAE3CD,EAAYpG,EAAMxE,KAClB6K,EAAYrG,EAAMvE,4GAEX1F,KAAKqK,OAASrG,EAAec,SAASZ,IAAMlE,KAAKqK,OAASrG,EAAeW,MAAMT,IACxFoE,GAAWtI,KAAK4F,SAASH,KAAO,IAAMzF,KAAK4F,SAASF,IAAM,IAC1D4C,GAAWtI,KAAKgM,YAAYvG,KAAO,IAAMzF,KAAKgM,YAAYtG,IAAM,KAEhE4C,EAAU,GAEZ,OAAOA,GAGDT,EAAAvH,UAAAiM,OAAR,SAAe3G,GACb,OAAOA,EAASH,MAAQzF,KAAKiL,WAAarF,EAASF,KAAO1F,KAAKgL,YAC7DpF,EAASH,MAAQ,GAAKG,EAASF,KAAO,uBA9c3C6K,EAAAA,UAAS7O,KAAA,CAAC,CACT8O,SAAU,gBACVC,SAAA,s4IAVM5J,SAEAM,SACAG,KAqdRO,EAhdA,OCYMF,EAAIC,EAEV8I,EAAA,WAyDE,SAAAA,EAAoBC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAlJ,EACAC,EACAC,EACRiJ,EACAC,EACAC,EACQC,GAZpB,IAAA5Q,EAAAR,KAAoBA,KAAA2Q,mBAAAA,EACA3Q,KAAA4Q,cAAAA,EACA5Q,KAAA6Q,iBAAAA,EACA7Q,KAAA8Q,qBAAAA,EACA9Q,KAAA+Q,0BAAAA,EACA/Q,KAAAgR,4BAAAA,EACAhR,KAAA8H,yBAAAA,EACA9H,KAAA+H,yBAAAA,EACA/H,KAAAgI,0BAAAA,EAIAhI,KAAAoR,eAAAA,EA/DpBpR,KAAAqR,MAAQ,aACRrR,KAAAsR,MAAqB,GAIrBtR,KAAAuR,iBAAmBC,EAAAA,aAAaC,YAChCzR,KAAA0R,gBAAkB1R,KAAKwC,KAEvBxC,KAAA2R,gBAAkB,CAChB3N,EAAeG,KACfH,EAAeM,eACfN,EAAea,eACfb,EAAeU,iBACfV,EAAeY,eACfZ,EAAeO,SACfP,EAAeW,MACfX,EAAec,SACfd,EAAeI,KACfJ,EAAeQ,WACfR,EAAeS,UACfT,EAAeK,OAGjBrE,KAAA4R,oBAAsB,CACpB5N,EAAeG,KACfH,EAAea,eACfb,EAAeY,eACfZ,EAAeU,iBACfV,EAAeM,gBAEjBtE,KAAA6R,qBAAuB,CACrB7N,EAAeO,SACfP,EAAeW,MACfX,EAAec,SACfd,EAAeI,KACfJ,EAAeK,OAEjBrE,KAAA8R,oBAAsB,CACpB9N,EAAeQ,WACfR,EAAeS,WAEjBzE,KAAA+R,WAAa,EAEb/R,KAAAgS,SAAW,IAAIC,IAGPjS,KAAAkS,gBAAiB,EACjBlS,KAAAmS,YAAc,IAAIF,IAkBxBjS,KAAK8H,yBAAyBa,aAAaC,WAAS,SAAE1E,GAChD1D,EAAK4R,qBAAuBlO,IAC9B1D,EAAK6R,gBAAkB,KACvB7R,EAAK4R,mBAAqBlO,MAI9BlE,KAAKgI,0BAA0BsK,kBAAkB1J,WAAS,SAAE0J,GAC1D9R,EAAK6R,gBAAkBC,EAAkBpO,GACpC1D,EAAKwR,SAAShR,IAAIR,EAAK6R,kBAC1B7R,EAAKwR,SAASO,IAAI/R,EAAK6R,gBAAiB,OAI5CrS,KAAKgI,0BAA0BwK,kBAAkB5J,WAAS,SAAElC,GAC1DlG,EAAKwR,SAAShR,IAAIR,EAAK6R,iBAAiBrE,KAAKtH,MAG/C1G,KAAK+H,yBAAyB0K,iBAAiB7J,WAAS,SAAE6J,OAClDC,EAAelS,EAAK2R,YAAYnR,IAAIyR,EAAiBvO,IACvDwO,GACFA,EAAaC,UAEfnS,EAAK2R,YAAYS,OAAOH,EAAiBvO,IACrC1D,EAAK6R,kBAAoBI,EAAiBvO,KAC5C1D,EAAK6R,gBAAkB,MAEzB7R,EAAKwR,SAASY,OAAOH,EAAiBvO,OAGxC+M,EAAmB4B,cAAcjK,WAAS,SAAEkK,GAC1C,GAAIA,EAAS,KACPxT,OAAC,EACL,IAAKA,EAAI,EAAGA,EAAIwT,EAAQrT,OAAQH,IAC9BkB,EAAKmQ,mBAAmBpO,OAAOuQ,EAAQC,KAAKzT,GAAI,GAAIkB,EAAKwS,eAAepK,WAAS,SAAEqK,GACjFzS,EAAK0R,eAAiB1R,EAAK0S,WAAWD,EAAI9P,KAAM,GAAI,IAAM3C,EAAK2S,UAAU,WAMjFjC,EAAmBkC,aAAaxK,WAAS,SAAE3F,GACzC,GAAoC,IAAhCzC,EAAK6S,uBACP,IAAK,IAAI/T,EAAI2D,EAAM3D,EAAI2D,EAAO,EAAG3D,IAC3BA,EAAI,GAAKA,GAAKkB,EAAKuR,aAAevR,EAAKgC,KAAK8Q,MAAMhU,EAAI,GAAGoE,MAC3DlD,EAAK+S,aAAajU,EAAGA,MAM7B6R,EAAgBqC,WAAW5K,WAAS,SAAE6K,GACpCjT,EAAK0S,WAAW1S,EAAK6B,YAAYc,KAAMsQ,EAAMjC,EAAAA,aAAakC,qBAG5D1T,KAAK2T,UAAYvC,EAAeuC,YAChCvC,EAAewC,SAAShL,WAAS,SAAEiL,GACjCrT,EAAKmT,UAAYvC,EAAeuC,eAyYtC,OArYEjD,EAAApQ,UAAAwT,YAAA,WACE,OAAO9T,KAAKgS,SAAShR,IAAIhB,KAAKqS,kBAGhC1T,OAAA0B,eAAIqQ,EAAApQ,UAAA,gBAAa,KAAjB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBqB,yCAGvD/D,OAAA0B,eAAIqQ,EAAApQ,UAAA,aAAU,KAAd,WACE,QAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB0S,sCAGvDpV,OAAA0B,eAAIqQ,EAAApQ,UAAA,qBAAkB,KAAtB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB2S,8CAGvDrV,OAAA0B,eAAIqQ,EAAApQ,UAAA,yBAAsB,KAA1B,WACE,OAAON,KAAKqB,iBAAmBrB,KAAKqB,iBAAiB4S,iBAAmB,mCAG1EtV,OAAA0B,eAAIqQ,EAAApQ,UAAA,iBAAc,KAAlB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB6S,0CAGvDvV,OAAA0B,eAAIqQ,EAAApQ,UAAA,yBAAsB,KAA1B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB8S,kDAGvDxV,OAAA0B,eAAIqQ,EAAApQ,UAAA,0BAAuB,KAA3B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB+S,mDAGvDzV,OAAA0B,eAAIqQ,EAAApQ,UAAA,eAAY,KAAhB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBkB,wCAG/CmO,EAAApQ,UAAA+T,sBAAR,WACE,OAAOrU,KAAKqB,iBAAmBrB,KAAKqB,iBAAiBiT,gBAAkB,IAGzE3V,OAAA0B,eAAIqQ,EAAApQ,UAAA,cAAW,KAAf,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBoC,uCAGvD9E,OAAA0B,eAAIqQ,EAAApQ,UAAA,eAAY,KAAhB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBkT,wCAGvD5V,OAAA0B,eAAIqQ,EAAApQ,UAAA,iBAAc,KAAlB,WACE,OAAO,mCAGT3B,OAAA0B,eAAIqQ,EAAApQ,UAAA,yBAAsB,KAA1B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBmT,kDAGvD7V,OAAA0B,eAAIqQ,EAAApQ,UAAA,uBAAoB,KAAxB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBoT,gDAGvD9V,OAAA0B,eAAIqQ,EAAApQ,UAAA,uBAAoB,KAAxB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBqT,gDAGvD/V,OAAA0B,eAAIqQ,EAAApQ,UAAA,wBAAqB,KAAzB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBsT,iDAGvDhW,OAAA0B,eAAIqQ,EAAApQ,UAAA,gCAA6B,KAAjC,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBuT,yDAGvDjW,OAAA0B,eAAIqQ,EAAApQ,UAAA,2BAAwB,KAA5B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiBwT,oDAGvDlW,OAAA0B,eAAIqQ,EAAApQ,UAAA,4BAAyB,KAA7B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiByT,qDAGvDnW,OAAA0B,eAAIqQ,EAAApQ,UAAA,4BAAyB,KAA7B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB0T,qDAGvDpW,OAAA0B,eAAIqQ,EAAApQ,UAAA,kCAA+B,KAAnC,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB2T,2DAGvDrW,OAAA0B,eAAIqQ,EAAApQ,UAAA,wBAAqB,KAAzB,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB4T,iDAGvDtW,OAAA0B,eAAIqQ,EAAApQ,UAAA,gCAA6B,KAAjC,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB6T,yDAGvDvW,OAAA0B,eAAIqQ,EAAApQ,UAAA,gCAA6B,KAAjC,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB8T,yDAGvDxW,OAAA0B,eAAIqQ,EAAApQ,UAAA,2BAAwB,KAA5B,WACE,OAAON,KAAKqB,kBAAmBrB,KAAKqB,iBAAiB+T,oDAGvD1E,EAAApQ,UAAAgJ,SAAA,aAGAoH,EAAApQ,UAAA+U,UAAA,SAAUnR,GACRlE,KAAK4Q,cAAc0E,KAAKpR,IAG1BwM,EAAApQ,UAAAiV,WAAA,SAAWrR,GACTlE,KAAK4Q,cAAc4E,MAAMtR,IAG3BwM,EAAApQ,UAAA6S,UAAA,SAAUvI,GAAV,IAAApK,EAAAR,KACEA,KAAK2Q,mBAAmB5O,UAAU6I,GAAQhC,WAAS,SAAE0I,GAAuB,OAAA9Q,EAAK8Q,MAAQA,GAAS,OAGpGZ,EAAApQ,UAAA4S,WAAA,SAAWtI,EAAgBxH,EAAkBqS,GAA7C,IAAAjV,EAAAR,KACEA,KAAKqC,YAAc,IAAIqT,EAAAA,gBAAgB9K,EAAQxH,GAC/CpD,KAAKwC,KAAO,KACZxC,KAAKqS,gBAAkB,KACvBrS,KAAK2Q,mBAAmBvO,SAASpC,KAAKqC,aAAauG,WAAS,SAAEpG,GAI1D,GAHAhC,EAAKmV,mBACLnV,EAAKgC,KAAOA,EACZhC,EAAKkR,gBAAkBlR,EAAKgC,KACxBA,EAAM,KACFyR,EAAmBzT,EAAK6S,uBACxBtB,EAAavP,EAAK8Q,MAAQ9Q,EAAK8Q,MAAM7T,OAAS,EAChDwU,EAAmB,EACrBzT,EAAK+S,aAAa,EAAGU,EAAmBlC,EAAaA,EAAakC,GAElE3E,YAAU,uBACR,IAAmB,IAAAzD,EAAAC,EAAAtL,EAAKgC,KAAK8Q,OAAKvH,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA/B,IAAMyD,EAAI8I,EAAArM,MACbc,EAAKoV,kBAAkB3S,EAAKkP,YAAclP,EAAKkP,YAAc,yGAE9D,KAEL3R,EAAKqQ,iBAAiBkB,WAAaA,EACnCvR,EAAKqQ,iBAAiB9H,YAAc,EACpCvI,EAAKuR,WAAaA,MAIpB0D,GACFzV,KAAK4Q,cAAc4E,MAAMC,GAE3BzV,KAAK6V,aAGPnF,EAAApQ,UAAAiT,aAAA,SAAauC,EAAexL,GAC1B,IADF,IAAA9J,EAAAR,gBACWV,GACPyW,EAAKpF,mBAAmB3N,SAAS+S,EAAK1T,YAAa/C,GAAGsJ,WAAS,SAAE3F,GAC/DzC,EAAKgC,KAAK8Q,MAAMhU,EAAI,GAAK2D,EACzBzC,EAAKoV,kBAAkB3S,EAAKkP,YAAclP,EAAKkP,YAAc,eAHxD7S,EAAIwW,EAAOxW,GAAKgL,EAAKhL,MAArBA,IAQHoR,EAAApQ,UAAAsV,kBAAR,SAA0BzD,eACxB,IAAyB,IAAA6D,EAAAlK,EAAAqG,GAAW8D,EAAAD,EAAAxW,QAAAyW,EAAAtW,KAAAsW,EAAAD,EAAAxW,OAAE,CAAjC,IAAM0W,EAAUD,EAAAvW,MACbkG,EAAW,IAAIJ,EAAS0Q,EAAWzQ,KAAMyQ,EAAWxQ,KACpDxB,EAAKlE,KAAKmW,uBAAuBD,EAAW/F,WAAYvK,EAAUsQ,GACxElW,KAAKgS,SAASO,IAAIrO,EAAIgS,EAAWlE,UACjChS,KAAK8H,yBAAyBb,aAAa/C,uGAI/CwM,EAAApQ,UAAAiC,OAAA,SAAOqI,GAAP,IAAApK,EAAAR,KACEA,KAAK2Q,mBAAmBpO,OAAO,KAAMqI,EAAQ5K,KAAKgT,eAAepK,WAAS,WACxEpI,EAAK2S,UAAU,QAInBzC,EAAApQ,UAAA8V,aAAA,SAAaxL,GACX,OAAO5K,KAAKqW,wBAGd3F,EAAApQ,UAAAgW,aAAA,WACMtW,KAAK0R,gBAETpD,OAAOC,SAASgI,OAAOvW,KAAK2Q,mBAAmBtN,eAAerD,KAAKqC,eAGrEqO,EAAApQ,UAAAiD,SAAA,WAAA,QAAA/C,EAAAR,KACQwD,EAAkB,OACxB,IAAyB,IAAAqI,EAAAC,EAAA9L,KAAKmS,YAAYqE,UAAQzK,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA/C,IACGwQ,EADajE,EAAArM,MAC6C,SAAEqQ,oBAClEC,EAAegC,SAAWhS,KAAKgS,SAAShR,IAAIgP,EAAe9L,IAC3DV,EAAgBwK,KAAKgC,qGAEvBhQ,KAAK2Q,mBAAmBpN,SAASvD,KAAKqC,YAAamB,GAAiB,GAAOoF,WAAS,SAAEjC,GACpFnG,EAAKoQ,cAAc0E,KAAK9D,EAAAA,aAAaiF,kBACrCjW,EAAK0S,WAAWvM,EAAIxD,KAAM,KAAMqO,EAAAA,aAAaiF,sBAIjD/F,EAAApQ,UAAAoW,UAAA,SAAUxS,OACFyS,GAAa3W,KAAKwC,MAASxC,KAAKwC,MAAQxC,KAAKwC,KAAKoU,sBACtD5W,KAAKwC,KAAKoU,qBAAqB/S,MAAI,SAAWnE,GAC9C,OAAOwE,IAAOxE,KAEhB,OAAOM,KAAK6W,wBAAwB3S,IAAOyS,GAG7CjG,EAAApQ,UAAAwW,UAAA,SAAUlM,GACR5K,KAAK+W,oBAAsBnM,GAG7B8F,EAAApQ,UAAA0W,iBAAA,WACE,OAAOhX,KAAKiX,YAAYjX,KAAK4R,sBAG/BlB,EAAApQ,UAAA4W,kBAAA,WACE,OAAOlX,KAAKiX,YAAYjX,KAAK6R,uBAGvBnB,EAAApQ,UAAA2W,YAAR,SAAoBE,eAClB,IAA6B,IAAAC,EAAAtL,EAAAqL,GAAcE,EAAAD,EAAA5X,QAAA6X,EAAA1X,KAAA0X,EAAAD,EAAA5X,OAAE,CAAxC,IAAM8X,EAAcD,EAAA3X,MACvB,GAAIM,KAAK6W,wBAAwBS,EAAepT,IAC9C,OAAO,oGAGX,OAAO,GAGTwM,EAAApQ,UAAAiX,iBAAA,WACE,OAAOvX,KAAK6W,wBAAwB7S,EAAeQ,WAAWN,KAAOlE,KAAK6W,wBAAwB7S,EAAeS,UAAUP,KAGrHwM,EAAApQ,UAAAuW,wBAAR,SAAgC3S,GAC9B,OAAQA,GACN,KAAKF,EAAeG,KAAKD,GACvB,OAAOlE,KAAKwX,qBACd,KAAKxT,EAAeI,KAAKF,GACvB,OAAOlE,KAAKyX,qBACd,KAAKzT,EAAeK,MAAMH,GACxB,OAAOlE,KAAK0X,sBACd,KAAK1T,EAAeM,eAAeJ,GACjC,OAAOlE,KAAK2X,8BACd,KAAK3T,EAAeO,SAASL,GAC3B,OAAOlE,KAAK4X,yBACd,KAAK5T,EAAeQ,WAAWN,GAC7B,OAAOlE,KAAK6X,0BACd,KAAK7T,EAAeS,UAAUP,GAC5B,OAAOlE,KAAK8X,0BACd,KAAK9T,EAAeU,iBAAiBR,GACnC,OAAOlE,KAAK+X,gCACd,KAAK/T,EAAeW,MAAMT,GACxB,OAAOlE,KAAKgY,sBACd,KAAKhU,EAAeY,eAAeV,GACjC,OAAOlE,KAAKiY,8BACd,KAAKjU,EAAea,eAAeX,GACjC,OAAOlE,KAAKkY,8BACd,KAAKlU,EAAec,SAASZ,GAC3B,OAAOlE,KAAKmY,2BAIlBzH,EAAApQ,UAAA8X,YAAA,SAAYxN,GACV5K,KAAKkS,eAAiBtH,GAGhB8F,EAAApQ,UAAAqV,iBAAR,uBACE,IAA2B,IAAA9J,EAAAC,EAAA9L,KAAKmS,YAAYqE,UAAQzK,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAA/BuM,EAAArM,MACRiT,4GAEf3S,KAAKmS,YAAc,IAAIF,IACvBjS,KAAKgS,SAAW,IAAIC,KAGdvB,EAAApQ,UAAAuV,UAAR,mBACE,GAAK7V,KAAKwC,MAASxC,KAAKwC,KAAK8Q,UAG7B,IAAmB,IAAAzH,EAAAC,EAAA9L,KAAKwC,KAAK8Q,OAAKvH,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAArBuM,EAAArM,MACRgE,KAAO,yGAIhBgN,EAAApQ,UAAA+X,iBAAA,SAAiBzN,GAGf,GAFAA,EAAOO,iBAEHnL,KAAK+W,oBAAqB,KACtBnR,EAAW2F,EAAAA,MAAMC,iBAAiBZ,GAGlC7B,EADWC,SAASsP,kBAAkB1S,EAASsD,EAAGtD,EAASuD,GACpCtF,MAAI,SAACqF,GAAK,OAAAA,EAAEhF,IAAMgF,EAAEhF,GAAGqU,WAAW,YAC/D,GAAIxP,EAAa,KACTyP,EAAe7Q,EAAEoB,GAAaK,SAASA,SAAS,GAChDmE,EAAkBvN,KAAKyY,mBAAmB7S,EAAU+B,EAAE6Q,IACtDE,EAAS3P,EAAY7E,GACvBiM,EAAa,EACjB,GAAIuI,EAAQ,KACJ/O,EAAQ+O,EAAO/O,MAAM,KAC3BwG,EAA8B,IAAjBxG,EAAMlK,OAAewQ,SAAStG,EAAM,GAAI,IAAMwG,MAEvDjM,EAAKlE,KAAKmW,uBAAuBhG,EAAY5C,EAAiB,MACpEvN,KAAK8H,yBAAyBb,aAAa/C,GAC3ClE,KAAK2Y,qBAAuBzU,EAC5BlE,KAAK8Q,qBAAqB8H,gBAAgB,SAKxClI,EAAApQ,UAAA6V,uBAAR,SAA+BhG,EAAoB5C,EAA2B7J,OACtEmV,EAAmB7Y,KAAK+Q,0BAA0BlN,KAAKsM,GAC7D,GAAI0I,EAAkB,KACdC,EAAmBD,EAAiBC,iBACpCC,EAAsB/Y,KAAKgR,4BAA4BgI,oBAAoBF,EAAkBjR,GAC7F3D,EAAKlE,KAAKiZ,YAIhB,GAHsBF,EAA4B,SAAE7U,GAAKA,EACnC6U,EAA4B,SAAEnT,SAAW2H,EACzCwL,EAA4B,SAAE5I,WAAaA,EAC7DzM,EAAM,KACFwE,EAAY,IAAIrC,EAAUnC,EAAKoC,MAAOpC,EAAKqC,QAC3CsE,EAAOrG,EAAeC,kBAAkBP,EAAK2G,MAC7C9B,EAAaC,EAAAA,WAAWC,UAC9BF,EAAWsG,SAAWnL,EAAKmL,SACvBnL,EAAKyC,YACPoC,EAAWwG,MAAQ,IAAMrL,EAAKyC,UAAU+S,SAAS,KAEnD3Q,EAAWuG,KAAOpL,EAAKoL,KACDiK,EAA4B,SAAE1O,KAAOA,EAAOA,EAAKnG,GAAKR,EAAK2G,KAC3D0O,EAA4B,SAAE7Q,UAAYA,EAC1C6Q,EAA4B,SAAEzQ,QAAU5E,EAAK4E,QAC7CyQ,EAA4B,SAAE5Q,UAAYzE,EAAKwC,KACjEqC,GACoBwQ,EAA4B,SAAE/J,eAAezG,QAG/CwQ,EAA4B,SAAE1O,KAAOrK,KAAK+W,wBAE5DoC,EAAYnZ,KAAKwC,KAAK8Q,MAAMzP,MAAI,SAAW9E,GAC/C,OAAOA,EAAEqa,SAAWjJ,KAKtB,OAHsB4I,EAA4B,SAAE9N,UAAYkO,EAAUrT,MACpDiT,EAA4B,SAAE/N,WAAamO,EAAUpT,OAC3E/F,KAAKmS,YAAYI,IAAIrO,EAAI6U,GAClB7U,EAET,OAAO,MAGTwM,EAAApQ,UAAA+Y,2BAAA,SAA2BzO,GAGzB,GAFAA,EAAOO,iBAEHnL,KAAK2Y,qBAAsB,KACvB/S,EAAW2F,EAAAA,MAAMC,iBAAiBZ,GAClCmO,EAAsB/Y,KAAKmS,YAAYnR,IAAIhB,KAAK2Y,sBAChDtO,EAA6B0O,EAA4B,SAAE1O,KAC3D8F,EAAmC4I,EAA4B,SAAE5I,WACjE5C,EAAkBvN,KAAKyY,mBAAmB7S,EAAU+B,EAAE,SAAWwI,IACnE9F,IAASrG,EAAeO,SAASL,IAAMmG,IAASrG,EAAec,SAASZ,IAAMmG,IAASrG,EAAeW,MAAMT,GACxF6U,EAA4B,SAAEzM,KAAKiB,GAChDlD,IAASrG,EAAeK,MAAMH,IACjB6U,EAA4B,SAAEzL,eAAeC,KAKjEmD,EAAApQ,UAAAmY,mBAAR,SAA2B7S,EAAU3C,OAC7BwC,EAAOG,EAASsD,EAAIjG,EAAKqW,SAAS7T,KAClCC,EAAME,EAASuD,EAAIlG,EAAKqW,SAAS5T,IACvC,OAAO,IAAIF,EAASC,EAAMC,IAG5BgL,EAAApQ,UAAAiZ,yBAAA,SAAyB3O,GACnB5K,KAAK2Y,uBACP3Y,KAAK8H,yBAAyBb,aAAajH,KAAK2Y,sBAChD3Y,KAAK2Y,qBAAuB,OAIhCjI,EAAApQ,UAAAkZ,cAAA,WACExZ,KAAKqS,gBAAkB,MAGjB3B,EAAApQ,UAAA2Y,UAAR,mBACMQ,EAAQ,MACZ,IAAoB,IAAA5N,EAAAC,EAAA9L,KAAKmS,YAAYuH,QAAM3N,EAAAF,EAAArM,QAAAuM,EAAApM,KAAAoM,EAAAF,EAAArM,OAAE,CAAxC,IAAM0H,EAAK6E,EAAArM,MACVwH,EAAQuS,IACVA,EAAQvS,qGAIZ,OADWuS,EAAQ,uBAtgBtBlJ,EAAAA,UAAS7O,KAAA,CAAC,CACT8O,SAAU,oBACVC,SAAA,o5LA/BM3O,SAON6X,EAAAA,oBACAC,EAAAA,uBACAC,EAAAA,8BAHAC,EAAAA,sCAJAC,EAAAA,kCAoBMlT,SAEAM,SACAG,SAhBkB0S,EAAAA,0BADPC,EAAAA,0BAAoBC,EAAAA,uBAGrCC,EAAAA,iBA2hBFzJ,EAzgBA,GC/BA,IAAA0J,EAAA,WAiBE,SAAAA,EAAoBpS,GAAAhI,KAAAgI,0BAAAA,EAJVhI,KAAAwZ,cAAgB,IAAIa,EAAAA,aA0BhC,OAnBED,EAAA9Z,UAAAgJ,SAAA,aAGA8Q,EAAA9Z,UAAAga,WAAA,WACEta,KAAKwZ,cAAce,MAAK,IAG1BH,EAAA9Z,UAAAka,WAAA,WACExa,KAAKya,eAAiB,IAAIpU,EAAQrG,KAAK0a,eAGzCN,EAAA9Z,UAAAqa,aAAA,WACE3a,KAAKya,eAAiB,MAGxBL,EAAA9Z,UAAAoH,WAAA,WACE1H,KAAKgI,0BAA0BN,WAAWrB,EAAQhB,OAAOrF,KAAKya,iBAC9Dza,KAAKya,eAAiB,0BAjCzBlK,EAAAA,UAAS7O,KAAA,CAAC,CACT8O,SAAU,mBACVC,SAAA,2kFALMnJ,uCASLsT,EAAAA,4BACAA,EAAAA,6BAEAC,EAAAA,UA0BHT,EAvCA,GCAA,IAAAU,EAAA,WAYE,SAAAA,KAsBF,OAnBEA,EAAAxa,UAAAgJ,SAAA,aAGAwR,EAAAxa,UAAAya,QAAA,eACQzU,EAAOC,KAAKC,MAAQxG,KAAK0G,QAAQJ,KACjC0U,EAAQ7N,KAAKgB,MAAM7H,EAAI,MAC7B,GAAI0U,EAAQ,EACV,MAAO,SAAWA,EAAQ,iBAEtB5N,EAAMD,KAAKgB,MAAM7H,EAAI,KAC3B,GAAI8G,EAAM,EACR,MAAO,SAAWA,EAAM,mBAEpB6N,EAAM9N,KAAKgB,MAAM7H,EAAO,KAC9B,OAAI2U,EAAM,EACD,SAAWA,EAAM,eAEnBjb,KAAK0G,QAAQJ,0BA7BvBiK,EAAAA,UAAS7O,KAAA,CAAC,CACT8O,SAAU,aACVC,SAAA,o2BAKCmK,EAAAA,SAwBHE,EAlCA,OCIMnT,EAAIC,EAEVsT,EAAA,WAWE,SAAAA,IAHUlb,KAAA0H,WAAa,IAAI2S,EAAAA,aACjBra,KAAAmb,cAAgB,IAAId,EAAAA,aA6BhC,OAxBEa,EAAA5a,UAAAgJ,SAAA,WACEgG,YAAU,eACFC,EAAU5H,EAAE,SACd4H,GACFA,EAAQC,UAET,MAGL0L,EAAA5a,UAAA8a,aAAA,WACEpb,KAAK0H,WAAW6S,KAAKva,KAAK0G,UAG5BwU,EAAA5a,UAAAqa,aAAA,WACE3a,KAAKmb,cAAcZ,MAAK,IAG1BW,EAAA5a,UAAA+L,SAAA,SAAS3M,GACPM,KAAK0G,QAAQR,KAAOxG,GAGtBwb,EAAA5a,UAAA+a,SAAA,SAAS3b,GACPM,KAAK0G,QAAQD,SAAW/G,uBApC3B6Q,EAAAA,UAAS7O,KAAA,CAAC,CACT8O,SAAU,oBACVC,SAAA,wmDAICmK,EAAAA,0BAEAC,EAAAA,8BACAA,EAAAA,UA6BHK,EAtCA,GCkBA,SAAgBI,EAAcC,GAE5B,OADY,WAAS,OAAAA,EAAwBhb,QAM/C,SAAgBib,EAAwBC,GACtC,OAAO,IAAIC,EAAAA,8BAA8BD,GAG3C,IAAAE,EAAA,WAuCE,SAAAA,IACEC,EAAAA,QAAQC,IAAIC,EAAAA,IAAKC,EAAAA,KASrB,OANSJ,EAAAK,QAAP,SAAeC,GAEb,OADAnb,EAAAA,IAAIob,qBAAuBD,EACpB,CACLE,SAAUR,wBA9CfS,EAAAA,SAAQ1a,KAAA,CAAC,CACR2a,aAAc,CAAC3L,EAAwB7I,EAAqBuS,EAAuBU,EAAkBI,GAErGoB,QAAS,CAACC,EAAAA,uBAAwB7L,EAAwB7I,EAAqBuS,EAAuBU,EAAkBI,GACxHsB,QACE,CAACC,EAAAA,aACCF,EAAAA,uBACAG,EAAAA,iBACAC,EAAAA,kBACAC,EAAAA,oBACJC,UACE,CACEhb,EAAAA,cACAhC,EACAgH,EACAM,EACAG,EACA,CACEwV,QAASC,EAAAA,kBACTC,SAAUC,EAAAA,wBACVC,OAAO,GAET,CACEJ,QAASK,EAAAA,gBACTC,WAAY9B,EACZ+B,KAAM,CAACxd,GAA0Bqd,OAAO,GAE1CI,EAAAA,mBACA,CACER,QAASC,EAAAA,kBACTK,WAAY5B,EACZ0B,OAAO,EACPG,KAAM,CAACC,EAAAA,sBAGbC,gBAAiB,CAAC1V,6CAcpB8T,EAjDA","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export class AnnotationConfig {\n  rewrite: boolean;\n  pageSelector: boolean;\n  download: boolean;\n  upload: boolean;\n  print: boolean;\n  browse: boolean;\n  enableRightClick: boolean;\n\n  filesDirectory: string;\n  fontsDirectory: string;\n  defaultDocument: string;\n  preloadPageCount: 0;\n\n  textAnnotation: boolean;\n  areaAnnotation: boolean;\n  pointAnnotation: boolean;\n  textStrikeoutAnnotation: boolean;\n  polylineAnnotation: boolean;\n  textFieldAnnotation: boolean;\n  watermarkAnnotation: boolean;\n  textReplacementAnnotation: boolean;\n  arrowAnnotation: boolean;\n  textRedactionAnnotation: boolean;\n  textUnderlineAnnotation: boolean;\n  distanceAnnotation: boolean;\n  downloadOriginal: boolean;\n  downloadAnnotated: boolean;\n\n  zoom: boolean;\n  fitWidth: boolean;\n}\n","import {Injectable} from '@angular/core';\nimport {BehaviorSubject, Observable} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {Api, ConfigService} from \"@groupdocs.examples.angular/common-components\";\nimport {AnnotationConfig} from \"./annotation-config\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AnnotationConfigService {\n\n  private _annotationConfig: BehaviorSubject<AnnotationConfig> = new BehaviorSubject(new AnnotationConfig());\n  private _updatedConfig: Observable<AnnotationConfig> = this._annotationConfig.asObservable();\n\n  constructor(private _http: HttpClient, private _config: ConfigService) {\n  }\n\n  get updatedConfig() {\n    return this._updatedConfig;\n  }\n\n  load() {\n    return new Promise<void>((resolve, reject) => {\n      const configEndpoint = this._config.getConfigEndpoint(Api.ANNOTATION_APP);\n      this._http.get(configEndpoint, Api.httpOptionsJson).toPromise().then((response: AnnotationConfig) => {\n        const annotationConfig = <AnnotationConfig>response;\n        this._annotationConfig.next(annotationConfig);\n        resolve();\n      }).catch((response: any) => {\n        reject(`Could not load annotation config: ${JSON.stringify(response)}`);\n      });\n    });\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {HttpClient} from \"@angular/common/http\";\nimport {Api, ConfigService, FileCredentials, FileUtil} from \"@groupdocs.examples.angular/common-components\";\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AnnotationService {\n\n  constructor(private _http: HttpClient, private _config: ConfigService) {\n  }\n\n  loadFiles(path: string) {\n    return this._http.post(this._config.getAnnotationApiEndpoint() + Api.LOAD_FILE_TREE, {'path': path}, Api.httpOptionsJson);\n  }\n\n  loadFile(credentials: FileCredentials) {\n    return this._http.post(this._config.getAnnotationApiEndpoint() + Api.LOAD_DOCUMENT_DESCRIPTION, credentials, Api.httpOptionsJson);\n  }\n\n  upload(file: File, url: string, rewrite: boolean) {\n    const formData = new FormData();\n    formData.append(\"file\", file);\n    formData.append('rewrite', String(rewrite));\n    if (url) {\n      formData.append(\"url\", url);\n    }\n\n    return this._http.post(this._config.getAnnotationApiEndpoint() + Api.UPLOAD_DOCUMENTS, formData);\n  }\n\n  loadPage(credentials: FileCredentials, page: number) {\n    return this._http.post(this._config.getAnnotationApiEndpoint() + Api.LOAD_DOCUMENT_PAGE, {\n      'guid': credentials.guid,\n      'password': credentials.password,\n      'page': page\n    }, Api.httpOptionsJson);\n  }\n\n  getDownloadUrl(credentials: FileCredentials) {\n    return this._config.getAnnotationApiEndpoint() + Api.DOWNLOAD_DOCUMENTS + '/?path=' + credentials.guid;\n  }\n\n  annotate(credentials: FileCredentials, annotationsData: any, print: boolean) {\n    const data = {\n      'guid': credentials.guid,\n      'password': credentials.password,\n      'annotationsData': annotationsData,\n      'documentType': FileUtil.find(credentials.guid, false).format,\n      'print': print\n    };\n    return this._http.post(this._config.getAnnotationApiEndpoint() + Api.ANNOTATE, data, Api.httpOptionsJson);\n  }\n}\n","import {PageModel} from \"@groupdocs.examples.angular/common-components\";\n\nexport class AnnotationType {\n  public static TEXT = {id: 'text', name: 'Text', icon: 'highlighter'};\n  public static AREA = {id: 'area', name: 'Area', icon: 'vector-square'};\n  public static POINT = {id: 'point', name: 'Point', icon: 'thumbtack'};\n  public static TEXT_STRIKEOUT = {id: 'textStrikeout', name: 'Text strikeout', icon: 'strikethrough',};\n  public static POLYLINE = {id: 'polyline', name: 'Polyline', icon: 'signature'};\n  public static TEXT_FIELD = {id: 'textField', name: 'Text field', icon: 'i-cursor'};\n  public static WATERMARK = {id: 'watermark', name: 'Watermark', icon: 'tint'};\n  public static TEXT_REPLACEMENT = {id: 'textReplacement', name: 'Text replacement', icon: 'edit'};\n  public static ARROW = {id: 'arrow', name: 'Arrow', icon: 'mouse-pointer'};\n  public static TEXT_REDACTION = {id: 'textRedaction', name: 'Text redaction', icon: 'brush'};\n  public static TEXT_UNDERLINE = {id: 'textUnderline', name: 'Text underline', icon: 'underline'};\n  public static DISTANCE = {id: 'distance', name: 'Distance', icon: 'ruler'};\n\n  public static getAnnotationType(id: string) {\n    switch (id) {\n      case AnnotationType.TEXT.id:\n        return AnnotationType.TEXT;\n      case AnnotationType.AREA.id:\n        return AnnotationType.AREA;\n      case AnnotationType.POINT.id:\n        return AnnotationType.POINT;\n      case AnnotationType.TEXT_STRIKEOUT.id:\n        return AnnotationType.TEXT_STRIKEOUT;\n      case AnnotationType.POLYLINE.id:\n        return AnnotationType.POLYLINE;\n      case AnnotationType.TEXT_FIELD.id:\n        return AnnotationType.TEXT_FIELD;\n      case AnnotationType.WATERMARK.id:\n        return AnnotationType.WATERMARK;\n      case AnnotationType.TEXT_REPLACEMENT.id:\n        return AnnotationType.TEXT_REPLACEMENT;\n      case AnnotationType.ARROW.id:\n        return AnnotationType.ARROW;\n      case AnnotationType.TEXT_REDACTION.id:\n        return AnnotationType.TEXT_REDACTION;\n      case AnnotationType.TEXT_UNDERLINE.id:\n        return AnnotationType.TEXT_UNDERLINE;\n      case AnnotationType.DISTANCE.id:\n        return AnnotationType.DISTANCE;\n    }\n  }\n}\n\nexport class FileAnnotationDescription {\n  guid: string;\n  pages: PageAnnotationModel[];\n  supportedAnnotations: string[];\n}\n\nexport class PageAnnotationModel extends PageModel {\n  annotations: AnnotationData[];\n}\n\nexport class Position {\n  left: number;\n  top: number;\n\n  constructor(left: number, top: number) {\n    this.left = left;\n    this.top = top;\n  }\n\n  static clone(position: Position) {\n    return new Position(position.left, position.top);\n  }\n}\n\nexport class Dimension {\n  width: number;\n  height: number;\n\n  constructor(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n  }\n\n  isNone() {\n    return this.width === 0 && this.height === 0;\n  }\n}\n\nexport class AnnotationData {\n\n  constructor() {\n    this.text = \"\";\n    this.fontColor = 8421375;\n  }\n\n  id: number;\n  comments: Comment[];\n  text: string;\n  font: string;\n  fontSize: number;\n  fontColor: number;\n  height: number;\n  width: number;\n  left: number;\n  top: number;\n  pageNumber: number;\n  svgPath: string;\n  type: string;\n}\n\nexport class CommentAnnotation {\n  constructor(id: number) {\n    this.id = id;\n  }\n\n  id: number;\n}\n\nexport class Comment {\n\n  id: number;\n  text: string;\n  userName: string;\n  time: number;\n\n  constructor(id: number) {\n    this.id = id;\n    this.time = Date.now();\n    this.text = \"\";\n    this.userName = \"\";\n  }\n\n  static create(comment) {\n    const ret = new Comment(comment.id);\n    ret.text = comment.text;\n    ret.userName = comment.userName;\n    ret.time = comment.time;\n    return ret;\n  }\n}\n\nexport class RemoveAnnotation {\n  constructor(id: number) {\n    this.id = id;\n  }\n\n  id: number;\n}\n","import {Observable, Subject} from \"rxjs\";\n\nexport class ActiveAnnotationService {\n  private _observer: Subject<number> = new Subject();\n  private readonly _activeChange: Observable<number> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get activeChange(): Observable<number> {\n    return this._activeChange;\n  }\n\n  changeActive(annId: number) {\n    this._observer.next(annId);\n  }\n}\n\n","import {Observable, Subject} from \"rxjs\";\nimport {RemoveAnnotation} from \"./annotation-models\";\n\nexport class RemoveAnnotationService {\n  private _observer: Subject<RemoveAnnotation> = new Subject();\n  private readonly _removeAnnotation: Observable<RemoveAnnotation> = this._observer.asObservable();\n\n  constructor() {\n  }\n\n  get removeAnnotation(): Observable<RemoveAnnotation> {\n    return this._removeAnnotation;\n  }\n\n  remove(id: RemoveAnnotation): void {\n    this._observer.next(id);\n  }\n}\n","import {Observable, Subject} from \"rxjs\";\nimport {CommentAnnotation, Comment} from \"./annotation-models\";\n\nexport class CommentAnnotationService {\n  private _observer: Subject<CommentAnnotation> = new Subject();\n  private readonly _commentAnnotation: Observable<CommentAnnotation> = this._observer.asObservable();\n  private _observerAddComment: Subject<Comment> = new Subject();\n  private readonly _addCommentObserve: Observable<Comment> = this._observerAddComment.asObservable();\n\n  constructor() {\n  }\n\n  get commentAnnotation(): Observable<CommentAnnotation> {\n    return this._commentAnnotation;\n  }\n\n  comment(id: CommentAnnotation): void {\n    this._observer.next(id);\n  }\n\n  get addCommentObserve(): Observable<Comment> {\n    return this._addCommentObserve;\n  }\n\n  addComment(comment: Comment) {\n    this._observerAddComment.next(comment);\n  }\n\n}\n","import {AfterViewInit, Component, OnInit} from '@angular/core';\nimport {\n  AnnotationData,\n  AnnotationType,\n  CommentAnnotation,\n  Dimension,\n  Position,\n  RemoveAnnotation\n} from \"../annotation-models\";\nimport {ActiveAnnotationService} from \"../active-annotation.service\";\nimport {Formatting, Utils, MenuType} from \"@groupdocs.examples.angular/common-components\";\nimport {RemoveAnnotationService} from \"../remove-annotation.service\";\nimport {CommentAnnotationService} from \"../comment-annotation.service\";\nimport * as jquery from 'jquery';\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-annotation',\n  templateUrl: './annotation.component.html',\n  styleUrls: ['./annotation.component.less']\n})\nexport class AnnotationComponent implements OnInit, AfterViewInit {\n\n  id: number;\n  position: Position;\n  leftTop: Position;\n  type: string;\n  pageWidth: number;\n  pageHeight: number;\n  active = true;\n  dimension = new Dimension(0, 0);\n  pageNumber: number;\n  textValue = \"\";\n  pathValue: string;\n  distanceValue = '0px';\n  pointsValue = \"\";\n  svgPath = \"\";\n  formatting = Formatting.default();\n\n  private oldPosition: { x: number; y: number };\n  private points = [];\n  private endPosition: Position;\n\n  constructor(private _activeAnnotationService: ActiveAnnotationService,\n              private _removeAnnotationService: RemoveAnnotationService,\n              private _commentAnnotationService: CommentAnnotationService) {\n    this._activeAnnotationService.activeChange.subscribe((id: number) => {\n      this.active = this.id === id;\n      if (this.active) {\n        this.setTextFocus();\n      }\n    });\n  }\n\n  static isOnPage(position) {\n    const currentPage = document.elementFromPoint(position.x, position.y);\n    return currentPage && $(currentPage).parent().parent() &&\n      ($(currentPage).parent().parent().parent().hasClass(\"page\") ||\n        $(currentPage).parent().parent().parent().parent().parent().hasClass(\"page\"));\n  }\n\n  ngOnInit() {\n    this.leftTop = Position.clone(this.position);\n    if (this.isPolyline()) {\n      if (this.svgPath) {\n        const parsedPoints = this.svgPath.replace(\"M\", \"\").split('L');\n        let x = parseFloat(parsedPoints[0].split(\",\")[0]);\n        let y = parseFloat(parsedPoints[0].split(\",\")[1]);\n        const comp = this;\n        parsedPoints.forEach(function (point, index) {\n          if (index !== 0) {\n            if (point !== \"\") {\n              comp.addPoint(new Position(x, y));\n              x = (x + parseFloat(point.split(\",\")[0]));\n              y = (y + parseFloat(point.split(\",\")[1]));\n            }\n          }\n        });\n      } else {\n        this.addPoint(this.position);\n      }\n    } else if (this.isPath()) {\n      if (this.svgPath || (this.type === AnnotationType.ARROW.id && !this.dimension.isNone())) {\n        const end = new Position(this.position.left + this.dimension.width, this.position.top + this.dimension.height);\n        this.setEndPosition(end);\n        if (this.dimension.height < 0) {\n          this.leftTop.top += this.dimension.height;\n          this.dimension.height = this.dimension.height * (-1);\n        }\n        if (this.dimension.width < 0) {\n          this.leftTop.left += this.dimension.width;\n          this.dimension.width = this.dimension.width * (-1);\n        }\n      } else {\n        this.setEndPosition(this.position);\n      }\n      this.distanceValue = this.getDistance() + \"px\";\n    } else if (this.type === AnnotationType.POINT.id) {\n      this.initPoint();\n    } else {\n      this.setEndPosition(this.position);\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this.setTextFocus();\n  }\n\n  activation() {\n    this._activeAnnotationService.changeActive(this.id);\n  }\n\n  width($event) {\n    if (this.checkDragging($event, 0)) {\n      this.dimension.width += $event;\n    }\n  }\n\n  height($event) {\n    if (this.checkDragging(0, $event)) {\n      this.dimension.height += $event;\n    }\n  }\n\n  left($event) {\n    this.position.left += $event;\n    this.correctPosition();\n    this.refreshLeftTop();\n  }\n\n  top($event) {\n    this.position.top += $event;\n    this.correctPosition();\n    this.refreshLeftTop();\n  }\n\n  private refreshLeftTop() {\n    this.leftTop.left = this.position.left;\n    this.leftTop.top = this.position.top;\n  }\n\n  private correctPosition() {\n    if (this.position.left < 0) {\n      this.position.left = 0;\n    }\n    if (this.position.top < 0) {\n      this.position.top = 0;\n    }\n    if (this.position.top + this.dimension.height > this.pageHeight) {\n      this.position.top = this.pageHeight - this.dimension.height;\n    }\n    if (this.position.left + this.dimension.width > this.pageWidth) {\n      this.position.left = this.pageWidth - this.dimension.width;\n    }\n  }\n\n  dragOver($event: DragEvent) {\n    $event.preventDefault();\n    $event.stopPropagation();\n  }\n\n  dragStart($event: DragEvent) {\n    $event.preventDefault();\n    this.oldPosition = Utils.getMousePosition($event);\n    if ($event.dataTransfer) {\n      $event.dataTransfer.setData('text', 'foo');\n    }\n  }\n\n  initPoint() {\n    this.dimension = new Dimension(40, 40);\n    this.position.left = this.position.left - 20;\n    this.position.top = this.position.top - 20;\n    this.leftTop = Position.clone(this.position);\n  }\n\n  dragging($event) {\n    $event.preventDefault();\n    const position = Utils.getMousePosition($event);\n    if (position.x && position.y && AnnotationComponent.isOnPage(position)) {\n      const left = position.x - this.oldPosition.x;\n      const top = position.y - this.oldPosition.y;\n      if (this.isPolyline()) {\n        if (!this.checkDragging(left, top)) {\n          return;\n        }\n        this.pointsValue = \"\";\n        for (const point of this.points) {\n          point.left = point.left + left;\n          point.top = point.top + top;\n          this.pointsValue += point.left + \",\" + point.top + \" \";\n        }\n        this.leftTop.left += left;\n        this.leftTop.top += top;\n      } else if (this.isPath()) {\n        if (!this.checkDragging(left, top)) {\n          return;\n        }\n        this.position.left += left;\n        this.position.top += top;\n        this.endPosition.left += left;\n        this.endPosition.top += top;\n        this.pathValue = \"M\" + this.position.left + \",\" + this.position.top + \" L\" + this.endPosition.left + \",\" + this.endPosition.top;\n        this.distanceValue = this.getDistance() + \"px\";\n        this.leftTop.left += left;\n        this.leftTop.top += top;\n      } else {\n        this.position.left += left;\n        this.position.top += top;\n        this.correctPosition();\n        this.refreshLeftTop();\n      }\n      this.oldPosition = position;\n    }\n  }\n\n  getAnnotationClass() {\n    switch (this.type) {\n      case AnnotationType.TEXT.id:\n        return \"gd-annotation-wrapper-border gd-text-annotation\";\n      case AnnotationType.TEXT_STRIKEOUT.id:\n        return \"gd-annotation-wrapper-border gd-text-annotation gd-text-strikeout-annotation\";\n      case AnnotationType.TEXT_UNDERLINE.id:\n        return \"gd-annotation-wrapper-border gd-text-annotation gd-text-underline-annotation\";\n      case AnnotationType.TEXT_REDACTION.id:\n        return \"gd-annotation-wrapper-border gd-text-redaction-annotation\";\n      case AnnotationType.TEXT_REPLACEMENT.id:\n        return \"gd-annotation-wrapper-border gd-text-replacement-annotation\";\n      case AnnotationType.POINT.id:\n        return \"\";\n      default:\n        return \"gd-annotation-wrapper-border\";\n    }\n  }\n\n  isStrikeoutOrUnderline() {\n    return this.type === AnnotationType.TEXT_STRIKEOUT.id || this.type === AnnotationType.TEXT_UNDERLINE.id;\n  }\n\n  isTextReplacement() {\n    return this.type === AnnotationType.TEXT_REPLACEMENT.id;\n  }\n\n  saveText(value: string) {\n    this.textValue = value;\n  }\n\n  draw(position: Position) {\n    if (this.onPage(position)) {\n      if (this.isPolyline()) {\n        this.addPoint(position);\n      } else if (this.isPath()) {\n        this.setEndPosition(position);\n        this.distanceValue = this.getDistance() + \"px\";\n      }\n      this.calcPositionAndDimension();\n    }\n  }\n\n  setStyles() {\n    return {\n      'stroke': '#579AF0',\n      'stroke-width': 2,\n      'fill-opacity': 0,\n      'id': (this.isPolyline() ? 'gd-polyline-annotation-' : (this.isDistance() ? 'gd-distance-annotation-' : 'gd-arrow-annotation-')) + this.id,\n      'class': 'annotation-svg',\n    };\n  }\n\n  isPolyline() {\n    return this.type === AnnotationType.POLYLINE.id;\n  }\n\n  private calcPositionAndDimension() {\n    const leftTop = new Position(Number.MAX_VALUE, Number.MAX_VALUE);\n    const rightBottom = new Position(Number.MIN_VALUE, Number.MIN_VALUE);\n    if (this.isPolyline()) {\n      for (const point of this.points) {\n        leftTop.left = Math.min(point.left, leftTop.left);\n        leftTop.top = Math.min(point.top, leftTop.top);\n        rightBottom.left = Math.max(point.left, rightBottom.left);\n        rightBottom.top = Math.max(point.top, rightBottom.top);\n      }\n    } else {\n      leftTop.left = Math.min(this.position.left, this.endPosition.left);\n      leftTop.top = Math.min(this.position.top, this.endPosition.top);\n      rightBottom.left = Math.max(this.position.left, this.endPosition.left);\n      rightBottom.top = Math.max(this.position.top, this.endPosition.top);\n    }\n    this.dimension.width = rightBottom.left - leftTop.left;\n    this.dimension.height = rightBottom.top - leftTop.top;\n    this.leftTop = leftTop;\n  }\n\n  calcDimensions(currentPosition: Position) {\n    if (currentPosition.left <= this.pageWidth && currentPosition.left >= 0) {\n      this.dimension.width = currentPosition.left - this.position.left;\n    }\n    if (currentPosition.top <= this.pageHeight && currentPosition.top >= 0) {\n      this.dimension.height = currentPosition.top - this.position.top;\n    }\n  }\n\n  getHeight() {\n    return this.dimension.height === undefined ? undefined : Math.abs(this.dimension.height);\n  }\n\n  getWidth() {\n    return this.dimension.width === undefined ? undefined : Math.abs(this.dimension.width);\n  }\n\n  private checkDragging(left: number, top: number) {\n    return !(this.leftTop.left + left < 0 || this.leftTop.top + top < 0 ||\n      this.leftTop.top + top + this.dimension.height > this.pageHeight ||\n      this.leftTop.left + left + this.dimension.width > this.pageWidth);\n  }\n\n  isPoint() {\n    return this.type === AnnotationType.POINT.id;\n  }\n\n  isSVG() {\n    return this.type === AnnotationType.POLYLINE.id ||\n      this.type === AnnotationType.DISTANCE.id ||\n      this.type === AnnotationType.ARROW.id;\n  }\n\n  isDistance() {\n    return this.type === AnnotationType.DISTANCE.id;\n  }\n\n  distanceTextOptions() {\n    return {'font-size': \"12px\"}\n  }\n\n  isPath() {\n    return this.type === AnnotationType.DISTANCE.id ||\n      this.type === AnnotationType.ARROW.id;\n  }\n\n  private setEndPosition(position: Position) {\n    this.endPosition = Position.clone(position);\n    this.pathValue = \"M\" + this.position.left + \",\" + this.position.top + \" L\" + this.endPosition.left + \",\" + this.endPosition.top;\n  }\n\n  private addPoint(position: Position) {\n    this.points.push(position);\n    this.pointsValue += position.left + \",\" + position.top + \" \";\n  }\n\n  private getDistance() {\n    const xs = this.position.left - this.endPosition.left;\n    const ys = this.position.top - this.endPosition.top;\n    return Math.round(Math.sqrt(xs * xs + ys * ys));\n  }\n\n  bottom() {\n    return 'url(' + window.location + '#end)';\n  }\n\n  head() {\n    return this.isDistance() ? 'url(' + window.location + '#start)' : \"\";\n  }\n\n  getTextX() {\n    return this.getDistance() / 2;\n  }\n\n  isText() {\n    return this.type === AnnotationType.TEXT_FIELD.id || this.type === AnnotationType.WATERMARK.id;\n  }\n\n  getFormatting() {\n    const f = this.formatting;\n    const formatting = Formatting.default();\n    if (f) {\n      formatting.fontSize = f.fontSize;\n      formatting.font = f.font;\n      formatting.color = f.color;\n    }\n    return formatting;\n  }\n\n  saveFormatting($event: Formatting) {\n    this.formatting.fontSize = $event.fontSize;\n    this.formatting.font = $event.font;\n    this.formatting.color = $event.color;\n  }\n\n  remove() {\n    this._removeAnnotationService.remove(new RemoveAnnotation(this.id));\n  }\n\n  getMenuShift() {\n    const menuWidth = this.isText() ? 265 : 111;\n    return this.dimension.width > menuWidth ? 0 : (this.dimension.width - menuWidth) * 0.5;\n  }\n\n  getMenuType() {\n    return MenuType.FOR_ANNOTATION;\n  }\n\n  addComment() {\n    this._commentAnnotationService.comment(new CommentAnnotation(this.id));\n  }\n\n  private setTextFocus() {\n    if (this.isText() || this.isTextReplacement()) {\n      setTimeout(() => {\n        const element = $(\"#text-\" + this.id);\n        if (element) {\n          element.focus();\n        }\n      }, 100);\n    }\n  }\n\n  textAreaHeight(key: any, textarea: any) {\n    this.dimension.height = \"Enter\" === key ? textarea.scrollHeight + this.formatting.fontSize : textarea.scrollHeight;\n    this.dimension.width = textarea.scrollWidth;\n  }\n\n  hideMenu($event: Event) {\n    this._activeAnnotationService.changeActive(null);\n  }\n\n  getAnnotationData(): AnnotationData {\n    const annotationData = new AnnotationData();\n    annotationData.id = this.id;\n    annotationData.text = this.textValue;\n    annotationData.fontColor = parseInt(Utils.toHex(this.formatting.color).replace(\"#\", \"\"), 16);\n    annotationData.fontSize = this.formatting.fontSize;\n    annotationData.font = this.formatting.font;\n    if (this.type === AnnotationType.POINT.id) {\n      annotationData.left = this.leftTop.left + 20;\n      annotationData.top = this.leftTop.top + 20;\n      annotationData.height = 0;\n      annotationData.width = 0;\n    } else {\n      annotationData.left = this.leftTop.left;\n      annotationData.top = this.leftTop.top;\n      annotationData.height = this.dimension.height;\n      annotationData.width = this.dimension.width;\n    }\n    annotationData.pageNumber = this.pageNumber;\n    annotationData.type = this.type;\n    annotationData.svgPath = this.getSvgPath();\n    return annotationData;\n  }\n\n  private getSvgPath() {\n    let svgPath = \"M\";\n    if (this.type === AnnotationType.POLYLINE.id) {\n      let index = 0;\n      let previousX = 0, previousY = 0;\n      for (const point of this.points) {\n        if (index === 0) {\n          svgPath += point.left + \",\" + point.top + \"l\";\n          index = 1;\n        } else {\n          previousX = point.left - previousX;\n          previousY = point.top - previousY;\n          svgPath += previousX + \",\" + previousY + \"l\";\n        }\n        previousX = point.left;\n        previousY = point.top;\n      }\n    } else if (this.type === AnnotationType.DISTANCE.id || this.type === AnnotationType.ARROW.id) {\n      svgPath += this.position.left + \",\" + this.position.top + \" \";\n      svgPath += this.endPosition.left + \",\" + this.endPosition.top + \" \";\n    } else {\n      svgPath = \"\";\n    }\n    return svgPath;\n  }\n\n  private onPage(position: Position) {\n    return position.left <= this.pageWidth && position.top <= this.pageHeight &&\n      position.left >= 0 && position.top >= 0;\n  }\n}\n","import {Component, ComponentRef, OnInit} from '@angular/core';\nimport {AnnotationConfig} from \"./annotation-config\";\nimport {AnnotationService} from \"./annotation.service\";\nimport {\n  AddDynamicComponentService,\n  CommonModals,\n  FileCredentials,\n  FileModel, Formatting,\n  HostingDynamicComponentService,\n  ModalService,\n  NavigateService, PagePreloadService, PasswordService,\n  TopTabActivatorService, UploadFilesService,\n  Utils,\n  WindowService\n} from \"@groupdocs.examples.angular/common-components\";\nimport {\n  AnnotationType,\n  CommentAnnotation,\n  Position,\n  RemoveAnnotation,\n  Comment,\n  FileAnnotationDescription, PageAnnotationModel, AnnotationData, Dimension\n} from \"./annotation-models\";\nimport {AnnotationComponent} from \"./annotation/annotation.component\";\nimport {ActiveAnnotationService} from \"./active-annotation.service\";\nimport * as jquery from 'jquery';\nimport {RemoveAnnotationService} from \"./remove-annotation.service\";\nimport {CommentAnnotationService} from \"./comment-annotation.service\";\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-annotation-app',\n  templateUrl: './annotation-app.component.html',\n  styleUrls: ['./annotation-app.component.less']\n})\nexport class AnnotationAppComponent implements OnInit {\n  title = 'annotation';\n  files: FileModel[] = [];\n  file: FileAnnotationDescription;\n  isLoading: boolean;\n  annotationConfig: AnnotationConfig;\n  browseFilesModal = CommonModals.BrowseFiles;\n  formatDisabled = !this.file;\n  credentials: FileCredentials;\n  annotationTypes = [\n    AnnotationType.TEXT,\n    AnnotationType.TEXT_STRIKEOUT,\n    AnnotationType.TEXT_UNDERLINE,\n    AnnotationType.TEXT_REPLACEMENT,\n    AnnotationType.TEXT_REDACTION,\n    AnnotationType.POLYLINE,\n    AnnotationType.ARROW,\n    AnnotationType.DISTANCE,\n    AnnotationType.AREA,\n    AnnotationType.TEXT_FIELD,\n    AnnotationType.WATERMARK,\n    AnnotationType.POINT,\n  ];\n  isDesktop: boolean;\n  annotationTypeFirst = [\n    AnnotationType.TEXT,\n    AnnotationType.TEXT_UNDERLINE,\n    AnnotationType.TEXT_REDACTION,\n    AnnotationType.TEXT_REPLACEMENT,\n    AnnotationType.TEXT_STRIKEOUT,\n  ];\n  annotationTypeSecond = [\n    AnnotationType.POLYLINE,\n    AnnotationType.ARROW,\n    AnnotationType.DISTANCE,\n    AnnotationType.AREA,\n    AnnotationType.POINT\n  ];\n  annotationTypeThird = [\n    AnnotationType.TEXT_FIELD,\n    AnnotationType.WATERMARK,\n  ];\n  countPages = 0;\n  commentOpenedId: number;\n  comments = new Map<number, Comment[]>();\n\n  private activeAnnotationTab: string;\n  private fileWasDropped = false;\n  private annotations = new Map<number, ComponentRef<any>>();\n  private creatingAnnotationId: number;\n  private activeAnnotationId: number;\n\n  constructor(private _annotationService: AnnotationService,\n              private _modalService: ModalService,\n              private _navigateService: NavigateService,\n              private _tabActivatorService: TopTabActivatorService,\n              private _hostingComponentsService: HostingDynamicComponentService,\n              private _addDynamicComponentService: AddDynamicComponentService,\n              private _activeAnnotationService: ActiveAnnotationService,\n              private _removeAnnotationService: RemoveAnnotationService,\n              private _commentAnnotationService: CommentAnnotationService,\n              uploadFilesService: UploadFilesService,\n              pagePreloadService: PagePreloadService,\n              passwordService: PasswordService,\n              private _windowService: WindowService) {\n\n    this._activeAnnotationService.activeChange.subscribe((id: number) => {\n      if (this.activeAnnotationId !== id) {\n        this.commentOpenedId = null;\n        this.activeAnnotationId = id;\n      }\n    });\n\n    this._commentAnnotationService.commentAnnotation.subscribe((commentAnnotation: CommentAnnotation) => {\n      this.commentOpenedId = commentAnnotation.id;\n      if (!this.comments.get(this.commentOpenedId)) {\n        this.comments.set(this.commentOpenedId, []);\n      }\n    });\n\n    this._commentAnnotationService.addCommentObserve.subscribe((comment: Comment) => {\n      this.comments.get(this.commentOpenedId).push(comment);\n    });\n\n    this._removeAnnotationService.removeAnnotation.subscribe((removeAnnotation: RemoveAnnotation) => {\n      const componentRef = this.annotations.get(removeAnnotation.id);\n      if (componentRef) {\n        componentRef.destroy();\n      }\n      this.annotations.delete(removeAnnotation.id);\n      if (this.commentOpenedId === removeAnnotation.id) {\n        this.commentOpenedId = null;\n      }\n      this.comments.delete(removeAnnotation.id);\n    });\n\n    uploadFilesService.uploadsChange.subscribe((uploads) => {\n      if (uploads) {\n        let i: number;\n        for (i = 0; i < uploads.length; i++) {\n          this._annotationService.upload(uploads.item(i), '', this.rewriteConfig).subscribe((obj: FileCredentials) => {\n            this.fileWasDropped ? this.selectFile(obj.guid, '', '') : this.selectDir('');\n          });\n        }\n      }\n    });\n\n    pagePreloadService.checkPreload.subscribe((page: number) => {\n      if (this.preloadPageCountConfig !== 0) {\n        for (let i = page; i < page + 2; i++) {\n          if (i > 0 && i <= this.countPages && !this.file.pages[i - 1].data) {\n            this.preloadPages(i, i);\n          }\n        }\n      }\n    });\n\n    passwordService.passChange.subscribe((pass: string) => {\n      this.selectFile(this.credentials.guid, pass, CommonModals.PasswordRequired);\n    });\n\n    this.isDesktop = _windowService.isDesktop();\n    _windowService.onResize.subscribe((w) => {\n      this.isDesktop = _windowService.isDesktop();\n    });\n  }\n\n  getComments() {\n    return this.comments.get(this.commentOpenedId);\n  }\n\n  get rewriteConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.rewrite : true;\n  }\n\n  get zoomConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.zoom : false;\n  }\n\n  get pageSelectorConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.pageSelector : true;\n  }\n\n  get preloadPageCountConfig(): number {\n    return this.annotationConfig ? this.annotationConfig.preloadPageCount : 0;\n  }\n\n  get downloadConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.download : true;\n  }\n\n  get downloadOriginalConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.downloadOriginal : true;\n  }\n\n  get downloadAnnotatedConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.downloadAnnotated : true;\n  }\n\n  get uploadConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.upload : true;\n  }\n\n  private defaultDocumentConfig() {\n    return this.annotationConfig ? this.annotationConfig.defaultDocument : \"\";\n  }\n\n  get printConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.print : true;\n  }\n\n  get browseConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.browse : true;\n  }\n\n  get htmlModeConfig(): boolean {\n    return false;\n  }\n\n  get enableRightClickConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.enableRightClick : true;\n  }\n\n  get textAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textAnnotation : true;\n  }\n\n  get areaAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.areaAnnotation : true;\n  }\n\n  get pointAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.pointAnnotation : true;\n  }\n\n  get textStrikeoutAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textStrikeoutAnnotation : true;\n  }\n\n  get polylineAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.polylineAnnotation : true;\n  }\n\n  get textFieldAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textFieldAnnotation : true;\n  }\n\n  get watermarkAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.watermarkAnnotation : true;\n  }\n\n  get textReplacementAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textReplacementAnnotation : true;\n  }\n\n  get arrowAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.arrowAnnotation : true;\n  }\n\n  get textRedactionAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textRedactionAnnotation : true;\n  }\n\n  get textUnderlineAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.textUnderlineAnnotation : true;\n  }\n\n  get distanceAnnotationConfig(): boolean {\n    return this.annotationConfig ? this.annotationConfig.distanceAnnotation : true;\n  }\n\n  ngOnInit() {\n  }\n\n  openModal(id: string) {\n    this._modalService.open(id);\n  }\n\n  closeModal(id: string) {\n    this._modalService.close(id);\n  }\n\n  selectDir($event: string) {\n    this._annotationService.loadFiles($event).subscribe((files: FileModel[]) => this.files = files || []);\n  }\n\n  selectFile($event: string, password: string, modalId: string) {\n    this.credentials = new FileCredentials($event, password);\n    this.file = null;\n    this.commentOpenedId = null;\n    this._annotationService.loadFile(this.credentials).subscribe((file: FileAnnotationDescription) => {\n        this.cleanAnnotations();\n        this.file = file;\n        this.formatDisabled = !this.file;\n        if (file) {\n          const preloadPageCount = this.preloadPageCountConfig;\n          const countPages = file.pages ? file.pages.length : 0;\n          if (preloadPageCount > 0) {\n            this.preloadPages(1, preloadPageCount > countPages ? countPages : preloadPageCount);\n          } else {\n            setTimeout(() => {\n              for (const page of this.file.pages) {\n                this.importAnnotations(page.annotations ? page.annotations : []);\n              }\n            }, 100);\n          }\n          this._navigateService.countPages = countPages;\n          this._navigateService.currentPage = 1;\n          this.countPages = countPages;\n        }\n      }\n    );\n    if (modalId) {\n      this._modalService.close(modalId);\n    }\n    this.clearData();\n  }\n\n  preloadPages(start: number, end: number) {\n    for (let i = start; i <= end; i++) {\n      this._annotationService.loadPage(this.credentials, i).subscribe((page: PageAnnotationModel) => {\n        this.file.pages[i - 1] = page;\n        this.importAnnotations(page.annotations ? page.annotations : []);\n      });\n    }\n  }\n\n  private importAnnotations(annotations: AnnotationData[]) {\n    for (const annotation of annotations) {\n      const position = new Position(annotation.left, annotation.top);\n      const id = this.addAnnotationComponent(annotation.pageNumber, position, annotation);\n      this.comments.set(id, annotation.comments);\n      this._activeAnnotationService.changeActive(id);\n    }\n  }\n\n  upload($event: string) {\n    this._annotationService.upload(null, $event, this.rewriteConfig).subscribe(() => {\n      this.selectDir('');\n    });\n  }\n\n  onRightClick($event: MouseEvent) {\n    return this.enableRightClickConfig;\n  }\n\n  downloadFile() {\n    if (this.formatDisabled)\n      return;\n    window.location.assign(this._annotationService.getDownloadUrl(this.credentials));\n  }\n\n  annotate() {\n    const annotationsData = [];\n    for (const annotation of this.annotations.values()) {\n      const annotationData = (<AnnotationComponent>annotation.instance).getAnnotationData();\n      annotationData.comments = this.comments.get(annotationData.id);\n      annotationsData.push(annotationData);\n    }\n    this._annotationService.annotate(this.credentials, annotationsData, false).subscribe((ret: any) => {\n      this._modalService.open(CommonModals.OperationSuccess);\n      this.selectFile(ret.guid, null, CommonModals.OperationSuccess);\n    });\n  }\n\n  isVisible(id: string) {\n    const supported = !this.file || (this.file && this.file.supportedAnnotations &&\n      this.file.supportedAnnotations.find(function (value: string) {\n      return id === value;\n    }));\n    return this.getAnnotationTypeConfig(id) && supported;\n  }\n\n  activeTab($event) {\n    this.activeAnnotationTab = $event;\n  }\n\n  codesConfigFirst() {\n    return this.checkConfig(this.annotationTypeFirst);\n  }\n\n  codesConfigSecond() {\n    return this.checkConfig(this.annotationTypeSecond);\n  }\n\n  private checkConfig(annotationList) {\n    for (const annotationType of annotationList) {\n      if (this.getAnnotationTypeConfig(annotationType.id)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  codesConfigThird() {\n    return this.getAnnotationTypeConfig(AnnotationType.TEXT_FIELD.id) && this.getAnnotationTypeConfig(AnnotationType.WATERMARK.id);\n  }\n\n  private getAnnotationTypeConfig(id: string) {\n    switch (id) {\n      case AnnotationType.TEXT.id:\n        return this.textAnnotationConfig;\n      case AnnotationType.AREA.id:\n        return this.areaAnnotationConfig;\n      case AnnotationType.POINT.id:\n        return this.pointAnnotationConfig;\n      case AnnotationType.TEXT_STRIKEOUT.id:\n        return this.textStrikeoutAnnotationConfig;\n      case AnnotationType.POLYLINE.id:\n        return this.polylineAnnotationConfig;\n      case AnnotationType.TEXT_FIELD.id:\n        return this.textFieldAnnotationConfig;\n      case AnnotationType.WATERMARK.id:\n        return this.watermarkAnnotationConfig;\n      case AnnotationType.TEXT_REPLACEMENT.id:\n        return this.textReplacementAnnotationConfig;\n      case AnnotationType.ARROW.id:\n        return this.arrowAnnotationConfig;\n      case AnnotationType.TEXT_REDACTION.id:\n        return this.textRedactionAnnotationConfig;\n      case AnnotationType.TEXT_UNDERLINE.id:\n        return this.textUnderlineAnnotationConfig;\n      case AnnotationType.DISTANCE.id:\n        return this.distanceAnnotationConfig;\n    }\n  }\n\n  fileDropped($event) {\n    this.fileWasDropped = $event;\n  }\n\n  private cleanAnnotations() {\n    for (const componentRef of this.annotations.values()) {\n      componentRef.destroy();\n    }\n    this.annotations = new Map<number, ComponentRef<any>>();\n    this.comments = new Map<number, Comment[]>();\n  }\n\n  private clearData() {\n    if (!this.file || !this.file.pages) {\n      return;\n    }\n    for (const page of this.file.pages) {\n      page.data = null;\n    }\n  }\n\n  createAnnotation($event: MouseEvent) {\n    $event.preventDefault();\n\n    if (this.activeAnnotationTab) {\n      const position = Utils.getMousePosition($event);\n\n      const elements = document.elementsFromPoint(position.x, position.y);\n      const currentPage = elements.find(x => x.id && x.id.startsWith(\"page-\"));\n      if (currentPage) {\n        const documentPage = $(currentPage).parent().parent()[0];\n        const currentPosition = this.getCurrentPosition(position, $(documentPage));\n        const pageId = currentPage.id;\n        let pageNumber = 1;\n        if (pageId) {\n          const split = pageId.split('-');\n          pageNumber = split.length === 2 ? parseInt(split[1], 10) : pageNumber;\n        }\n        const id = this.addAnnotationComponent(pageNumber, currentPosition, null);\n        this._activeAnnotationService.changeActive(id);\n        this.creatingAnnotationId = id;\n        this._tabActivatorService.changeActiveTab(null);\n      }\n    }\n  }\n\n  private addAnnotationComponent(pageNumber: number, currentPosition: Position, data: AnnotationData) {\n    const dynamicDirective = this._hostingComponentsService.find(pageNumber);\n    if (dynamicDirective) {\n      const viewContainerRef = dynamicDirective.viewContainerRef;\n      const annotationComponent = this._addDynamicComponentService.addDynamicComponent(viewContainerRef, AnnotationComponent);\n      const id = this.getNextId();\n      (<AnnotationComponent>annotationComponent.instance).id = id;\n      (<AnnotationComponent>annotationComponent.instance).position = currentPosition;\n      (<AnnotationComponent>annotationComponent.instance).pageNumber = pageNumber;\n      if (data) {\n        const dimension = new Dimension(data.width, data.height);\n        const type = AnnotationType.getAnnotationType(data.type);\n        const formatting = Formatting.default();\n        formatting.fontSize = data.fontSize;\n        if (data.fontColor) {\n          formatting.color = \"#\" + data.fontColor.toString(16);\n        }\n        formatting.font = data.font;\n        (<AnnotationComponent>annotationComponent.instance).type = type ? type.id : data.type;\n        (<AnnotationComponent>annotationComponent.instance).dimension = dimension;\n        (<AnnotationComponent>annotationComponent.instance).svgPath = data.svgPath;\n        (<AnnotationComponent>annotationComponent.instance).textValue = data.text;\n        if (formatting) {\n          (<AnnotationComponent>annotationComponent.instance).saveFormatting(formatting);\n        }\n      } else {\n        (<AnnotationComponent>annotationComponent.instance).type = this.activeAnnotationTab;\n      }\n      const pageModel = this.file.pages.find(function (p) {\n        return p.number === pageNumber;\n      });\n      (<AnnotationComponent>annotationComponent.instance).pageWidth = pageModel.width;\n      (<AnnotationComponent>annotationComponent.instance).pageHeight = pageModel.height;\n      this.annotations.set(id, annotationComponent);\n      return id;\n    }\n    return null;\n  }\n\n  resizingCreatingAnnotation($event: MouseEvent) {\n    $event.preventDefault();\n\n    if (this.creatingAnnotationId) {\n      const position = Utils.getMousePosition($event);\n      const annotationComponent = this.annotations.get(this.creatingAnnotationId);\n      const type = (<AnnotationComponent>annotationComponent.instance).type;\n      const pageNumber = (<AnnotationComponent>annotationComponent.instance).pageNumber;\n      const currentPosition = this.getCurrentPosition(position, $(\"#page-\" + pageNumber));\n      if (type === AnnotationType.POLYLINE.id || type === AnnotationType.DISTANCE.id || type === AnnotationType.ARROW.id) {\n        (<AnnotationComponent>annotationComponent.instance).draw(currentPosition);\n      } else if (type !== AnnotationType.POINT.id) {\n        (<AnnotationComponent>annotationComponent.instance).calcDimensions(currentPosition);\n      }\n    }\n  }\n\n  private getCurrentPosition(position, page) {\n    const left = position.x - page.offset().left;\n    const top = position.y - page.offset().top;\n    return new Position(left, top);\n  }\n\n  finishCreatingAnnotation($event: MouseEvent) {\n    if (this.creatingAnnotationId) {\n      this._activeAnnotationService.changeActive(this.creatingAnnotationId);\n      this.creatingAnnotationId = null;\n    }\n  }\n\n  closeComments() {\n    this.commentOpenedId = null;\n  }\n\n  private getNextId() {\n    let maxId = 0;\n    for (const annId of this.annotations.keys()) {\n      if (annId > maxId){\n        maxId = annId;\n      }\n    }\n    const id = maxId + 1;\n    return id;\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {CommentAnnotationService} from \"../comment-annotation.service\";\nimport {Comment} from '../annotation-models'\n\n@Component({\n  selector: 'gd-comment-panel',\n  templateUrl: './comment-panel.component.html',\n  styleUrls: ['./comment-panel.component.less']\n})\nexport class CommentPanelComponent implements OnInit {\n  @Input() comments: [];\n  @Input() annotationId: number;\n\n  @Output() closeComments = new EventEmitter<boolean>();\n\n  currentComment: Comment;\n\n  constructor(private _commentAnnotationService: CommentAnnotationService) {\n  }\n\n  ngOnInit() {\n  }\n\n  closePanel() {\n    this.closeComments.emit(true);\n  }\n\n  newComment() {\n    this.currentComment = new Comment(this.annotationId);\n  }\n\n  clearComment() {\n    this.currentComment = null;\n  }\n\n  addComment() {\n    this._commentAnnotationService.addComment(Comment.create(this.currentComment));\n    this.currentComment = null;\n  }\n}\n","import {Component, Input, OnInit} from '@angular/core';\nimport {Comment} from '../annotation-models'\n\n@Component({\n  selector: 'gd-comment',\n  templateUrl: './comment.component.html',\n  styleUrls: ['./comment.component.less']\n})\nexport class CommentComponent implements OnInit {\n\n  @Input() comment: Comment;\n\n  constructor() {\n  }\n\n  ngOnInit() {\n  }\n\n  getTime() {\n    const time = Date.now() - this.comment.time;\n    const hours = Math.round(time / (60 * 60 * 1000));\n    if (hours > 1) {\n      return 'about ' + hours + ' hours ago';\n    }\n    const min = Math.round(time / (60 * 1000));\n    if (min > 1) {\n      return 'about ' + min + ' minutes ago';\n    }\n    const sec = Math.round(time / 1000);\n    if (sec > 1) {\n      return 'about ' + sec + ' seconds ago';\n    }\n    return this.comment.time;\n  }\n}\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\nimport {Comment} from '../annotation-models'\nimport * as jquery from 'jquery';\n\nconst $ = jquery;\n\n@Component({\n  selector: 'gd-create-comment',\n  templateUrl: './create-comment.component.html',\n  styleUrls: ['./create-comment.component.less']\n})\nexport class CreateCommentComponent implements OnInit {\n  @Input() comment: Comment;\n\n  @Output() addComment = new EventEmitter<Comment>();\n  @Output() removeComment = new EventEmitter<boolean>();\n\n  constructor() {\n  }\n\n  ngOnInit() {\n    setTimeout(() => {\n      const element = $(\"#name\");\n      if (element) {\n        element.focus();\n      }\n    }, 100);\n  }\n\n  onAddComment() {\n    this.addComment.emit(this.comment);\n  }\n\n  clearComment() {\n    this.removeComment.emit(true);\n  }\n\n  saveText(value: string) {\n    this.comment.text = value;\n  }\n\n  saveName(value: string) {\n    this.comment.userName = value;\n  }\n}\n","import {APP_INITIALIZER, ModuleWithProviders, NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {\n  Api,\n  CommonComponentsModule,\n  ConfigService,\n  ErrorInterceptorService, LoadingMaskInterceptorService, LoadingMaskService\n} from \"@groupdocs.examples.angular/common-components\";\nimport {AnnotationConfigService} from \"./annotation-config.service\";\nimport {HTTP_INTERCEPTORS, HttpClientModule} from \"@angular/common/http\";\nimport {FontAwesomeModule} from \"@fortawesome/angular-fontawesome\";\nimport {ClickOutsideModule} from \"ng-click-outside\";\nimport {AnnotationAppComponent} from './annotation-app.component';\nimport {library} from \"@fortawesome/fontawesome-svg-core\";\nimport {fas} from \"@fortawesome/free-solid-svg-icons\";\nimport {far} from \"@fortawesome/free-regular-svg-icons\";\nimport {AnnotationComponent} from './annotation/annotation.component';\nimport {ActiveAnnotationService} from \"./active-annotation.service\";\nimport {RemoveAnnotationService} from \"./remove-annotation.service\";\nimport {CommentAnnotationService} from \"./comment-annotation.service\";\nimport {CommentPanelComponent} from './comment-panel/comment-panel.component';\nimport {CommentComponent} from './comment/comment.component';\nimport {CreateCommentComponent} from './create-comment/create-comment.component';\n\nexport function initializeApp(annotationConfigService: AnnotationConfigService) {\n  const result = () => annotationConfigService.load();\n  return result;\n}\n\n// NOTE: this is required during library compilation see https://github.com/angular/angular/issues/23629#issuecomment-440942981\n// @dynamic\nexport function setupLoadingInterceptor(service: LoadingMaskService) {\n  return new LoadingMaskInterceptorService(service);\n}\n\n@NgModule({\n  declarations: [AnnotationAppComponent, AnnotationComponent, CommentPanelComponent, CommentComponent, CreateCommentComponent,\n  ],\n  exports: [CommonComponentsModule, AnnotationAppComponent, AnnotationComponent, CommentPanelComponent, CommentComponent, CreateCommentComponent],\n  imports:\n    [CommonModule,\n      CommonComponentsModule,\n      HttpClientModule,\n      FontAwesomeModule,\n      ClickOutsideModule],\n  providers:\n    [\n      ConfigService,\n      AnnotationConfigService,\n      ActiveAnnotationService,\n      RemoveAnnotationService,\n      CommentAnnotationService,\n      {\n        provide: HTTP_INTERCEPTORS,\n        useClass: ErrorInterceptorService,\n        multi: true\n      },\n      {\n        provide: APP_INITIALIZER,\n        useFactory: initializeApp,\n        deps: [AnnotationConfigService], multi: true\n      },\n      LoadingMaskService,\n      {\n        provide: HTTP_INTERCEPTORS,\n        useFactory: setupLoadingInterceptor,\n        multi: true,\n        deps: [LoadingMaskService]\n      }\n    ],\n  entryComponents: [AnnotationComponent],\n})\n\nexport class AnnotationModule {\n  constructor() {\n    library.add(fas, far);\n  }\n\n  static forRoot(apiEndpoint: string): ModuleWithProviders {\n    Api.DEFAULT_API_ENDPOINT = apiEndpoint;\n    return {\n      ngModule: AnnotationModule\n    };\n  }\n}\n"]}