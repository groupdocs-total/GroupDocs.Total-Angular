!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/common"),require("@groupdocs.examples.angular/common-components"),require("rxjs"),require("@angular/common/http"),require("@fortawesome/angular-fontawesome"),require("ng-click-outside"),require("jquery"),require("@fortawesome/fontawesome-svg-core"),require("@fortawesome/free-solid-svg-icons"),require("@fortawesome/free-regular-svg-icons")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/annotation",["exports","@angular/core","@angular/common","@groupdocs.examples.angular/common-components","rxjs","@angular/common/http","@fortawesome/angular-fontawesome","ng-click-outside","jquery","@fortawesome/fontawesome-svg-core","@fortawesome/free-solid-svg-icons","@fortawesome/free-regular-svg-icons"],n):n(((t=t||self).groupdocs=t.groupdocs||{},t.groupdocs.examples=t.groupdocs.examples||{},t.groupdocs.examples.angular=t.groupdocs.examples.angular||{},t.groupdocs.examples.angular.annotation={}),t.ng.core,t.ng.common,t.commonComponents,t.rxjs,t.ng.common.http,t.angularFontawesome,t.ngClickOutside,t.jquery,t.fontawesomeSvgCore,t.freeSolidSvgIcons,t.freeRegularSvgIcons)}(this,(function(t,n,e,o,i,r,a,s,p,c,d,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var g=function(t,n){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function h(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}var f=function(){};var u=function(){function t(t,n){this._http=t,this._config=n,this._annotationConfig=new i.BehaviorSubject(new f),this._updatedConfig=this._annotationConfig.asObservable()}return Object.defineProperty(t.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),t.prototype.load=function(){var t=this;return new Promise((function(n,e){var i=t._config.getConfigEndpoint(o.Api.ANNOTATION_APP);t._http.get(i,o.Api.httpOptionsJson).toPromise().then((function(e){var o=e;t._annotationConfig.next(o),n()})).catch((function(t){e("Could not load annotation config: "+JSON.stringify(t))}))}))},t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:o.ConfigService}]},t.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new t(n.ɵɵinject(r.HttpClient),n.ɵɵinject(o.ConfigService))},token:t,providedIn:"root"}),t}();var m=function(){function t(t,n){this._http=t,this._config=n}return t.prototype.loadFiles=function(t){return this._http.post(this._config.getAnnotationApiEndpoint()+o.Api.LOAD_FILE_TREE,{path:t},o.Api.httpOptionsJson)},t.prototype.loadFile=function(t){return this._http.post(this._config.getAnnotationApiEndpoint()+o.Api.LOAD_DOCUMENT_DESCRIPTION,t,o.Api.httpOptionsJson)},t.prototype.upload=function(t,n,e){var i=new FormData;return i.append("file",t),i.append("rewrite",String(e)),n&&i.append("url",n),this._http.post(this._config.getAnnotationApiEndpoint()+o.Api.UPLOAD_DOCUMENTS,i)},t.prototype.loadPage=function(t,n){return this._http.post(this._config.getAnnotationApiEndpoint()+o.Api.LOAD_DOCUMENT_PAGE,{guid:t.guid,password:t.password,page:n},o.Api.httpOptionsJson)},t.prototype.getDownloadUrl=function(t){return this._config.getAnnotationApiEndpoint()+o.Api.DOWNLOAD_ANNOTATED+"/?path="+t.guid},t.prototype.annotate=function(t,n,e){var i={guid:t.guid,password:t.password,annotationsData:n,documentType:o.FileUtil.find(t.guid,!1).format,print:e};return this._http.post(this._config.getAnnotationApiEndpoint()+o.Api.ANNOTATE,i,o.Api.httpOptionsJson)},t.decorators=[{type:n.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:r.HttpClient},{type:o.ConfigService}]},t.ngInjectableDef=n.ɵɵdefineInjectable({factory:function(){return new t(n.ɵɵinject(r.HttpClient),n.ɵɵinject(o.ConfigService))},token:t,providedIn:"root"}),t}();var b=function(){function t(){}return t.getAnnotationType=function(n){switch(n){case t.TEXT.id:return t.TEXT;case t.AREA.id:return t.AREA;case t.POINT.id:return t.POINT;case t.TEXT_STRIKEOUT.id:return t.TEXT_STRIKEOUT;case t.POLYLINE.id:return t.POLYLINE;case t.TEXT_FIELD.id:return t.TEXT_FIELD;case t.WATERMARK.id:return t.WATERMARK;case t.TEXT_REPLACEMENT.id:return t.TEXT_REPLACEMENT;case t.ARROW.id:return t.ARROW;case t.TEXT_REDACTION.id:return t.TEXT_REDACTION;case t.TEXT_UNDERLINE.id:return t.TEXT_UNDERLINE;case t.DISTANCE.id:return t.DISTANCE}},t.TEXT={id:"textHighlight",name:"Text",icon:"highlighter"},t.AREA={id:"area",name:"Area",icon:"vector-square"},t.POINT={id:"point",name:"Point",icon:"thumbtack"},t.TEXT_STRIKEOUT={id:"textStrikeout",name:"Text strikeout",icon:"strikethrough"},t.POLYLINE={id:"polyline",name:"Polyline",icon:"signature"},t.TEXT_FIELD={id:"textField",name:"Text field",icon:"i-cursor"},t.WATERMARK={id:"watermark",name:"Watermark",icon:"tint"},t.TEXT_REPLACEMENT={id:"textReplacement",name:"Text replacement",icon:"edit"},t.ARROW={id:"arrow",name:"Arrow",icon:"mouse-pointer"},t.TEXT_REDACTION={id:"textRedaction",name:"Text redaction",icon:"brush"},t.TEXT_UNDERLINE={id:"textUnderline",name:"Text underline",icon:"underline"},t.DISTANCE={id:"distance",name:"Distance",icon:"ruler"},t}();!function(t){function n(){return null!==t&&t.apply(this,arguments)||this}(function(t,n){function e(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)})(n,t)}(o.PageModel);var y=function(){function t(t,n){this.left=t,this.top=n}return t.clone=function(n){return new t(n.left,n.top)},t}();var v=function(){function t(t,n){this.width=t,this.height=n}return t.prototype.isNone=function(){return 0===this.width&&0===this.height},t}();var x=function(){this.text="",this.fontColor=8421375};var w=function(t){this.id=t};var T=function(){function t(t){this.id=t,this.time=Date.now(),this.text="",this.userName=""}return t.create=function(n){var e=new t(n.id);return e.text=n.text,e.userName=n.userName,e.time=n.time,e},t}();var C=function(t){this.id=t};var A=function(){function t(){this._observer=new i.Subject,this._activeChange=this._observer.asObservable()}return Object.defineProperty(t.prototype,"activeChange",{get:function(){return this._activeChange},enumerable:!0,configurable:!0}),t.prototype.changeActive=function(t){this._observer.next(t)},t}();var P=function(){function t(){this._observer=new i.Subject,this._removeAnnotation=this._observer.asObservable()}return Object.defineProperty(t.prototype,"removeAnnotation",{get:function(){return this._removeAnnotation},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){this._observer.next(t)},t}();var E=function(){function t(){this._observer=new i.Subject,this._commentAnnotation=this._observer.asObservable(),this._observerAddComment=new i.Subject,this._addCommentObserve=this._observerAddComment.asObservable()}return Object.defineProperty(t.prototype,"commentAnnotation",{get:function(){return this._commentAnnotation},enumerable:!0,configurable:!0}),t.prototype.comment=function(t){this._observer.next(t)},Object.defineProperty(t.prototype,"addCommentObserve",{get:function(){return this._addCommentObserve},enumerable:!0,configurable:!0}),t.prototype.addComment=function(t){this._observerAddComment.next(t)},t}();var _=p,k=function(){function t(t,n,e,i){var r=this;this._activeAnnotationService=t,this._removeAnnotationService=n,this._commentAnnotationService=e,this._zoomService=i,this.active=!0,this.dimension=new v(0,0),this.textValue="",this.distanceValue="0px",this.pointsValue="",this.svgPath="",this.formatting=o.Formatting.default(),this.points=[],this._activeAnnotationService.activeChange.subscribe((function(t){r.active=r.id===t,r.active&&r.setTextFocus()}))}return t.isOnPage=function(t){var n=document.elementFromPoint(t.x,t.y);return n&&_(n).parent().parent()&&(_(n).parent().parent().parent().hasClass("page")||_(n).parent().parent().parent().parent().parent().hasClass("page"))},t.prototype.ngOnInit=function(){if(this.leftTop=y.clone(this.position),this.isPolyline())if(this.svgPath){var t=this.svgPath.replace("M","").split("L"),n=parseFloat(t[0].split(",")[0]),e=parseFloat(t[0].split(",")[1]),o=this;t.forEach((function(t,i){0!==i&&""!==t&&(o.addPoint(new y(n,e)),n+=parseFloat(t.split(",")[0]),e+=parseFloat(t.split(",")[1]))}))}else this.addPoint(this.position);else if(this.isPath()){if(this.svgPath||this.type===b.ARROW.id&&!this.dimension.isNone()){var i=new y(this.position.left+this.dimension.width,this.position.top+this.dimension.height);this.setEndPosition(i),this.dimension.height<0&&(this.leftTop.top+=this.dimension.height,this.dimension.height=-1*this.dimension.height),this.dimension.width<0&&(this.leftTop.left+=this.dimension.width,this.dimension.width=-1*this.dimension.width)}else this.setEndPosition(this.position);this.distanceValue=this.getDistance()+"px"}else this.type===b.POINT.id?this.initPoint():this.setEndPosition(this.position)},t.prototype.ngAfterViewInit=function(){this.setTextFocus()},t.prototype.ngAfterViewChecked=function(){this._zoomService.changeZoom(this._zoomService.zoom)},t.prototype.activation=function(){this._activeAnnotationService.changeActive(this.id)},t.prototype.width=function(t){this.checkDragging(t,0)&&(this.dimension.width+=t)},t.prototype.height=function(t){this.checkDragging(0,t)&&(this.dimension.height+=t)},t.prototype.left=function(t){this.position.left+=t,this.correctPosition(),this.refreshLeftTop()},t.prototype.top=function(t){this.position.top+=t,this.correctPosition(),this.refreshLeftTop()},t.prototype.refreshLeftTop=function(){this.leftTop.left=this.position.left,this.leftTop.top=this.position.top},t.prototype.correctPosition=function(){this.position.left<0&&(this.position.left=0),this.position.top<0&&(this.position.top=0),this.position.top+this.dimension.height>this.pageHeight&&(this.position.top=this.pageHeight-this.dimension.height),this.position.left+this.dimension.width>this.pageWidth&&(this.position.left=this.pageWidth-this.dimension.width)},t.prototype.dragOver=function(t){t.preventDefault(),t.stopPropagation()},t.prototype.dragStart=function(t){t.preventDefault(),this.oldPosition=o.Utils.getMousePosition(t),t.dataTransfer&&t.dataTransfer.setData("text","foo")},t.prototype.initPoint=function(){this.dimension=new v(40,40),this.position.left=this.position.left-20,this.position.top=this.position.top-20,this.leftTop=y.clone(this.position)},t.prototype.dragging=function(n){var e,i;n.preventDefault();var r=o.Utils.getMousePosition(n);if(r.x&&r.y&&t.isOnPage(r)){var a=r.x-this.oldPosition.x,s=r.y-this.oldPosition.y;if(this.isPolyline()){if(!this.checkDragging(a,s))return;this.pointsValue="";try{for(var p=h(this.points),c=p.next();!c.done;c=p.next()){var d=c.value;d.left=d.left+a,d.top=d.top+s,this.pointsValue+=d.left+","+d.top+" "}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=p.return)&&i.call(p)}finally{if(e)throw e.error}}this.leftTop.left+=a,this.leftTop.top+=s}else if(this.isPath()){if(!this.checkDragging(a,s))return;this.position.left+=a,this.position.top+=s,this.endPosition.left+=a,this.endPosition.top+=s,this.pathValue="M"+this.position.left+","+this.position.top+" L"+this.endPosition.left+","+this.endPosition.top,this.distanceValue=this.getDistance()+"px",this.leftTop.left+=a,this.leftTop.top+=s}else this.position.left+=a,this.position.top+=s,this.correctPosition(),this.refreshLeftTop();this.oldPosition=r}},t.prototype.getAnnotationClass=function(){switch(this.type){case b.TEXT.id:return"gd-annotation-wrapper-border gd-text-annotation";case b.TEXT_STRIKEOUT.id:return"gd-annotation-wrapper-border gd-text-annotation gd-text-strikeout-annotation";case b.TEXT_UNDERLINE.id:return"gd-annotation-wrapper-border gd-text-annotation gd-text-underline-annotation";case b.TEXT_REDACTION.id:return"gd-annotation-wrapper-border gd-text-redaction-annotation";case b.TEXT_REPLACEMENT.id:case b.TEXT_FIELD.id:case b.WATERMARK.id:return"gd-annotation-wrapper-border gd-text-replacement-annotation";case b.POINT.id:return"";default:return"gd-annotation-wrapper-border"}},t.prototype.isStrikeoutOrUnderline=function(){return this.type===b.TEXT_STRIKEOUT.id||this.type===b.TEXT_UNDERLINE.id},t.prototype.isTextReplacement=function(){return this.type===b.TEXT_REPLACEMENT.id},t.prototype.saveText=function(t){this.textValue=t},t.prototype.draw=function(t){this.onPage(t)&&(this.isPolyline()?this.addPoint(t):this.isPath()&&(this.setEndPosition(t),this.distanceValue=this.getDistance()+"px"),this.calcPositionAndDimension())},t.prototype.setStyles=function(){return{stroke:"#579AF0","stroke-width":2,"fill-opacity":0,id:(this.isPolyline()?"gd-polyline-annotation-":this.isDistance()?"gd-distance-annotation-":"gd-arrow-annotation-")+this.id,class:"annotation-svg"}},t.prototype.isPolyline=function(){return this.type===b.POLYLINE.id},t.prototype.calcPositionAndDimension=function(){var t,n,e=new y(Number.MAX_VALUE,Number.MAX_VALUE),o=new y(Number.MIN_VALUE,Number.MIN_VALUE);if(this.isPolyline())try{for(var i=h(this.points),r=i.next();!r.done;r=i.next()){var a=r.value;e.left=Math.min(a.left,e.left),e.top=Math.min(a.top,e.top),o.left=Math.max(a.left,o.left),o.top=Math.max(a.top,o.top)}}catch(n){t={error:n}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}else e.left=Math.min(this.position.left,this.endPosition.left),e.top=Math.min(this.position.top,this.endPosition.top),o.left=Math.max(this.position.left,this.endPosition.left),o.top=Math.max(this.position.top,this.endPosition.top);this.dimension.width=o.left-e.left,this.dimension.height=o.top-e.top,this.leftTop=e},t.prototype.calcDimensions=function(t){t.left<=this.pageWidth&&t.left>=0&&(this.dimension.width=t.left-this.position.left),t.top<=this.pageHeight&&t.top>=0&&(this.dimension.height=t.top-this.position.top)},t.prototype.getHeight=function(){return void 0===this.dimension.height?void 0:Math.abs(this.dimension.height)},t.prototype.getWidth=function(){return void 0===this.dimension.width?void 0:Math.abs(this.dimension.width)},t.prototype.checkDragging=function(t,n){return!(this.leftTop.left+t<0||this.leftTop.top+n<0||this.leftTop.top+n+this.dimension.height>this.pageHeight||this.leftTop.left+t+this.dimension.width>this.pageWidth)},t.prototype.isPoint=function(){return this.type===b.POINT.id},t.prototype.isSVG=function(){return this.type===b.POLYLINE.id||this.type===b.DISTANCE.id||this.type===b.ARROW.id},t.prototype.isDistance=function(){return this.type===b.DISTANCE.id},t.prototype.distanceTextOptions=function(){return{"font-size":"12px"}},t.prototype.isPath=function(){return this.type===b.DISTANCE.id||this.type===b.ARROW.id},t.prototype.setEndPosition=function(t){this.endPosition=y.clone(t),this.pathValue="M"+this.position.left+","+this.position.top+" L"+this.endPosition.left+","+this.endPosition.top},t.prototype.addPoint=function(t){this.points.push(t),this.pointsValue+=t.left+","+t.top+" "},t.prototype.getDistance=function(){var t=this.position.left-this.endPosition.left,n=this.position.top-this.endPosition.top;return Math.round(Math.sqrt(t*t+n*n))},t.prototype.bottom=function(){return"url("+window.location+"#end)"},t.prototype.head=function(){return this.isDistance()?"url("+window.location+"#start)":""},t.prototype.getTextX=function(){return this.getDistance()/2},t.prototype.isText=function(){return this.type===b.TEXT_FIELD.id||this.type===b.WATERMARK.id},t.prototype.getFormatting=function(){var t=this.formatting,n=o.Formatting.default();return t&&(n.fontSize=t.fontSize,n.font=t.font,n.color=t.color),n},t.prototype.saveFormatting=function(t){this.formatting.fontSize=t.fontSize,this.formatting.font=t.font,this.formatting.color=t.color},t.prototype.remove=function(){this._removeAnnotationService.remove(new C(this.id))},t.prototype.getMenuShift=function(){var t=this.isText()?265:111;return this.dimension.width>t?0:.5*(this.dimension.width-t)},t.prototype.getMenuType=function(){return o.MenuType.FOR_ANNOTATION},t.prototype.addComment=function(){this._commentAnnotationService.comment(new w(this.id))},t.prototype.setTextFocus=function(){var t=this;(this.isText()||this.isTextReplacement())&&setTimeout((function(){var n=_("#text-"+t.id);n&&n.focus()}),100)},t.prototype.textAreaHeight=function(t,n){this.dimension.height="Enter"===t?n.scrollHeight+this.formatting.fontSize:n.scrollHeight,this.dimension.width=n.scrollWidth},t.prototype.hideMenu=function(t){this._activeAnnotationService.changeActive(null)},t.prototype.getAnnotationData=function(){var t=new x;return t.id=this.id,t.text=this.textValue,t.fontColor=parseInt(o.Utils.toHex(this.formatting.color).replace("#",""),16),t.fontSize=this.formatting.fontSize,t.font=this.formatting.font,this.type===b.POINT.id?(t.left=this.leftTop.left+20,t.top=this.leftTop.top+20,t.height=0,t.width=0):(t.left=this.leftTop.left,t.top=this.leftTop.top,t.height=this.dimension.height,t.width=this.dimension.width),t.pageNumber=this.pageNumber,t.type=this.type,t.svgPath=this.getSvgPath(),t},t.prototype.getSvgPath=function(){var t,n,e="M";if(this.type===b.POLYLINE.id){var o=0,i=0,r=0;try{for(var a=h(this.points),s=a.next();!s.done;s=a.next()){var p=s.value;0===o?(e+=p.left+","+p.top+"l",o=1):e+=(i=p.left-i)+","+(r=p.top-r)+"l",i=p.left,r=p.top}}catch(n){t={error:n}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}else this.type===b.DISTANCE.id||this.type===b.ARROW.id?(e+=this.position.left+","+this.position.top+" ",e+=this.endPosition.left+","+this.endPosition.top+" "):e="";return e},t.prototype.onPage=function(t){return t.left<=this.pageWidth&&t.top<=this.pageHeight&&t.left>=0&&t.top>=0},t.decorators=[{type:n.Component,args:[{selector:"gd-annotation",template:'<div [hidden]="hidden" class="gd-annotation"\r\n     (clickOutside)="hideMenu($event)"\r\n     [exclude]="\'gd-context-menu,.ui-resizable-handle,.gd-comments-panel\'"\r\n     [excludeBeforeClick]="true"\r\n     [clickOutsideEvents]="\'mousedown\'"\r\n     [clickOutsideEnabled]="active"\r\n     [style.left.px]="leftTop.left" [style.top.px]="leftTop.top"\r\n     [style.width.px]="getWidth()"\r\n     [style.height.px]="getHeight()"\r\n     (click)="activation()"\r\n     (touchstart)="activation()">\r\n  <div [draggable]="true" (dragover)="dragOver($event)" (dragstart)="dragStart($event)"\r\n       (drag)="dragging($event)" (dragend)="dragging($event)" (drop)="dragOver($event)"\r\n       (panstart)="dragStart($event)" (panmove)="dragging($event)"\r\n       class="gd-annotation-wrapper" [ngClass]="getAnnotationClass()">\r\n    <gd-context-menu *ngIf="active" [topPosition]="position.top" [textMenu]="isText()" [formatting]="getFormatting()"\r\n                     (changeFormatting)="saveFormatting($event)" (removeItem)="remove()"\r\n                     [translation]="getMenuShift()" [menuType]="getMenuType()"\r\n                     (comment)="addComment()"></gd-context-menu>\r\n    <div class="gd-text-strikeout-line" *ngIf="isStrikeoutOrUnderline()"></div>\r\n    <textarea wrap="off" class="gd-text" *ngIf="isTextReplacement() || isText()" [value]="textValue"\r\n              id="{{\'text-\' + id}}" #text (keyup)="saveText(text.value)"\r\n              (keydown)="textAreaHeight($event.key, text)"\r\n              [style.color]="formatting?.color"\r\n              [style.font-family]="formatting?.font"\r\n              [style.font-size.px]="formatting?.fontSize"\r\n              [style.width.px]="getWidth()"\r\n              [style.height.px]="getHeight()">{{textValue}}</textarea>\r\n    <div *ngIf="isPoint()" class="gd-point">\r\n      <fa-icon class="icon" [icon]="[\'fas\',\'thumbtack\']" [size]="\'lg\'"></fa-icon>\r\n    </div>\r\n  </div>\r\n\r\n  <gd-resizing [id]="id" *ngIf="active && !isSVG() && !isPoint()"\r\n               (offsetX)="width($event)" (offsetY)="height($event)"\r\n               (offsetTop)="top($event)" (offsetLeft)="left($event)"\r\n               [se]="true" [sw]="true" [ne]="true" [nw]="true"\r\n               [pageHeight]="pageHeight" [pageWidth]="pageWidth"></gd-resizing>\r\n</div>\r\n<svg *ngIf="isSVG() && !hidden" class="svg" xmlns="http://www.w3.org/2000/svg">\r\n  <polyline *ngIf="isPolyline()" [attr.id]="id" [attr.points]="pointsValue" [ngStyle]="setStyles()">\r\n  </polyline>\r\n  <path id="{{\'gd-path-\' + id}}" *ngIf="isPath()" [attr.d]="pathValue" [attr.marker-end]="bottom()"\r\n        [attr.marker-start]="head()" [ngStyle]="setStyles()">\r\n    <title *ngIf="isDistance()" [ngStyle]="distanceTextOptions()">{{ distanceValue }}</title>\r\n  </path>\r\n  <text *ngIf="isDistance()" [ngStyle]="distanceTextOptions()" [attr.x]="getTextX()"\r\n        [attr.y]="0">\r\n    <textPath [attr.href]="\'#gd-path-\' + id">\r\n      {{ distanceValue }}\r\n    </textPath>\r\n  </text>\r\n</svg>\r\n',styles:[".gd-annotation{position:absolute!important;cursor:pointer;z-index:9}.gd-annotation .gd-annotation-wrapper-border{outline:#679ffa solid 1px;display:-webkit-box}.gd-annotation .gd-annotation-wrapper{height:inherit;z-index:9}.gd-annotation .gd-annotation-wrapper ::ng-deep .palette{width:0;height:37px}.gd-annotation .gd-annotation-wrapper .gd-text-strikeout-line{background-color:#e04e4e;height:2px;width:100%}.gd-annotation .gd-annotation-wrapper .gd-text{border:none;outline:0;margin:0;padding:0;overflow:hidden;background-color:transparent;min-width:1em;min-height:1em}.gd-annotation .gd-annotation-wrapper .gd-point{background-color:#7cbc46;width:41px;height:41px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;color:#fff;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;-khtml-border-radius:50%;box-shadow:0 1px 1px 1px #bbb;-moz-box-shadow:0 1px 1px 1px #bbb;-webkit-box-shadow:0 1px 1px 1px #bbb}.gd-annotation .gd-text-annotation{background-color:rgba(151,151,240,.51)}.gd-annotation .gd-text-strikeout-annotation{align-items:center;-webkit-box-align:center}.gd-annotation .gd-text-underline-annotation{align-items:end;-webkit-box-align:end}.gd-annotation .gd-text-redaction-annotation{background-color:#000}.gd-annotation .gd-text-replacement-annotation{background-color:#fff}.svg{z-index:1;position:absolute;top:0;left:0;width:100%;height:100%}.annotation-svg{position:absolute;cursor:pointer;z-index:2}"]}]}],t.ctorParameters=function(){return[{type:A},{type:P},{type:E},{type:o.ZoomService}]},t}();var O=p,I=function(){function t(t,n,e,i,r,a,s,p,c,d,l,g,h,f,u){var m=this;this._annotationService=t,this._modalService=n,this._navigateService=e,this._tabActivatorService=i,this._hostingComponentsService=r,this._addDynamicComponentService=a,this._activeAnnotationService=s,this._removeAnnotationService=p,this._commentAnnotationService=c,this._windowService=h,this._zoomService=f,this.title="annotation",this.files=[],this.browseFilesModal=o.CommonModals.BrowseFiles,this.formatDisabled=!this.file,this.annotationTypes=[b.TEXT,b.TEXT_STRIKEOUT,b.TEXT_UNDERLINE,b.TEXT_REPLACEMENT,b.TEXT_REDACTION,b.POLYLINE,b.ARROW,b.DISTANCE,b.AREA,b.TEXT_FIELD,b.WATERMARK,b.POINT],this.annotationTypeFirst=[b.TEXT,b.TEXT_UNDERLINE,b.TEXT_REDACTION,b.TEXT_REPLACEMENT,b.TEXT_STRIKEOUT],this.annotationTypeSecond=[b.POLYLINE,b.ARROW,b.DISTANCE,b.AREA,b.POINT],this.annotationTypeThird=[b.TEXT_FIELD,b.WATERMARK],this.countPages=0,this.comments=new Map,this._zoom=100,this.fileWasDropped=!1,this.annotations=new Map,u.updatedConfig.subscribe((function(t){m.annotationConfig=t})),this.isDesktop=h.isDesktop(),h.onResize.subscribe((function(t){m.isDesktop=h.isDesktop(),m.isDesktop||m.refreshZoom()})),this._activeAnnotationService.activeChange.subscribe((function(t){m.activeAnnotationId!==t&&(m.commentOpenedId=null,m.activeAnnotationId=t)})),this._commentAnnotationService.commentAnnotation.subscribe((function(t){m.commentOpenedId=t.id,m.comments.get(m.commentOpenedId)||m.comments.set(m.commentOpenedId,[])})),this._commentAnnotationService.addCommentObserve.subscribe((function(t){m.comments.get(m.commentOpenedId).push(t)})),this._removeAnnotationService.removeAnnotation.subscribe((function(t){var n=m.annotations.get(t.id);n&&n.destroy(),m.annotations.delete(t.id),m.commentOpenedId===t.id&&(m.commentOpenedId=null),m.comments.delete(t.id)})),d.uploadsChange.subscribe((function(t){if(t){var n=void 0;for(n=0;n<t.length;n++)m._annotationService.upload(t.item(n),"",m.rewriteConfig).subscribe((function(t){m.fileWasDropped?m.selectFile(t.guid,"",""):m.selectDir("")}))}})),l.checkPreload.subscribe((function(t){if(0!==m.preloadPageCountConfig)for(var n=t;n<t+2;n++)n>0&&n<=m.countPages&&!m.file.pages[n-1].data&&m.preloadPages(n,n)})),g.passChange.subscribe((function(t){m.selectFile(m.credentials.guid,t,o.CommonModals.PasswordRequired)})),this.isDesktop=h.isDesktop(),h.onResize.subscribe((function(t){m.isDesktop=h.isDesktop()}))}return t.prototype.getComments=function(){return this.comments.get(this.commentOpenedId)},Object.defineProperty(t.prototype,"rewriteConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"zoomConfig",{get:function(){return!!this.annotationConfig&&this.annotationConfig.zoom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSelectorConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.pageSelector},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preloadPageCountConfig",{get:function(){return this.annotationConfig?this.annotationConfig.preloadPageCount:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downloadConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downloadOriginalConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.downloadOriginal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downloadAnnotatedConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.downloadAnnotated},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uploadConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.upload},enumerable:!0,configurable:!0}),t.prototype.defaultDocumentConfig=function(){return this.annotationConfig?this.annotationConfig.defaultDocument:""},Object.defineProperty(t.prototype,"printConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.print},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"browseConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"htmlModeConfig",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableRightClickConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.enableRightClick},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"areaAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.areaAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.pointAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textStrikeoutAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textStrikeoutAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"polylineAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.polylineAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textFieldAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textFieldAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"watermarkAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.watermarkAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textReplacementAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textReplacementAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"arrowAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.arrowAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textRedactionAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textRedactionAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textUnderlineAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.textUnderlineAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceAnnotationConfig",{get:function(){return!this.annotationConfig||this.annotationConfig.distanceAnnotation},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){""!==this.annotationConfig.defaultDocument&&(this.isLoading=!0,this.selectFile(this.annotationConfig.defaultDocument,"",""))},t.prototype.ptToPx=function(t){return 96*t/72},t.prototype.getFitToWidth=function(){var t=this.ptToPx(this._pageWidth),n=this.ptToPx(this._pageHeight),e=t||window.innerWidth;return n>t&&Math.round(e/window.innerWidth)<2?200-Math.round(100*e/window.innerWidth):Math.round(100*window.innerWidth/e)},Object.defineProperty(t.prototype,"zoom",{get:function(){return this._zoom},set:function(t){this._zoom=t,this._zoomService.changeZoom(this._zoom)},enumerable:!0,configurable:!0}),t.prototype.refreshZoom=function(){this.zoom=this._windowService.isDesktop()?100:this.getFitToWidth()},t.prototype.zoomIn=function(){this.formatDisabled||this._zoom<490&&(this.zoom=this._zoom+10)},t.prototype.zoomOut=function(){this.formatDisabled||this._zoom>30&&(this.zoom=this._zoom-10)},t.prototype.openModal=function(t){this._modalService.open(t)},t.prototype.closeModal=function(t){this._modalService.close(t)},t.prototype.selectDir=function(t){var n=this;this._annotationService.loadFiles(t).subscribe((function(t){return n.files=t||[]}))},t.prototype.selectFile=function(t,n,e){var i=this;this.credentials=new o.FileCredentials(t,n),this.file=null,this.commentOpenedId=null,this._annotationService.loadFile(this.credentials).subscribe((function(t){if(i.cleanAnnotations(),i.file=t,i.formatDisabled=!i.file,t){!i.isDesktop&&t.pages&&t.pages[0]&&(i._pageHeight=t.pages[0].height,i._pageWidth=t.pages[0].width,i.refreshZoom());var n=i.preloadPageCountConfig,e=t.pages?t.pages.length:0;n>0?i.preloadPages(1,n>e?e:n):setTimeout((function(){var t,n;try{for(var e=h(i.file.pages),o=e.next();!o.done;o=e.next()){var r=o.value;i.importAnnotations(r.annotations?r.annotations:[])}}catch(n){t={error:n}}finally{try{o&&!o.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}}),100),i._navigateService.countPages=e,i._navigateService.currentPage=1,i.countPages=e}})),e&&this._modalService.close(e),this.clearData()},t.prototype.preloadPages=function(t,n){for(var e=this,o=function(t){i._annotationService.loadPage(i.credentials,t).subscribe((function(n){e.file.pages[t-1]=n,setTimeout((function(){e.importAnnotations(n.annotations?n.annotations:[])}),100)}))},i=this,r=t;r<=n;r++)o(r)},t.prototype.importAnnotations=function(t){var n,e;try{for(var o=h(t),i=o.next();!i.done;i=o.next()){var r=i.value,a=new y(r.left,r.top),s=this.addAnnotationComponent(r.pageNumber,a,r);this.comments.set(s,r.comments),this._activeAnnotationService.changeActive(s)}}catch(t){n={error:t}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}},t.prototype.upload=function(t){var n=this;this._annotationService.upload(null,t,this.rewriteConfig).subscribe((function(){n.selectDir("")}))},t.prototype.onRightClick=function(t){return this.enableRightClickConfig},t.prototype.downloadFile=function(){this.formatDisabled||window.location.assign(this._annotationService.getDownloadUrl(this.credentials))},t.prototype.annotate=function(){var t=this,n=this.prepareAnnotationsData();this._annotationService.annotate(this.credentials,n,!1).subscribe((function(n){t._modalService.open(o.CommonModals.OperationSuccess),t.selectFile(n.guid,t.credentials.password,o.CommonModals.OperationSuccess)}))},t.prototype.prepareAnnotationsData=function(){var t,n,e=[];try{for(var o=h(this.annotations.values()),i=o.next();!i.done;i=o.next()){var r=i.value.instance.getAnnotationData();r.comments=this.comments.get(r.id),e.push(r)}}catch(n){t={error:n}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e},t.prototype.isVisible=function(t){var n=!this.file||this.file&&this.file.supportedAnnotations&&this.file.supportedAnnotations.find((function(n){return t===n}));return this.getAnnotationTypeConfig(t)&&n},t.prototype.activeTab=function(t){this.activeAnnotationTab&&t===this.activeAnnotationTab?this.activeAnnotationTab=null:this.activeAnnotationTab=t},t.prototype.codesConfigFirst=function(){return this.checkConfig(this.annotationTypeFirst)},t.prototype.codesConfigSecond=function(){return this.checkConfig(this.annotationTypeSecond)},t.prototype.checkConfig=function(t){var n,e;try{for(var o=h(t),i=o.next();!i.done;i=o.next()){var r=i.value;if(this.getAnnotationTypeConfig(r.id))return!0}}catch(t){n={error:t}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(n)throw n.error}}return!1},t.prototype.codesConfigThird=function(){return this.getAnnotationTypeConfig(b.TEXT_FIELD.id)&&this.getAnnotationTypeConfig(b.WATERMARK.id)},t.prototype.getAnnotationTypeConfig=function(t){switch(t){case b.TEXT.id:return this.textAnnotationConfig;case b.AREA.id:return this.areaAnnotationConfig;case b.POINT.id:return this.pointAnnotationConfig;case b.TEXT_STRIKEOUT.id:return this.textStrikeoutAnnotationConfig;case b.POLYLINE.id:return this.polylineAnnotationConfig;case b.TEXT_FIELD.id:return this.textFieldAnnotationConfig;case b.WATERMARK.id:return this.watermarkAnnotationConfig;case b.TEXT_REPLACEMENT.id:return this.textReplacementAnnotationConfig;case b.ARROW.id:return this.arrowAnnotationConfig;case b.TEXT_REDACTION.id:return this.textRedactionAnnotationConfig;case b.TEXT_UNDERLINE.id:return this.textUnderlineAnnotationConfig;case b.DISTANCE.id:return this.distanceAnnotationConfig}},t.prototype.fileDropped=function(t){this.fileWasDropped=t},t.prototype.cleanAnnotations=function(){var t,n;try{for(var e=h(this.annotations.values()),o=e.next();!o.done;o=e.next()){o.value.destroy()}}catch(n){t={error:n}}finally{try{o&&!o.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}this.annotations=new Map,this.comments=new Map},t.prototype.hideAnnotations=function(){var t,n;try{for(var e=h(this.annotations.values()),o=e.next();!o.done;o=e.next()){var i=o.value;this.annotationsHidden=i.instance.hidden=!i.instance.hidden}}catch(n){t={error:n}}finally{try{o&&!o.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}},t.prototype.clearData=function(){var t,n;if(this.file&&this.file.pages)try{for(var e=h(this.file.pages),o=e.next();!o.done;o=e.next()){o.value.data=null}}catch(n){t={error:n}}finally{try{o&&!o.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}},t.prototype.createAnnotation=function(t){if(("svg"===t.target.classList[0]||"gd-page-image"===t.target.classList[0])&&(this.activeAnnotationTab&&t.preventDefault(),this.activeAnnotationTab)){var n=o.Utils.getMousePosition(t),e=document.elementsFromPoint(n.x,n.y).find((function(t){return t.id&&t.id.startsWith("page-")}));if(e){var i=O(e).parent().parent()[0],r=this.getCurrentPosition(n,O(i)),a=e.id,s=1;if(a){var p=a.split("-");s=2===p.length?parseInt(p[1],10):s}var c=this.addAnnotationComponent(s,r,null);this._activeAnnotationService.changeActive(c),this.creatingAnnotationId=c}}},t.prototype.addAnnotationComponent=function(t,n,e){var i=this._hostingComponentsService.find(t);if(i){var r=i.viewContainerRef,a=this._addDynamicComponentService.addDynamicComponent(r,k),s=this.getNextId();if(a.instance.id=s,a.instance.position=n,a.instance.pageNumber=t,e){var p=new v(e.width,e.height),c=b.getAnnotationType(e.type),d=o.Formatting.default();d.fontSize=e.fontSize,e.fontColor&&(d.color="#"+e.fontColor.toString(16)),d.font=e.font,a.instance.type=c?c.id:e.type,a.instance.dimension=p,a.instance.svgPath=e.svgPath,a.instance.textValue=e.text,d&&a.instance.saveFormatting(d)}else a.instance.type=this.activeAnnotationTab;var l=this.file.pages.find((function(n){return n.number===t}));return a.instance.pageWidth=l.width,a.instance.pageHeight=l.height,a.instance.hidden=this.annotationsHidden,this.annotations.set(s,a),s}return null},t.prototype.resizingCreatingAnnotation=function(t){if(this.activeAnnotationTab&&t.preventDefault(),this.creatingAnnotationId){var n=o.Utils.getMousePosition(t),e=this.annotations.get(this.creatingAnnotationId),i=e.instance.type,r=e.instance.pageNumber,a=this.getCurrentPosition(n,O("#page-"+r));i===b.POLYLINE.id||i===b.DISTANCE.id||i===b.ARROW.id?e.instance.draw(a):i!==b.POINT.id&&e.instance.calcDimensions(a)}},t.prototype.getCurrentPosition=function(t,n){var e=(t.x-n.offset().left)/(this.zoom/100),o=(t.y-n.offset().top)/(this.zoom/100);return new y(e,o)},t.prototype.finishCreatingAnnotation=function(t){this.activeAnnotationTab&&t.preventDefault(),this.creatingAnnotationId&&(this._activeAnnotationService.changeActive(this.creatingAnnotationId),this.creatingAnnotationId=null)},t.prototype.closeComments=function(){this.commentOpenedId=null},t.prototype.onPan=function(t){this._zoomService.changeZoom(this._zoom)},t.prototype.getNextId=function(){var t,n,e=0;try{for(var o=h(this.annotations.keys()),i=o.next();!i.done;i=o.next()){var r=i.value;r>e&&(e=r)}}catch(n){t={error:n}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e+1},t.decorators=[{type:n.Component,args:[{selector:"gd-annotation-app",template:'<gd-loading-mask [loadingMask]="isLoading"></gd-loading-mask>\r\n<div class="wrapper" (contextmenu)="onRightClick($event)">\r\n  <div class="annotation-wrapper wrapper">\r\n    <gd-tabbed-toolbars [logo]="\'annotation\'" [icon]="\'pen-square\'">\r\n      <gd-tabs>\r\n        <gd-tab [tabTitle]="\'File\'" [icon]="\'folder-open\'" [id]="\'1\'" [active]="true">\r\n          <div id="files-tools" class="toolbar-panel">\r\n            <gd-button [icon]="\'folder-open\'" [tooltip]="\'Browse files\'" (click)="openModal(browseFilesModal)"\r\n                       *ngIf="browseConfig"></gd-button>\r\n\r\n            <gd-button [disabled]="formatDisabled" [icon]="\'download\'" [tooltip]="\'Download\'"\r\n                       (click)="downloadFile()" *ngIf="downloadConfig"></gd-button>\r\n            <gd-button [disabled]="formatDisabled" [icon]="\'save\'" [tooltip]="\'Save\'" (click)="annotate()"></gd-button>\r\n            <gd-button class="desktop-hide" [disabled]="formatDisabled" [icon]="\'search-plus\'" [tooltip]="\'Zoom In\'"\r\n              (click)="zoomIn()" *ngIf="zoomConfig"></gd-button>\r\n            <gd-button class="desktop-hide" [disabled]="formatDisabled" [icon]="\'search-minus\'" [tooltip]="\'Zoom Out\'"\r\n              (click)="zoomOut()" *ngIf="zoomConfig"></gd-button>\r\n            <gd-button [disabled]="formatDisabled" [icon]="annotationsHidden ? \'toggle-off\' : \'toggle-on\'" [tooltip]="\'Hide annotations\'" (click)="hideAnnotations()"></gd-button>\r\n          </div>\r\n        </gd-tab>\r\n        <gd-tab [tabTitle]="\'Annotations\'" [icon]="\'highlighter\'" [id]="\'2\'"\r\n                *ngIf="isDesktop || (!isDesktop && codesConfigFirst())">\r\n          <div class="toolbar-panel">\r\n            <div *ngFor="let annotationType of (isDesktop ? annotationTypes : annotationTypeFirst)">\r\n              <gd-top-tab [disabled]="!file" *ngIf="isVisible(annotationType.id)"\r\n                          [icon]="annotationType.icon" (activeTab)="activeTab($event)"\r\n                          [id]="annotationType.id" [tooltip]="annotationType.name">\r\n              </gd-top-tab>\r\n            </div>\r\n          </div>\r\n        </gd-tab>\r\n        <gd-tab [tabTitle]="\'\'" [icon]="\'vector-square\'" [id]="\'3\'" *ngIf="!isDesktop && codesConfigSecond()">\r\n          <div class="toolbar-panel">\r\n            <div *ngFor="let annotationType of annotationTypeSecond">\r\n              <gd-top-tab [disabled]="!file" *ngIf="isVisible(annotationType.id)"\r\n                          [icon]="annotationType.icon" (activeTab)="activeTab($event)"\r\n                          [id]="annotationType.id" [tooltip]="annotationType.name">\r\n              </gd-top-tab>\r\n            </div>\r\n          </div>\r\n        </gd-tab>\r\n        <gd-tab [tabTitle]="\'\'" [icon]="\'i-cursor\'" [id]="\'4\'" *ngIf="!isDesktop && codesConfigThird()">\r\n          <div class="toolbar-panel">\r\n            <div *ngFor="let annotationType of annotationTypeThird">\r\n              <gd-top-tab [disabled]="!file" *ngIf="isVisible(annotationType.id)"\r\n                          [icon]="annotationType.icon" (activeTab)="activeTab($event)"\r\n                          [id]="annotationType.id" [tooltip]="annotationType.name">\r\n              </gd-top-tab>\r\n            </div>\r\n          </div>\r\n        </gd-tab>\r\n      </gd-tabs>\r\n    </gd-tabbed-toolbars>\r\n    <div class="doc-panel" *ngIf="file" (mousedown)="createAnnotation($event)"\r\n         (mousemove)="resizingCreatingAnnotation($event)" (mouseup)="finishCreatingAnnotation($event)"\r\n         (touchstart)="!isDesktop ? createAnnotation($event) : \'\'" (touchmove)="resizingCreatingAnnotation($event)"\r\n         (touchend)="finishCreatingAnnotation($event)"\r\n         (panstart)="!isDesktop ? createAnnotation($event) : \'\'" (panmove)="resizingCreatingAnnotation($event)"\r\n         (panend)="finishCreatingAnnotation($event)">\r\n      <gd-document class="gd-document" *ngIf="file" [file]="file" [mode]="htmlModeConfig" gdScrollable\r\n                   [preloadPageCount]="preloadPageCountConfig" gdRenderPrint [htmlMode]="htmlModeConfig" (onpan)="onPan($event)"></gd-document>\r\n    </div>\r\n    <gd-comment-panel *ngIf="commentOpenedId" [annotationId]="commentOpenedId"\r\n                      [comments]="getComments()" (closeComments)="closeComments()">\r\n    </gd-comment-panel>\r\n\r\n    <gd-init-state [icon]="\'highlighter\'" [text]="\'Drop file here to upload\'" *ngIf="!file"\r\n                   (fileDropped)="fileDropped($event)">\r\n      Click\r\n      <fa-icon [icon]="[\'fas\',\'folder-open\']"></fa-icon>\r\n      to open file<br>\r\n      Or drop file here\r\n    </gd-init-state>\r\n  </div>\r\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\r\n                         (selectedFileGuid)="selectFile($event, null, browseFilesModal)"\r\n                         [uploadConfig]="uploadConfig"></gd-browse-files-modal>\r\n\r\n  <gd-error-modal></gd-error-modal>\r\n  <gd-password-required></gd-password-required>\r\n  <gd-success-modal></gd-success-modal>\r\n  <svg class="svg" xmlns="http://www.w3.org/2000/svg">\r\n    <defs xmlns="http://www.w3.org/2000/svg">\r\n      <marker id="end" orient=\'auto\' markerWidth=\'20\' markerHeight=\'20\'\r\n              refX="10" refY="10" markerUnits="strokeWidth">\r\n        <path d=\'M0,7 L0,13 L12,10 z\' fill=\'#579AF0\'></path>\r\n      </marker>\r\n      <marker id="start" orient=\'auto\' markerWidth=\'20\' markerHeight=\'20\'\r\n              refX="0" refY="10" markerUnits="strokeWidth">\r\n        <path d=\'M12,7 L12,13 L0,10 z\' fill=\'#579AF0\'></path>\r\n      </marker>\r\n    </defs>\r\n  </svg>\r\n</div>\r\n',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}::ng-deep .page{position:relative}::ng-deep .gd-page-image{width:unset;height:unset}::ng-deep .top-panel{align-content:flex-start}.wrapper{-webkit-box-align:stretch;align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.doc-panel{display:-webkit-box;display:flex;height:inherit}.gd-document{width:100%;height:calc(100% - 90px)}.toolbar-panel{width:100%;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.annotation-wrapper ::ng-deep .button{color:#3e4e5a!important}.annotation-wrapper ::ng-deep .button .text{padding:0!important}.annotation-wrapper ::ng-deep .select{color:#3e4e5a!important}.desktop-hide{display:none}@media (max-width:1037px){::ng-deep .logo ::ng-deep .icon{font-size:24px!important}::ng-deep .top-panel{height:120px!important}::ng-deep .toolbar-panel .gd-tab,::ng-deep .toolbar-panel ::ng-deep .button{height:60px;line-height:60px;width:60px;margin:0!important}.desktop-hide{display:block}.gd-document{height:calc(100% - 120px)}::ng-deep .bcPicker-palette{position:absolute;left:-80px!important;top:-170px!important}::ng-deep .gd-comments-panel .gd-comments-body{-webkit-box-pack:center;justify-content:center}::ng-deep .gd-comments-panel .gd-comments-body .gd-empty-comments-list{width:unset!important;margin-top:unset!important}}"]}]}],t.ctorParameters=function(){return[{type:m},{type:o.ModalService},{type:o.NavigateService},{type:o.TopTabActivatorService},{type:o.HostingDynamicComponentService},{type:o.AddDynamicComponentService},{type:A},{type:P},{type:E},{type:o.UploadFilesService},{type:o.PagePreloadService},{type:o.PasswordService},{type:o.WindowService},{type:o.ZoomService},{type:u}]},t}();var S=function(){function t(t){this._commentAnnotationService=t,this.closeComments=new n.EventEmitter}return t.prototype.ngOnInit=function(){},t.prototype.closePanel=function(){this.closeComments.emit(!0)},t.prototype.newComment=function(){this.currentComment=new T(this.annotationId)},t.prototype.clearComment=function(){this.currentComment=null},t.prototype.addComment=function(){this._commentAnnotationService.addComment(T.create(this.currentComment)),this.currentComment=null},t.decorators=[{type:n.Component,args:[{selector:"gd-comment-panel",template:'<div class="gd-comments-panel">\r\n  <div class="gd-comments-head">\r\n    <fa-icon [icon]="[\'fas\', \'plus\']" [class]="\'ng-fa-icon icon\'" (click)="newComment()"></fa-icon>\r\n    <span class="gd-comments-title">Comments</span>\r\n    <fa-icon [icon]="[\'fas\', \'times\']" [class]="\'ng-fa-icon icon\'" (click)="closePanel()"></fa-icon>\r\n  </div>\r\n  <div class="gd-comments-body">\r\n    <div *ngIf="comments.length != 0">\r\n      <div *ngFor="let comment of comments">\r\n        <gd-comment [comment]="comment"></gd-comment>\r\n      </div>\r\n    </div>\r\n    <gd-create-comment *ngIf="currentComment" [comment]="currentComment" (addComment)="addComment()"\r\n                       (removeComment)="clearComment()"></gd-create-comment>\r\n    <div class="gd-empty-comments-list" *ngIf="comments.length == 0 && !currentComment">\r\n      <fa-icon [icon]="[\'fas\',\'comments\']" [class]="\'ng-fa-icon icon\'"></fa-icon>\r\n      <span class="gd-empty-text">No comments yet. Be the first one, <br/>\r\n        </span>\r\n      <span class="gd-empty-text gd-empty-bold-text">add comment.</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n',styles:[".gd-comments-panel{position:absolute;right:0;top:30px;overflow:auto!important;width:334px;display:-webkit-box;display:flex;height:100%;z-index:9;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.gd-comments-panel .gd-comments-head{height:60px;width:334px;display:-webkit-box;display:flex;background-color:#222e35;color:#959da5;-webkit-box-align:center;align-items:center}.gd-comments-panel .gd-comments-head>fa-icon:nth-child(1){font-size:24px}.gd-comments-panel .gd-comments-head .icon{-webkit-box-flex:0;flex:0 0 40px;margin-left:20px;cursor:pointer}.gd-comments-panel .gd-comments-head .gd-comments-title{-webkit-box-flex:1;flex:1;font-size:13px;font-weight:700}.gd-comments-panel .gd-comments-body{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center;background-color:#f4f4f4;height:calc(100% - 90px)}.gd-comments-panel .gd-comments-body .gd-empty-comments-list{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;color:#959da5;width:250px;height:250px;margin-top:40px}.gd-comments-panel .gd-comments-body .gd-empty-comments-list .icon{font-size:65px;margin-bottom:40px}.gd-comments-panel .gd-comments-body .gd-empty-comments-list .gd-empty-text{font-size:15px}.gd-comments-panel .gd-comments-body .gd-empty-comments-list .gd-empty-bold-text{font-weight:700}@media (max-width:1037px){.gd-comments-panel{top:0;width:100%}.gd-comments-panel .gd-comments-body{height:100%!important;-webkit-box-align:initial;align-items:initial;width:calc(100% - 40px);padding:0 20px}.gd-comments-panel .gd-comments-head{width:100%;line-height:60px}}"]}]}],t.ctorParameters=function(){return[{type:E}]},t.propDecorators={comments:[{type:n.Input}],annotationId:[{type:n.Input}],closeComments:[{type:n.Output}]},t}();var D=function(){function t(){}return t.prototype.ngOnInit=function(){},t.prototype.getTime=function(){var t=Date.now()-this.comment.time,n=Math.round(t/36e5);if(n>1)return"about "+n+" hours ago";var e=Math.round(t/6e4);if(e>1)return"about "+e+" minutes ago";var o=Math.round(t/1e3);return o>1?"about "+o+" seconds ago":this.comment.time},t.decorators=[{type:n.Component,args:[{selector:"gd-comment",template:'<div class="gd-comment">\r\n  <div class="gd-comment-head">\r\n    <fa-icon [icon]="[\'fas\', \'user-circle\']" [class]="\'ng-fa-icon icon\'"></fa-icon>\r\n    <span class="gd-name">{{comment.userName}}</span>\r\n  </div>\r\n  <span class="gd-message">{{comment.text}}</span>\r\n  <span class="gd-time">{{getTime()}}</span>\r\n</div>\r\n',styles:[".gd-comment{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;width:294px;font-size:13px;color:#3e4e5a;padding-top:20px}.gd-comment .gd-comment-head{display:-webkit-box;display:flex}.gd-comment .gd-comment-head .icon{-webkit-box-flex:0;flex:0 0 30px;font-size:18px}.gd-comment .gd-comment-head .gd-name{font-weight:700;line-height:21px}.gd-comment .gd-message{padding-top:5px;overflow:hidden;text-overflow:ellipsis}.gd-comment .gd-time{color:#acacac;padding-top:5px}@media (max-width:1037px){.gd-comment{width:100%}}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={comment:[{type:n.Input}]},t}();var N=p,R=function(){function t(){this.addComment=new n.EventEmitter,this.removeComment=new n.EventEmitter}return t.prototype.ngOnInit=function(){setTimeout((function(){var t=N("#name");t&&t.focus()}),100)},t.prototype.onAddComment=function(){this.addComment.emit(this.comment)},t.prototype.clearComment=function(){this.removeComment.emit(!0)},t.prototype.saveText=function(t){this.comment.text=t},t.prototype.saveName=function(t){this.comment.userName=t},t.decorators=[{type:n.Component,args:[{selector:"gd-create-comment",template:'<div class="gd-new-comment">\r\n  <input type="text" class="gd-name" id="name" [value]="comment.userName" #name autofocus (keyup)="saveName(name.value)" placeholder="Name"/>\r\n  <textarea class="gd-text" [value]="comment.text" #text (keyup)="saveText(text.value)" placeholder="Message"></textarea>\r\n  <div class="gd-buttons">\r\n    <gd-button (click)="clearComment()" [iconOnly]="false" class="gd-cancel-comment">\r\n      Cancel\r\n    </gd-button>\r\n    <gd-button (click)="onAddComment()" [icon]="\'share\'" class="gd-add-comment" [iconOnly]="false">\r\n      Reply\r\n    </gd-button>\r\n  </div>\r\n</div>\r\n',styles:[".gd-new-comment{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;padding-top:20px;width:294px;font-size:14px}.gd-new-comment ::ng-deep .button{padding:0!important;width:96px}.gd-new-comment ::ng-deep .button .text{font-size:12px!important}.gd-new-comment ::ng-deep .button fa-icon{font-size:14px}.gd-new-comment .gd-buttons{display:-webkit-box;display:flex;margin-top:20px;width:294px;-webkit-box-pack:end;justify-content:flex-end}.gd-new-comment .gd-buttons .gd-add-comment{background-color:#4b566c!important;margin-left:10px;border:1px solid #707070}.gd-new-comment .gd-buttons .gd-add-comment ::ng-deep .button{color:#fff!important;display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:start;justify-content:flex-start}.gd-new-comment .gd-buttons .gd-add-comment ::ng-deep .button fa-icon{padding:0 11px}.gd-new-comment .gd-buttons .gd-cancel-comment{background-color:transparent;border:1px solid #707070}.gd-new-comment .gd-buttons .gd-cancel-comment ::ng-deep .button{color:#acacac!important}.gd-new-comment .gd-name{width:100%;height:37px;border:1px solid #6e6e6e;box-sizing:border-box}.gd-new-comment .gd-text{width:100%;height:100px;border:1px solid #6e6e6e;margin-top:20px;box-sizing:border-box}@media (max-width:1037px){.gd-new-comment{width:100%;padding-bottom:20px}.gd-new-comment .gd-buttons{width:100%}}"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={comment:[{type:n.Input}],addComment:[{type:n.Output}],removeComment:[{type:n.Output}]},t}();function M(t){return function(){return t.load()}}function L(t){return new o.LoadingMaskInterceptorService(t)}var z=function(){function t(){c.library.add(d.fas,l.far)}return t.forRoot=function(n){return o.Api.DEFAULT_API_ENDPOINT=n,{ngModule:t}},t.decorators=[{type:n.NgModule,args:[{declarations:[I,k,S,D,R],exports:[o.CommonComponentsModule,I,k,S,D,R],imports:[e.CommonModule,o.CommonComponentsModule,r.HttpClientModule,a.FontAwesomeModule,s.ClickOutsideModule],providers:[o.ConfigService,u,A,P,E,{provide:r.HTTP_INTERCEPTORS,useClass:o.ErrorInterceptorService,multi:!0},{provide:n.APP_INITIALIZER,useFactory:M,deps:[u],multi:!0},o.LoadingMaskService,{provide:r.HTTP_INTERCEPTORS,useFactory:L,multi:!0,deps:[o.LoadingMaskService]}],entryComponents:[k]}]}],t.ctorParameters=function(){return[]},t}();t.ActiveAnnotationService=A,t.AnnotationAppComponent=I,t.AnnotationConfigService=u,t.AnnotationModule=z,t.AnnotationService=m,t.CommentAnnotationService=E,t.RemoveAnnotationService=P,t.initializeApp=M,t.setupLoadingInterceptor=L,t.ɵa=k,t.ɵb=S,t.ɵc=D,t.ɵd=R,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=groupdocs.examples.angular-annotation.umd.min.js.map