!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("@angular/core"),require("@angular/common/http"),require("@groupdocs.examples.angular/common-components"),require("rxjs"),require("@fortawesome/angular-fontawesome"),require("hammerjs"),require("jquery")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/viewer",["exports","@angular/platform-browser","@angular/core","@angular/common/http","@groupdocs.examples.angular/common-components","rxjs","@fortawesome/angular-fontawesome","hammerjs","jquery"],t):t(((e=e||self).groupdocs=e.groupdocs||{},e.groupdocs.examples=e.groupdocs.examples||{},e.groupdocs.examples.angular=e.groupdocs.examples.angular||{},e.groupdocs.examples.angular.viewer={}),e.ng.platformBrowser,e.ng.core,e.ng.common.http,e.commonComponents,e.rxjs,e.angularFontawesome,e.Hammer,e.jquery)}(this,(function(e,t,i,n,o,r,a,s,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function c(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}var d=function(){function e(e,t){this._http=e,this._config=t}return e.prototype.loadFiles=function(e){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_FILE_TREE,{path:e},o.Api.httpOptionsJson)},e.prototype.loadFile=function(e){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_DOCUMENT_DESCRIPTION,e,o.Api.httpOptionsJson)},e.prototype.upload=function(e,t,i){var n=new FormData;return n.append("file",e),n.append("rewrite",String(i)),t&&n.append("url",t),this._http.post(this._config.getViewerApiEndpoint()+o.Api.UPLOAD_DOCUMENTS,n)},e.prototype.loadPage=function(e,t){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_DOCUMENT_PAGE,{guid:e.guid,password:e.password,page:t},o.Api.httpOptionsJson)},e.prototype.rotate=function(e,t,i){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.ROTATE_DOCUMENT_PAGE,{guid:e.guid,password:e.password,pages:[i],angle:t},o.Api.httpOptionsJson)},e.prototype.getDownloadUrl=function(e){return this._config.getViewerApiEndpoint()+o.Api.DOWNLOAD_DOCUMENTS+"/?path="+e.guid},e.prototype.loadPrint=function(e){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_PRINT,{guid:e.guid,password:e.password},o.Api.httpOptionsJson)},e.prototype.loadPrintPdf=function(e){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_PRINT_PDF,{guid:e.guid,password:e.password},o.Api.httpOptionsJsonResponseTypeBlob)},e.prototype.loadThumbnails=function(e){return this._http.post(this._config.getViewerApiEndpoint()+o.Api.LOAD_THUMBNAILS,{guid:e.guid,password:e.password},o.Api.httpOptionsJson)},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpClient},{type:o.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(n.HttpClient),i.ɵɵinject(o.ConfigService))},token:e,providedIn:"root"}),e}();var g=function(){};var h=function(){function e(e,t){this._http=e,this._config=t,this._viewerConfig=new r.BehaviorSubject(new g),this._updatedConfig=this._viewerConfig.asObservable()}return Object.defineProperty(e.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;return new Promise((function(t,i){var n=e._config.getConfigEndpoint(o.Api.VIEWER_APP);e._http.get(n,o.Api.httpOptionsJson).toPromise().then((function(i){var n=i;e._viewerConfig.next(n),t()})).catch((function(e){i("Could not load viewer config: "+JSON.stringify(e))}))}))},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpClient},{type:o.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(n.HttpClient),i.ɵɵinject(o.ConfigService))},token:e,providedIn:"root"}),e}();var u=function(){function e(){}return e.thumbnailsWidth=300,e.scrollWidth=17,e.topbarWidth=60,e.documentMargin=20,e}();var f=function(){function e(e,t){var i=this;this.remaining=0,this.state=0,this.callback=e,this.interval=t,this.startTime=(new Date).getTime();var n=this;this.timerId=setInterval((function(){i.callback(),n.startTime=(new Date).getTime()}),this.interval),this.state=1}return e.prototype.pause=function(){1===this.state&&(this.remaining=this.interval-((new Date).getTime()-this.startTime),clearInterval(this.timerId),this.state=2)},e.prototype.resume=function(){var e=this;2===this.state&&(this.state=3,setTimeout((function(){return e.timeoutCallback()}),this.remaining))},e.prototype.stop=function(){this.state=0,clearInterval(this.timerId)},e.prototype.timeoutCallback=function(){3===this.state&&(this.callback(),this.startTime=(new Date).getTime(),this.timerId=setInterval(this.callback,this.interval),this.state=1)},e}();var m=function(){function e(e,t,i,n,r,a,s,l,p,c,d){var g=this;this._viewerService=e,this._modalService=t,this._navigateService=r,this._renderPrintService=l,this._windowService=c,this._loadingMaskService=d,this.title="viewer",this.files=[],this.countPages=0,this.formatDisabled=!this.file,this.showThumbnails=!1,this.browseFilesModal=o.CommonModals.BrowseFiles,this.showSearch=!1,this._zoom=100,this.fileWasDropped=!1,this.docElmWithBrowsersFullScreenFunctions=document.documentElement,this.docWithBrowsersExitFunctions=document,this.zoomService=a,this.startScrollTime=Date.now(),this.endScrollTime=Date.now(),i.updatedConfig.subscribe((function(e){g.viewerConfig=e})),n.uploadsChange.subscribe((function(e){if(e){var t=void 0;for(t=0;t<e.length;t++)g._viewerService.upload(e.item(t),"",g.viewerConfig.rewrite).subscribe((function(e){g.fileWasDropped?g.selectFile(e.guid,"",""):g.selectDir("")}))}})),s.checkPreload.subscribe((function(e){if(0!==g.viewerConfig.preloadPageCount)for(var t=e;t<e+2;t++)t>0&&t<=g.countPages&&!g.file.pages[t-1].data&&g.preloadPages(t,t)})),p.passChange.subscribe((function(e){g.selectFile(g.credentials.guid,e,o.CommonModals.PasswordRequired)})),this.isDesktop=c.isDesktop(),c.onResize.subscribe((function(){g.isDesktop=c.isDesktop(),g.runPresentation||g.refreshZoom()}))}return e.prototype.fullScreen=function(){document.fullscreenElement||this.closeFullScreen()},e.prototype.ngOnInit=function(){""!==this.viewerConfig.defaultDocument&&(this.isLoading=!0,this.selectFile(this.viewerConfig.defaultDocument,"",""));var e=window.location.search;e&&this.TryOpenFileByUrl(e),this.selectedPageNumber=0!==this._navigateService.currentPage?this._navigateService.currentPage:1},e.prototype.ngAfterViewInit=function(){var e=this;this._loadingMaskService.onLoadingChanged.subscribe((function(t){return e.isLoading=t})),this.refreshZoom()},Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.zoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSelectorConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.pageSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.search},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnailsConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.thumbnails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rotate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"printConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.print},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlModeConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.htmlMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"saveRotateStateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.saveRotateState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableRightClickConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.enableRightClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._navigateService.currentPage},enumerable:!0,configurable:!0}),e.prototype.ifPresentation=function(){return!!this.file&&"Microsoft PowerPoint"===o.FileUtil.find(this.file.guid,!1).format},e.prototype.ifExcel=function(){return!!this.file&&"Microsoft Excel"===o.FileUtil.find(this.file.guid,!1).format},e.prototype.ifImage=function(){return!!this.file&&"file-image"===this.formatIcon},e.prototype.validURL=function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)},e.prototype.getFileName=function(){return this.file.guid.replace(/^.*[\\\/]/,"")},e.prototype.openModal=function(e){this._modalService.open(e)},e.prototype.closeModal=function(e){this._modalService.close(e)},e.prototype.selectDir=function(e){var t=this;this._viewerService.loadFiles(e).subscribe((function(e){return t.files=e||[]}))},e.prototype.selectFile=function(e,t,i){var n=this;this.credentials={guid:e,password:t},this.file=null,this._viewerService.loadFile(this.credentials).subscribe((function(e){if(n.file=e,n.formatDisabled=!n.file,e){n.formatIcon=n.file?o.FileUtil.find(n.file.guid,!1).icon:null,e.pages&&e.pages[0]&&(n._pageHeight=e.pages[0].height,n._pageWidth=e.pages[0].width,n.options=n.zoomOptions(),n.timerOptions=n.getTimerOptions(),n.refreshZoom());var t=n.ifPresentation()&&0!==n.viewerConfig.preloadPageCount&&n.viewerConfig.preloadPageCount<3?3:n.viewerConfig.preloadPageCount,i=e.pages?e.pages.length:0;t>0&&(n.ifPresentation()&&(n.file.thumbnails=e.pages.slice()),n.preloadPages(1,t>i?i:t),n.ifPresentation()||n._viewerService.loadThumbnails(n.credentials).subscribe((function(e){n.file.thumbnails=e.pages}))),n._navigateService.countPages=i,n._navigateService.currentPage=n.selectedPageNumber,n.countPages=i,n.ifPresentation()?n.showThumbnails=!0:n.showThumbnails=!1,n.runPresentation=!1}})),i&&this._modalService.close(i),this.clearData()},e.prototype.preloadPages=function(e,t){for(var i=this,n=function(e){o._viewerService.loadPage(o.credentials,e).subscribe((function(t){i.file.pages[e-1]=t,i.ifPresentation()&&i.file.thumbnails&&!i.file.thumbnails[e-1].data&&(t.data&&(t.data=t.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,"").replace(/href="\/viewer/g,'href="http://localhost:8080/viewer').replace(/src="\/viewer/g,'src="http://localhost:8080/viewer').replace(/data="\/viewer/g,'data="http://localhost:8080/viewer')),i.file.thumbnails[e-1].data=t.data)}))},o=this,r=e;r<=t;r++)n(r)},e.prototype.upload=function(e){var t=this;this._viewerService.upload(null,e,this.rewriteConfig).subscribe((function(e){""!==t.fileParam?(t.selectFile(e.guid,"",""),t.fileParam=""):t.selectDir("")}))},e.prototype.nextPage=function(){this.formatDisabled||(this.intervalTimer&&this._navigateService.currentPage+1>this.countPages&&(this.intervalTimer.stop(),this.intervalTime=0),this._navigateService.nextPage())},e.prototype.prevPage=function(){this.formatDisabled||this._navigateService.prevPage()},e.prototype.toLastPage=function(){this.formatDisabled||this._navigateService.toLastPage()},e.prototype.toFirstPage=function(){this.formatDisabled||this._navigateService.toFirstPage()},e.prototype.zoomIn=function(){this.formatDisabled||this._zoom<490&&(this.zoom=this._zoom+10)},e.prototype.zoomOut=function(){this.formatDisabled||this._zoom>30&&(this.zoom=this._zoom-10)},e.prototype.fileDropped=function(e){this.fileWasDropped=e},e.prototype.ptToPx=function(e){return 96*e/72},e.prototype.getFitToWidth=function(){var e=this.formatIcon&&(this.ifExcel()||this.ifImage())?this._pageWidth:this.ptToPx(this._pageWidth),t=this.formatIcon&&(this.ifExcel()||this.ifImage())?this._pageHeight:this.ptToPx(this._pageHeight),i=e||window.innerWidth,n=this.isDesktop&&this.ifPresentation()&&!this.runPresentation;return this.runPresentation?Math.round(100*window.innerWidth/i):t>e&&Math.round(i/window.innerWidth)<2?200-Math.round(100*i/(n?window.innerWidth-u.thumbnailsWidth-u.scrollWidth:window.innerWidth)):this.isDesktop?Math.round((n?window.innerWidth-u.thumbnailsWidth-u.scrollWidth:window.innerHeight)/i*100):Math.round(100*window.innerWidth/i)},e.prototype.getFitToHeight=function(){var e=this.formatIcon&&(this.ifExcel()||this.ifImage())?this._pageWidth:this.ptToPx(this._pageWidth),t=this.formatIcon&&(this.ifExcel()||this.ifImage())?this._pageHeight:this.ptToPx(this._pageHeight),i=t>e?window.innerHeight-100:window.innerHeight+100,n=t||i;return this.ifPresentation()||this.ifImage()?this.ifPresentation()?Math.floor(100*(window.innerHeight-u.topbarWidth)/(this.runPresentation?n:n+2*u.documentMargin+u.scrollWidth)):this.ifImage()?Math.floor(100*(window.innerHeight-u.topbarWidth)/(n+2*u.documentMargin+u.scrollWidth)):void 0:t>e?Math.round(100*i/n):Math.round(100*n/i)},e.prototype.zoomOptions=function(){var e=this.getFitToWidth(),t=this.getFitToHeight();return this.zoomService.zoomOptions(e,t)},e.prototype.getTimerOptions=function(){return[{value:0,name:"None",separator:!1},{value:5,name:"5 sec",separator:!1},{value:10,name:"10 sec",separator:!1},{value:15,name:"15 sec",separator:!1},{value:30,name:"30 sec",separator:!1}]},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,this.zoomService.changeZoom(this._zoom)},enumerable:!0,configurable:!0}),e.prototype.selectZoom=function(e){this.zoom=e.value},e.prototype.rotate=function(e){var t=this;if(!this.formatDisabled){var i=this._navigateService.currentPage,n=this.file.pages[i-1];this.saveRotateStateConfig&&this.file&&this._viewerService.rotate(this.credentials,e,i).subscribe((function(o){var r=o.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,"").replace(/href="\/viewer/g,'href="http://localhost:8080/viewer').replace(/src="\/viewer/g,'src="http://localhost:8080/viewer').replace(/data="\/viewer/g,'data="http://localhost:8080/viewer');if(o.data=r,t.file.pages[i-1]=o,t.file&&t.file.pages&&n){var a=n.angle+e;a>360?t.changeAngle(n,90):a<-360?t.changeAngle(n,-90):t.changeAngle(n,a)}}))}},e.prototype.changeAngle=function(e,t){e.angle=t},e.prototype.downloadFile=function(){this.formatDisabled||window.location.assign(this._viewerService.getDownloadUrl(this.credentials))},e.prototype.printFile=function(){var e=this;this.formatDisabled||(this.viewerConfig.htmlMode?this._viewerService.loadPrint(this.credentials).subscribe((function(t){e._renderPrintService.changePages(t.pages)})):this._renderPrintService.changePages(this.file.pages))},e.prototype.openThumbnails=function(){var e=this;this.formatDisabled||(this.showThumbnails?this.showThumbnails=!1:0===this.viewerConfig.preloadPageCount?(this.runPresentation=!1,this.showThumbnails=!0):this.file.thumbnails.filter((function(e){return!e.data})).length>0?this._viewerService.loadThumbnails(this.credentials).subscribe((function(t){e.file.thumbnails=t.pages,e.showThumbnails=!0})):this.showThumbnails=!0)},e.prototype.clearData=function(){var e,t;if(this.file&&this.file.pages)try{for(var i=c(this.file.pages),n=i.next();!n.done;n=i.next()){n.value.data=null}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.onRightClick=function(){return this.enableRightClickConfig},e.prototype.openSearch=function(){this.formatDisabled||(this.showSearch=!this.showSearch)},e.prototype.refreshZoom=function(){this.file&&(this.formatIcon=o.FileUtil.find(this.file.guid,!1).icon,this.zoom=!this._windowService.isDesktop()||this.ifImage()||this.ifPresentation()?this.ifImage()?this.getFitToHeight():this.getFitToWidth():100)},e.prototype.selectCurrentPage=function(e){this.selectedPageNumber=e,this._navigateService.currentPage=e,this.runPresentation&&this.intervalTime>0&&3!==this.intervalTimer.state&&(this.resetInterval(),this.slideInRange()&&this.startCountDown(this.intervalTime,!0))},e.prototype.onMouseWheelUp=function(){this.startScrollTime=Date.now(),this.ifPresentation()&&1!==this.selectedPageNumber&&this.startScrollTime-this.endScrollTime>300&&this.vertScrollEnded(!0)&&(this.selectedPageNumber=this.selectedPageNumber-1,this.endScrollTime=Date.now())},e.prototype.onMouseWheelDown=function(){this.startScrollTime=Date.now(),this.ifPresentation()&&this.selectedPageNumber!==this.file.pages.length&&this.startScrollTime-this.endScrollTime>300&&this.vertScrollEnded(!1)&&(this.startScrollTime=Date.now(),this.file.pages[this.selectedPageNumber]&&!this.file.pages[this.selectedPageNumber].data?(this.preloadPages(this.selectedPageNumber,this.selectedPageNumber+1),this.selectedPageNumber=this.selectedPageNumber+1):this.selectedPageNumber=this.selectedPageNumber+1,this.endScrollTime=Date.now())},e.prototype.vertScrollEnded=function(e){var t=document.getElementsByClassName("gd-document")[0];return e?0===t.scrollTop:t.offsetHeight+t.scrollTop>=t.scrollHeight},e.prototype.TryOpenFileByUrl=function(e){var t=new URLSearchParams(e);this.fileParam=t.get("file"),this.fileParam&&(this.isLoading=!0,this.validURL(this.fileParam)?this.upload(this.fileParam):this.selectFile(this.fileParam,"",""))},e.prototype.toggleTimer=function(e){this.intervalTime=e.value,0!==this.intervalTime?(this.intervalTimer&&1===this.intervalTimer.state&&this.intervalTimer.stop(),this.startCountDown(this.intervalTime),this.startInterval(this.intervalTime)):this.intervalTimer.stop()},e.prototype.showCountDown=function(){return this.intervalTime>0&&this.slideInRange()},e.prototype.startCountDown=function(e,t){var i=this;if(void 0===t&&(t=!1),clearInterval(this.countDownInterval),e>0){this.secondsLeft=e,e--;var n=setInterval((function(){i.secondsLeft=e,0===--e&&clearInterval(n)}),1e3);this.countDownInterval=n}},e.prototype.startInterval=function(e){var t=this;this.intervalTimer=new f((function(){t.slideInRange()?(t.nextPage(),t.slideInRange()&&t.startCountDown(e)):t.intervalTimer.stop()}),1e3*e)},e.prototype.slideInRange=function(){return this._navigateService.currentPage+1<=this.countPages},e.prototype.resetInterval=function(){this.intervalTimer.stop(),this.startInterval(this.intervalTime)},e.prototype.pausePresenting=function(){this.intervalTimer.pause(),this.startCountDown(0,!0)},e.prototype.resumePresenting=function(){this.intervalTimer.resume();var e=Math.round(this.intervalTimer.remaining/1e3);this.startCountDown(e)},e.prototype.presentationRunning=function(){return this.intervalTimer&&1===this.intervalTimer.state&&this.slideInRange()},e.prototype.presentationPaused=function(){return this.intervalTimer&&2===this.intervalTimer.state&&this.slideInRange()},e.prototype.startPresentation=function(){var e=this;this.showThumbnails=!1,this.openFullScreen(),this.runPresentation=!this.runPresentation;var t=setInterval((function(){screen.height===window.innerHeight&&screen.width===window.innerWidth&&(e.zoomService.changeZoom(window.innerWidth/window.innerHeight<1.7&&e._pageWidth/e._pageHeight>1.7?e.getFitToWidth():e.getFitToHeight()),clearInterval(t))}),50)},e.prototype.openFullScreen=function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.isFullScreen=!0},e.prototype.closeFullScreen=function(e){if(void 0===e&&(e=!1),e){var t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen()}this.intervalTimer&&this.intervalTimer.stop(),this.isFullScreen=!1,this.runPresentation=!1,this.showThumbnails=!0,this.intervalTime=0,this.startCountDown(0),this.refreshZoom()},e.decorators=[{type:i.Component,args:[{selector:"gd-viewer",template:'<gd-loading-mask [loadingMask]="isLoading"></gd-loading-mask>\n<div class="wrapper" (contextmenu)="onRightClick()">\n  <div class="top-panel" *ngIf="!runPresentation">\n    <gd-logo [logo]="\'viewer\'" icon="eye"></gd-logo>\n    <gd-top-toolbar class="toolbar-panel">\n      <gd-button [icon]="\'folder-open\'" title="Browse files" (click)="openModal(browseFilesModal)"\n                 *ngIf="browseConfig" ></gd-button>\n\n      <gd-select class="mobile-hide select-left" [disabled]="formatDisabled" [options]="options" (selected)="selectZoom($event)"\n                 [showSelected]="{ name: zoom+\'%\', value : zoom}" *ngIf="zoomConfig" ></gd-select>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'search-plus\'" title="Zoom In" (click)="zoomIn()"\n                 *ngIf="zoomConfig" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'search-minus\'" title="Zoom Out"\n                 (click)="zoomOut()" *ngIf="zoomConfig" ></gd-button>\n\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-double-left\'" title="First Page"\n                 (click)="toFirstPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-left\'" title="Previous Page"\n                 (click)="prevPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <div class="current-page-number" [ngClass]="{\'active\': !formatDisabled}" *ngIf="formatIcon !== \'file-excel\'">{{currentPage}}/{{countPages}}</div>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-right\'" title="Next Page"\n                 (click)="nextPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-double-right\'" title="Last Page"\n                 (click)="toLastPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'undo\'" title="Rotate CCW" (click)="rotate(-90)"\n                 *ngIf="rotateConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'redo\'" title="Rotate CW" (click)="rotate(90)"\n                 *ngIf="rotateConfig && formatIcon !== \'file-excel\'" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'download\'" title="Download"\n                 (click)="downloadFile()" *ngIf="downloadConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'print\'" title="Print" (click)="printFile()"\n                 *ngIf="printConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'search\'" title="Search" (click)="openSearch()"\n                 *ngIf="searchConfig && !ifPresentation()" ></gd-button>\n      <gd-search (hidePanel)="showSearch = !$event" *ngIf="showSearch" ></gd-search>\n\n      <gd-button class="thumbnails-button btn-right" [disabled]="formatDisabled" [icon]="\'th-large\'" title="Thumbnails"\n                 (click)="openThumbnails()" *ngIf="thumbnailsConfig && isDesktop && formatIcon !== \'file-excel\' && (!ifPresentation() ||\n                 ifPresentation() && runPresentation)"></gd-button>\n      <gd-button class="thumbnails-button mobile-hide btn-right smp-start-stop" [disabled]="formatDisabled" [icon]="\'play\'" title="Run presentation"\n                 (click)="startPresentation()" *ngIf="ifPresentation() && !runPresentation">Present</gd-button>\n    </gd-top-toolbar>\n  </div>\n  <div class="top-panel" *ngIf="runPresentation">\n    <gd-top-toolbar class="toolbar-panel">\n      <div class="slides-title">Viewer</div>\n      <div class="slides-filename">{{getFileName()}}</div>\n      <div class="slides-buttons">\n        <gd-select class="mobile-hide select-right" [disabled]="formatDisabled" [options]="timerOptions" (selected)="toggleTimer($event)"\n        [icon]="\'clock\'" *ngIf="zoomConfig" ></gd-select>\n        <gd-button class="mobile-hide" *ngIf="presentationRunning()" [disabled]="formatDisabled" [icon]="\'pause\'" title="Pause presenting"\n        (click)="pausePresenting()"></gd-button>\n        <gd-button class="mobile-hide" *ngIf="presentationPaused()" [disabled]="formatDisabled" [icon]="\'step-forward\'" title="Resume presenting"\n        (click)="resumePresenting()"></gd-button>\n        <gd-button class="mobile-hide btn-right smp-start-stop" [disabled]="formatDisabled" [icon]="\'stop\'" title="Stop presenting"\n        (click)="closeFullScreen(true)">Stop</gd-button>\n      </div>\n    </gd-top-toolbar>\n  </div>\n  <div class="doc-panel" *ngIf="file" #docPanel>\n    <gd-thumbnails *ngIf="showThumbnails && !ifPresentation() && isDesktop" [pages]="viewerConfig?.preloadPageCount == 0 ? file.pages : file.thumbnails" [isHtmlMode]="htmlModeConfig"\n                   [guid]="file.guid" [mode]="htmlModeConfig" (selectedPage)="selectCurrentPage($event)"></gd-thumbnails>\n    <gd-thumbnails *ngIf="showThumbnails && ifPresentation() && !runPresentation && isDesktop" [pages]="viewerConfig?.preloadPageCount == 0 ? file.pages : file.thumbnails" [isHtmlMode]="htmlModeConfig"\n                   [guid]="file.guid" [mode]="htmlModeConfig" (selectedPage)="selectCurrentPage($event)" gdScrollable></gd-thumbnails>\n\n    <gd-document class="gd-document" *ngIf="(file &&\n                                            (ifExcel() && !htmlModeConfig) ||\n                                            (ifPresentation() && isDesktop && !runPresentation) ||\n                                            (!ifExcel() && !ifPresentation()))" [file]="file" [mode]="htmlModeConfig" [showActiveSlide]="true" gdScrollable\n                 [preloadPageCount]="viewerConfig?.preloadPageCount" [selectedPage]="selectedPageNumber" gdRenderPrint [htmlMode]="htmlModeConfig" gdMouseWheel (mouseWheelUp)="onMouseWheelUp()" (mouseWheelDown)="onMouseWheelDown()"></gd-document>\n    <gd-excel-document class="gd-document" *ngIf="file && ifExcel() && htmlModeConfig" [file]="file" [mode]="htmlModeConfig" gdScrollable\n                 [preloadPageCount]="viewerConfig?.preloadPageCount" gdRenderPrint [htmlMode]="htmlModeConfig"></gd-excel-document>\n    <gd-run-presentation class="gd-document" *ngIf="(file && ifPresentation() && runPresentation) ||\n                                                    (file && ifPresentation() && !isDesktop)" [file]="file" [currentPage]="currentPage" [mode]="htmlModeConfig"\n                                                    (selectedPage)="selectCurrentPage($event)"\n                 [preloadPageCount]="0"></gd-run-presentation>\n    <div class="slides-nav" *ngIf="runPresentation">\n      <div class="timer" *ngIf="showCountDown()">\n        <fa-icon [icon]="[\'fas\',\'circle-notch\']" [spin]="true"></fa-icon><span [ngClass]="secondsLeft >= 10 ? \'seconds-remaining two-digits\' : \'seconds-remaining\'">{{secondsLeft}}</span>\n      </div>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-left\'"\n      (click)="prevPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-right\'"\n      (click)="nextPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n    </div>\n  </div>\n\n  <gd-init-state [icon]="\'eye\'" [text]="\'Drop file here to upload\'" *ngIf="!file" (fileDropped)="fileDropped($event)">\n    Click <fa-icon [icon]="[\'fas\',\'folder-open\']"></fa-icon> to open file<br>\n    Or drop file here\n  </gd-init-state>\n\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\n                         (selectedFileGuid)="selectFile($event, null, browseFilesModal)"\n                         [uploadConfig]="uploadConfig"></gd-browse-files-modal>\n\n  <gd-error-modal></gd-error-modal>\n  <gd-password-required></gd-password-required>\n</div>\n',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.current-page-number{margin-left:7px;font-size:14px;color:#959da5;width:37px;height:37px;line-height:37px;text-align:center}.current-page-number.active{color:#fff}.wrapper{-webkit-box-align:stretch;align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.doc-panel{display:-webkit-box;display:flex;height:calc(100vh - 60px);-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.thumbnails-button{position:absolute;right:3px}.top-panel{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%}.toolbar-panel{background-color:#3e4e5a;width:100%}.btn-right{margin-right:7px}.smp-start-stop ::ng-deep .button{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;border:1px solid;border-radius:5px;padding:0 10px!important}::ng-deep .tools .button,::ng-deep .tools .nav-caret,::ng-deep .tools .selected-value{color:#fff!important}::ng-deep .tools .button.inactive,::ng-deep .tools .nav-caret.inactive,::ng-deep .tools .selected-value.inactive{color:#959da5!important}::ng-deep .tools .button{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column}::ng-deep .tools .select-left .select{position:relative}::ng-deep .tools .select-left .dropdown-menu{top:40px;left:0}::ng-deep .tools .select-right .select{position:relative}::ng-deep .tools .select-right .dropdown-menu{top:40px;right:0}::ng-deep .tools .dropdown-menu .option{color:#6e6e6e!important}::ng-deep .tools .dropdown-menu .option:hover{background-color:#4b566c!important}::ng-deep .tools .icon-button{margin:0 0 0 15px!important}::ng-deep .tools .select{width:37px;height:37px;margin-left:7px;line-height:37px;text-align:center}::ng-deep .tools .slides-title{color:#fff;padding-left:12px;font-size:18px}::ng-deep .tools .slides-filename{-webkit-box-flex:1;flex-grow:1;text-align:center;color:#fff;text-overflow:ellipsis;white-space:nowrap;padding-left:20px;overflow:hidden}::ng-deep .tools .slides-buttons{display:-webkit-box;display:flex}::ng-deep .tools .slides-buttons ::ng-deep .select{color:#fff;cursor:pointer}::ng-deep .tools ::ng-deep .gd-nav-search-container .icon-button{margin:0 0 0 7px!important}.slides-nav{position:absolute;right:30px;bottom:30px;display:-webkit-box;display:flex}.slides-nav ::ng-deep .button{font-size:37px;background-color:#edf0f2;border-radius:3px}.slides-nav ::ng-deep .timer{font-size:42px;line-height:6px;color:#959da5;position:relative}.slides-nav ::ng-deep .timer .seconds-remaining{position:absolute;margin-left:5px;font-size:16px;top:18px;left:12px}.slides-nav ::ng-deep .timer .seconds-remaining.two-digits{left:6px!important}::ng-deep .page.presentation .gd-wrapper{pointer-events:none}@media (max-width:1037px){.current-page-number,.mobile-hide{display:none}::ng-deep .tools gd-button:nth-child(1)>.icon-button{margin:0 0 0 10px!important}::ng-deep .tools .icon-button{height:60px;width:60px}::ng-deep .tools .gd-nav-search-btn .icon-button{height:37px;width:37px}::ng-deep .tools .gd-nav-search-btn .button{font-size:14px}::ng-deep .tools .gd-nav-search-container{top:59px!important}}"]}]}],e.ctorParameters=function(){return[{type:d},{type:o.ModalService},{type:h},{type:o.UploadFilesService},{type:o.NavigateService},{type:o.ZoomService},{type:o.PagePreloadService},{type:o.RenderPrintService},{type:o.PasswordService},{type:o.WindowService},{type:o.LoadingMaskService}]},e.propDecorators={fullScreen:[{type:i.HostListener,args:["document:fullscreenchange",[]]}]},e}();var v=function(){function e(e,t){this._navigateService=e,this._zoomService=t,this.selectedPage=new i.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){this.pages&&this.pages.forEach((function(e){e.data&&(e.data=e.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,"").replace(/href="\/viewer/g,'href="http://localhost:8080/viewer').replace(/src="\/viewer/g,'src="http://localhost:8080/viewer').replace(/data="\/viewer/g,'data="http://localhost:8080/viewer'))}))},e.prototype.ngAfterViewInit=function(){this._zoomService.changeZoom(this._zoomService.zoom)},e.prototype.ngOnDestroy=function(){var e=this;setTimeout((function(){e._zoomService.changeZoom(e._zoomService.zoom)}),100)},e.prototype.imgData=function(e){return this.isHtmlMode?"data:image/png;base64,":"data:image/png;base64,"+e},e.prototype.getScale=function(e,t){return Math.min(190/e,190/t)},e.prototype.openPage=function(e){this.selectedPage.emit(e),this._navigateService.navigateTo(e)},e.prototype.getDimensionWithUnit=function(e){return e+o.FileUtil.find(this.guid,!1).unit},e.decorators=[{type:i.Component,args:[{selector:"gd-thumbnails",template:'<div class="gd-thumbnails">\n  <div class="gd-thumbnails-panzoom">\n    <div *ngFor="let page of pages" id="gd-thumbnails-page-{{page.number}}" class="gd-page"\n         (click)="openPage(page.number)" gdRotation [withMargin]="false"\n         [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n      <div class="gd-wrapper"\n           [style.height]="getDimensionWithUnit(page.height)"\n           [style.width]="getDimensionWithUnit(page.width)"\n           [ngStyle]="{\'transform\': \'translateX(-50%) translateY(-50%) scale(\'+getScale(page.width, page.height)+\')\'}"\n           *ngIf="page.data && isHtmlMode"\n           [innerHTML]="page.data | safeHtml"></div>\n      <div class="gd-wrapper" \n           [style.height]="getDimensionWithUnit(page.height)"\n           [style.width]="getDimensionWithUnit(page.width)"\n           [ngStyle]="{\'transform\': \'translateX(-50%) translateY(-50%) scale(\'+getScale(page.width, page.height)+\')\'}"\n           *ngIf="page.data && !isHtmlMode">\n           <img style="width: inherit !important" class="gd-page-image" [attr.src]="imgData(page.data) | safeResourceHtml"\n             alt/>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[":host{-webkit-box-flex:0;flex:0 0 300px;background:#f5f5f5;color:#fff;overflow-y:auto;display:block;-webkit-transition:margin-left .2s;transition:margin-left .2s;height:100%}.gd-page{width:272px;height:272px;-webkit-transition:.3s;transition:.3s;background-color:#e7e7e7;cursor:pointer;margin:14px 14px 0}.gd-page:hover{background-color:silver}.gd-wrapper{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);left:50%;top:50%;position:relative;background-color:#fff;box-shadow:0 4px 12px -4px rgba(0,0,0,.38);pointer-events:none}.gd-wrapper ::ng-deep img{width:inherit}.gd-thumbnails::-webkit-scrollbar{width:0;background-color:#f5f5f5}.gd-thumbnails-panzoom>.gd-thumbnails-landscape{margin:-134px 0 -1px 12px}.gd-thumbnails .gd-page-image{height:inherit}.gd-thumbnails-landscape-image{margin:-90px 0 -23px!important}.gd-thumbnails-landscape-image-rotated{margin:126px 0 -3px -104px!important}"]}]}],e.ctorParameters=function(){return[{type:o.NavigateService},{type:o.ZoomService}]},e.propDecorators={pages:[{type:i.Input}],guid:[{type:i.Input}],mode:[{type:i.Input}],isHtmlMode:[{type:i.Input}],selectedPage:[{type:i.Output}]},e}();var b=function(){function e(){}return e.prototype.getUpdatedPage=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),i=t.querySelector("table"),n=0;t.querySelectorAll("table > tbody > tr:first-child td").forEach((function(e){n+=e.attributes.colspan?parseInt(e.attributes.colspan.value,10):1}));var o=this.createHeader(n,i);return t.querySelector("table").replaceWith(o),(new XMLSerializer).serializeToString(t).replace(/a0:/g,"").replace(/:a0/g,"")},e.prototype.createHeader=function(e,t){var i=document.createElement("thead");i.append(document.createElement("tr"));for(var n=0;n<e;++n){var o=document.createElement("th");o.innerText=this.colName(n),i.querySelector("tr").append(o)}var r=t.querySelector("colgroup"),a=document.createElement("col");a.width="80px",r.prepend(a),t.prepend(i);var s=0;return t.querySelectorAll("tr").forEach((function(e){var t=document.createElement("div");if(0!==s){var i=document.createElement("td");i.className="excel",i.append(t),t.innerText=s.toString(),e.prepend(i)}else{var n=document.createElement("th");n.append(t),e.prepend(n)}s++})),t},e.prototype.colName=function(e){for(var t="a".charCodeAt(0),i="z".charCodeAt(0)-t+1,n="";e>=0;)n=String.fromCharCode(e%i+t)+n,e=Math.floor(e/i)-1;return n},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),w=function(){function e(e){this._excelPageService=e}return e.prototype.ngOnInit=function(){!!/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)&&0===this.number&&(this.editable=!1)},e.prototype.ngOnChanges=function(e){this.isHtml?this.data=this.data?this.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,"").replace(/href="\/viewer/g,'href="http://localhost:8080/viewer').replace(/src="\/viewer/g,'src="http://localhost:8080/viewer').replace(/data="\/viewer/g,'data="http://localhost:8080/viewer'):null:this.imgData="data:image/png;base64,"+this.data},e.decorators=[{type:i.Component,args:[{selector:"gd-excel-page",template:'<div id="page-{{number}}">\n  <div class="gd-wrapper" [innerHTML]="data | safeHtml" *ngIf="data && isHtml" [contentEditable]="(editable) ? true : false"></div>\n  <img class="gd-page-image" [style.width.px]="width" [style.height.px]="height" [attr.src]="imgData | safeResourceHtml"\n       alt=""\n       *ngIf="data && !isHtml">\n  <div class="gd-page-spinner" *ngIf="!data">\n    <fa-icon [icon]="[\'fas\',\'circle-notch\']" [spin]="true"></fa-icon>\n    &nbsp;Loading... Please wait.\n  </div>\n</div>\n',styles:[".gd-page-spinner{margin-top:150px;text-align:center}.gd-wrapper{width:inherit;height:inherit}.gd-wrapper div{width:100%}::ng-deep .gd-highlight{background-color:#ff0}::ng-deep .gd-highlight-select{background-color:#ff9b00}::ng-deep th{color:#959da5;background-color:#f4f4f4;font-weight:unset;border:1px solid #e7e7e7!important;text-transform:uppercase;font-size:14px;overflow:hidden}::ng-deep td{vertical-align:middle!important}::ng-deep .page-grid-lines td{border:1px solid #e7e7e7!important}::ng-deep .page td:nth-child(1){border:1px solid #e7e7e7!important}::ng-deep tr td.excel:first-child{color:#959da5;background-color:#f4f4f4;font-weight:unset;width:1%;text-align:center}::ng-deep tr td.excel:first-child div{width:80px}::ng-deep tr th.excel:first-child{background-color:#f4f4f4;width:1%}::ng-deep tr th.excel:first-child div{width:80px}.gd-page-image{height:100%!important;width:100%!important}"]}]}],e.ctorParameters=function(){return[{type:b}]},e.propDecorators={angle:[{type:i.Input}],width:[{type:i.Input}],height:[{type:i.Input}],number:[{type:i.Input}],data:[{type:i.Input}],isHtml:[{type:i.Input}],editable:[{type:i.Input}]},e}();var y=function(e){function t(t,i,n,o,r){var a=e.call(this,t,i,n,o)||this;return a.renderer=r,a.panzoom=null,a.navigateService=o,a}return function(e,t){function i(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.ngOnInit=function(){this.currentPageNo=1},t.prototype.ngAfterViewInit=function(){var e=this;this.refreshExcelDocHeight(),this.pages.changes.subscribe((function(){e.refreshExcelDocHeight()})),this.navigateService.navigate.subscribe((function(t){t&&e.selectSheet(t)}));var t=this.getScrollBarWidth();this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"right",this.getScrollBarWidth()+"px"),this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"bottom",this.getScrollBarWidth()+"px"),0===t&&this.renderer.setStyle(this._elementRef.nativeElement.querySelector(".sheets"),"padding-right","17px")},t.prototype.getScrollBarWidth=function(){var e=document.querySelector(".gd-document");return e.offsetWidth-e.clientWidth},t.prototype.refreshExcelDocHeight=function(){this.doc=this._elementRef.nativeElement.children.item(0),this.panzoom=this._elementRef.nativeElement.children.item(0).children.item(0),this.doc.style.height=this.panzoom.scrollHeight+37+"px"},t.prototype.selectSheet=function(e){this.currentPageNo=e},t.decorators=[{type:i.Component,args:[{selector:"gd-excel-document",template:'<div class="wait" *ngIf="wait">Please wait...</div>\n<div id="document" class="document">\n  <div [ngClass]="isDesktop ? \'panzoom auto-height\' : \'panzoom mobile\'" gdZoom [zoomActive]="true" [file]="file" gdSearchable>\n    <div [ngClass]="file.showGridLines ? \'page-grid-lines\' : \'page\'" *ngFor="let page of file?.pages"\n         gdRotation [angle]="page.angle" [isHtmlMode]="mode">\n      <gd-excel-page *ngIf="currentPageNo == page.number" [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle"\n               [width]="page.width" [height]="page.height" [editable]="page.editable"></gd-excel-page>\n    </div>\n  </div>\n</div>\n<div class="sheets">\n  <div class="sheets-wrapper">\n    <div *ngFor="let page of file?.pages">\n      <gd-button [icon]="\'eye\'" [ngClass]="{\'active\': currentPageNo == page.number }" (click)="selectSheet(page.number)">{{page.sheetName}}</gd-button>\n    </div>\n  </div>\n</div>\n',styles:[":host{overflow:scroll;width:100%;background-color:#e7e7e7}.document{width:100%;-webkit-transition:.4s;transition:.4s;padding:0;margin:0;position:relative}.sheets{background-color:#fff;display:-webkit-box;display:flex;border-top:1px solid #e7e7e7;position:fixed;width:100%}.sheets ::ng-deep gd-button.active .text{background-color:#272727;border-radius:10px;color:#eee}.sheets ::ng-deep gd-button .text{padding:1px 12px;color:#000}.sheets ::ng-deep gd-button fa-icon{display:none}.sheets-wrapper{margin-left:29px;display:-webkit-box;display:flex}.page{position:relative;display:inline-block;background-color:#fff;-webkit-transition:.3s;transition:.3s}.wait{position:absolute;top:55px;left:Calc(30%)}.panzoom.auto-height{-webkit-transform:none;transform:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;display:-webkit-box;display:flex;flex-wrap:wrap;height:auto!important}.gd-zoomed{margin:10px 98px}.highlights{position:absolute;top:0;left:0;bottom:0;right:0}.page-grid-lines{background-color:#fff}@media (max-width:1037px){.document{overflow-x:auto!important}.page{min-width:unset!important;min-height:unset!important;margin:5px 0}}"]}]}],t.ctorParameters=function(){return[{type:i.ElementRef},{type:o.ZoomService},{type:o.WindowService},{type:o.NavigateService},{type:i.Renderer2}]},t.propDecorators={pages:[{type:i.ViewChildren,args:[w]}]},t}(o.DocumentComponent);var P=l,x=function(){function e(e,t,n,o){var r=this;this._elementRef=e,this._zoomService=t,this._windowService=n,this._navigateService=o,this.selectedPage=new i.EventEmitter,this.wait=!1,this.container=null,this.doc=null,t.zoomChange.subscribe((function(e){r.zoom=e,100!==e&&(1!==r.currentPage&&r.scrollTo(r.currentPage,!0,!1),r.alignVert())})),this.isDesktop=n.isDesktop(),this._navigateService.navigate.subscribe((function(e){r.scrollTo(e,e>r.lastCurrentPage),r.lastCurrentPage=e}))}return e.prototype.ngOnInit=function(){this.lastCurrentPage=this._navigateService.currentPage},e.prototype.ngOnChanges=function(){},e.prototype.ngAfterViewInit=function(){this.doc=this._elementRef.nativeElement.children.item(0).children.item(0),this.container=this._elementRef.nativeElement;new s(this.container)},e.prototype.alignVert=function(){var e=this._elementRef.nativeElement.querySelectorAll(".presentation"),t=this._zoomService.zoom/100;e.forEach((function(e){return e.style.marginTop=(window.innerHeight-(e.clientHeight?e.clientHeight:e.scrollHeight)*t-u.topbarWidth)/2/t+"px"}))},e.prototype.ngAfterViewChecked=function(){var e=this._elementRef.nativeElement.querySelectorAll(".gd-wrapper").item(0);e&&P(e).trigger("focus")},e.prototype.scrollTo=function(e,t,i){void 0===i&&(i=!0);var n=this._elementRef.nativeElement.offsetWidth*(e-1),o=t?n-this._elementRef.nativeElement.offsetWidth:n+this._elementRef.nativeElement.offsetWidth;this.doScrolling(n,o,500,new r.Subject,this._elementRef,i),this.selectedPage.emit(e)},e.prototype.doScrolling=function(e,t,i,n,o,r){void 0===r&&(r=!0);var a,s=e-t;r?window.requestAnimationFrame((function e(r){var l=r-(a=a||r),p=Math.min(l/i,1);o.nativeElement.scrollTo({left:t+s*p}),l<i?(window.requestAnimationFrame(e),n.next({})):n.complete()})):o.nativeElement.scrollTo({left:t+s})},e.prototype.getDimensionWithUnit=function(e,t){return e+(this.mode?o.FileUtil.find(this.file.guid,!1).unit:"px")},e.prototype.isVertical=function(e){return e.height>e.width},e.prototype.onPanLeft=function(e){e.isFinal&&this._navigateService.nextPage()},e.prototype.onPanRight=function(e){e.isFinal&&this._navigateService.prevPage()},e.decorators=[{type:i.Component,args:[{selector:"gd-run-presentation",template:'<div class="wait" *ngIf="wait">Please wait...</div>\n<div id="document" class="document" (panleft)="onPanLeft($event)" (panright)="onPanRight($event)">\n  <div [ngClass]="isDesktop ? \'panzoom\' : \'panzoom mobile\'" gdZoom [zoomActive]="true" [file]="file" gdSearchable>\n    <div [ngClass]="isVertical(page) ? \'page presentation vertical\' : \'page presentation\'" *ngFor="let page of file?.pages"\n      [style.height]="getDimensionWithUnit(page.height, page.number)" [style.width]="getDimensionWithUnit(page.width, page.number)" gdRotation\n      [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n      <gd-page [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle" [width]="page.width"\n        [height]="page.height" [editable]="page.editable"></gd-page>\n    </div>\n  </div>\n  <ng-content></ng-content>\n</div>\n',styles:[':host{-webkit-box-flex:1;flex:1;-webkit-transition:.4s;transition:.4s;background-color:#e7e7e7;height:100%;overflow-y:hidden;touch-action:auto!important;overflow-x:hidden}:host .document{-webkit-user-select:text!important;-moz-user-select:text!important;-ms-user-select:text!important;user-select:text!important;touch-action:auto!important}.page{display:inline-block;margin:20px;-webkit-transition:.3s;transition:.3s}.page ::ng-deep gd-page{box-shadow:0 3px 6px rgba(0,0,0,.16);background-color:#fff}.page.presentation{-webkit-transition:unset;transition:unset;margin:0;width:100%!important;display:-webkit-box!important;display:flex!important;-webkit-box-pack:center!important;justify-content:center!important}.page.presentation.vertical{margin:0;width:100%!important;display:-webkit-box!important;display:flex!important;-webkit-box-pack:center!important;justify-content:center!important}.page.presentation.vertical ::ng-deep [class*="-rotate"]{position:unset!important;margin-right:-240px}.page.presentation.vertical ::ng-deep gd-page{height:960pt;width:540pt}.wait{position:absolute;top:55px;left:Calc(30%)}.panzoom{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;flex-wrap:wrap;align-content:flex-start}@media (max-width:1037px){:host{overflow-y:unset}.page{min-width:unset!important;min-height:unset!important;margin:5px 0}.page ::ng-deep .gd-wrapper{pointer-events:none}}']}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:o.ZoomService},{type:o.WindowService},{type:o.NavigateService}]},e.propDecorators={mode:[{type:i.Input}],preloadPageCount:[{type:i.Input}],file:[{type:i.Input}],currentPage:[{type:i.Input}],selectedPage:[{type:i.Output}]},e}();function C(e){return function(){return e.load()}}function S(){var e=new o.ConfigService;return e.apiEndpoint="http://localhost:8080",e}function I(e){return new o.LoadingMaskInterceptorService(e)}var _=function(){function e(){}return e.forRoot=function(t){return o.Api.DEFAULT_API_ENDPOINT=t,{ngModule:e}},e.decorators=[{type:i.NgModule,args:[{declarations:[m,v,x,y,w],imports:[t.BrowserModule,o.CommonComponentsModule,n.HttpClientModule,a.FontAwesomeModule],exports:[m,v,x,y,w,o.CommonComponentsModule],providers:[d,{provide:o.ConfigService,useFactory:S},h,{provide:n.HTTP_INTERCEPTORS,useClass:o.ErrorInterceptorService,multi:!0},{provide:i.APP_INITIALIZER,useFactory:C,deps:[h],multi:!0},o.LoadingMaskService,{provide:n.HTTP_INTERCEPTORS,useFactory:I,multi:!0,deps:[o.LoadingMaskService]}]}]}],e}();e.ViewerAppComponent=m,e.ViewerConfigService=h,e.ViewerModule=_,e.ViewerService=d,e.endPoint=S,e.initializeApp=C,e.setupLoadingInterceptor=I,e.ɵa=v,e.ɵb=x,e.ɵc=y,e.ɵd=w,e.ɵe=b,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=groupdocs.examples.angular-viewer.umd.min.js.map