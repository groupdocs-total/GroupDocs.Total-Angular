!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("@angular/core"),require("@angular/common/http"),require("@groupdocs.examples.angular/common-components"),require("rxjs"),require("@fortawesome/angular-fontawesome")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/viewer",["exports","@angular/platform-browser","@angular/core","@angular/common/http","@groupdocs.examples.angular/common-components","rxjs","@fortawesome/angular-fontawesome"],t):t(((e=e||self).groupdocs=e.groupdocs||{},e.groupdocs.examples=e.groupdocs.examples||{},e.groupdocs.examples.angular=e.groupdocs.examples.angular||{},e.groupdocs.examples.angular.viewer={}),e.ng.platformBrowser,e.ng.core,e.ng.common.http,e.commonComponents,e.rxjs,e.angularFontawesome)}(this,(function(e,t,i,o,n,r,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function l(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}var p=function(){function e(e,t){this._http=e,this._config=t}return e.prototype.loadFiles=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_FILE_TREE,{path:e},n.Api.httpOptionsJson)},e.prototype.loadFile=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_DOCUMENT_DESCRIPTION,e,n.Api.httpOptionsJson)},e.prototype.upload=function(e,t,i){var o=new FormData;return o.append("file",e),o.append("rewrite",String(i)),t&&o.append("url",t),this._http.post(this._config.getViewerApiEndpoint()+n.Api.UPLOAD_DOCUMENTS,o)},e.prototype.loadPage=function(e,t){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_DOCUMENT_PAGE,{guid:e.guid,password:e.password,page:t},n.Api.httpOptionsJson)},e.prototype.rotate=function(e,t,i){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.ROTATE_DOCUMENT_PAGE,{guid:e.guid,password:e.password,pages:[i],angle:t},n.Api.httpOptionsJson)},e.prototype.getDownloadUrl=function(e){return this._config.getViewerApiEndpoint()+n.Api.DOWNLOAD_DOCUMENTS+"/?path="+e.guid},e.prototype.loadPrint=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_PRINT,{guid:e.guid,password:e.password},n.Api.httpOptionsJson)},e.prototype.loadPrintPdf=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_PRINT_PDF,{guid:e.guid,password:e.password},n.Api.httpOptionsJsonResponseTypeBlob)},e.prototype.loadThumbnails=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_THUMBNAILS,{guid:e.guid,password:e.password},n.Api.httpOptionsJson)},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:o.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(o.HttpClient),i.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}();var g=function(){};var c=function(){function e(e,t){this._http=e,this._config=t,this._viewerConfig=new r.BehaviorSubject(new g),this._updatedConfig=this._viewerConfig.asObservable()}return Object.defineProperty(e.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;return new Promise((function(t,i){var o=e._config.getConfigEndpoint(n.Api.VIEWER_APP);e._http.get(o,n.Api.httpOptionsJson).toPromise().then((function(i){var o=i;e._viewerConfig.next(o),t()})).catch((function(e){i("Could not load viewer config: "+JSON.stringify(e))}))}))},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:o.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(o.HttpClient),i.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}();var d=function(){function e(e,t,i,o,r,a,s,l,p,g,c){var d=this;this._viewerService=e,this._modalService=t,this._navigateService=r,this._zoomService=a,this._renderPrintService=l,this._windowService=g,this._loadingMaskService=c,this.title="viewer",this.files=[],this.countPages=0,this.formatDisabled=!this.file,this.showThumbnails=!1,this.browseFilesModal=n.CommonModals.BrowseFiles,this.showSearch=!1,this._zoom=100,this.fileWasDropped=!1,i.updatedConfig.subscribe((function(e){d.viewerConfig=e})),o.uploadsChange.subscribe((function(e){if(e){var t=void 0;for(t=0;t<e.length;t++)d._viewerService.upload(e.item(t),"",d.viewerConfig.rewrite).subscribe((function(e){d.fileWasDropped?d.selectFile(e.guid,"",""):d.selectDir("")}))}})),s.checkPreload.subscribe((function(e){if(0!==d.viewerConfig.preloadPageCount)for(var t=e;t<e+2;t++)t>0&&t<=d.countPages&&!d.file.pages[t-1].data&&d.preloadPages(t,t)})),p.passChange.subscribe((function(e){d.selectFile(d.credentials.guid,e,n.CommonModals.PasswordRequired)})),this.isDesktop=g.isDesktop(),g.onResize.subscribe((function(e){d.isDesktop=g.isDesktop(),d.refreshZoom()}))}return e.prototype.ngOnInit=function(){""!==this.viewerConfig.defaultDocument&&(this.isLoading=!0,this.selectFile(this.viewerConfig.defaultDocument,"",""))},e.prototype.ngAfterViewInit=function(){var e=this;this._loadingMaskService.onLoadingChanged.subscribe((function(t){return e.isLoading=t})),this.refreshZoom()},Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.zoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSelectorConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.pageSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.search},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnailsConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.thumbnails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rotate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"printConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.print},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlModeConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.htmlMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"saveRotateStateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.saveRotateState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableRightClickConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.enableRightClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._navigateService.currentPage},enumerable:!0,configurable:!0}),e.prototype.openModal=function(e){this._modalService.open(e)},e.prototype.closeModal=function(e){this._modalService.close(e)},e.prototype.selectDir=function(e){var t=this;this._viewerService.loadFiles(e).subscribe((function(e){return t.files=e||[]}))},e.prototype.selectFile=function(e,t,i){var o=this;this.credentials={guid:e,password:t},this.file=null,this._viewerService.loadFile(this.credentials).subscribe((function(e){if(o.file=e,o.formatDisabled=!o.file,e){e.pages&&e.pages[0]&&(o._pageHeight=e.pages[0].height,o._pageWidth=e.pages[0].width,o.options=o.zoomOptions(),o.refreshZoom());var t=o.viewerConfig.preloadPageCount,i=e.pages?e.pages.length:0;t>0&&(o.preloadPages(1,t>i?i:t),o._viewerService.loadThumbnails(o.credentials).subscribe((function(e){o.file.thumbnails=e.pages}))),o._navigateService.countPages=i,o._navigateService.currentPage=1,o.countPages=i}})),i&&this._modalService.close(i),this.clearData()},e.prototype.preloadPages=function(e,t){for(var i=this,o=function(e){n._viewerService.loadPage(n.credentials,e).subscribe((function(t){i.file.pages[e-1]=t}))},n=this,r=e;r<=t;r++)o(r)},e.prototype.upload=function(e){var t=this;this._viewerService.upload(null,e,this.rewriteConfig).subscribe((function(){t.selectDir("")}))},e.prototype.nextPage=function(){this.formatDisabled||this._navigateService.nextPage()},e.prototype.prevPage=function(){this.formatDisabled||this._navigateService.prevPage()},e.prototype.toLastPage=function(){this.formatDisabled||this._navigateService.toLastPage()},e.prototype.toFirstPage=function(){this.formatDisabled||this._navigateService.toFirstPage()},e.prototype.navigateToPage=function(e){this.formatDisabled||this._navigateService.navigateTo(e)},e.prototype.zoomIn=function(){this.formatDisabled||this._zoom<490&&(this.zoom=this._zoom+10)},e.prototype.zoomOut=function(){this.formatDisabled||this._zoom>30&&(this.zoom=this._zoom-10)},e.prototype.fileDropped=function(e){this.fileWasDropped=e},e.prototype.ptToPx=function(e){return 96*e/72},e.prototype.getFitToWidth=function(){var e=!this.formatIcon||"file-excel"!==this.formatIcon&&"file-image"!==this.formatIcon?this.ptToPx(this._pageWidth):this._pageWidth,t=!this.formatIcon||"file-excel"!==this.formatIcon&&"file-image"!==this.formatIcon?this.ptToPx(this._pageHeight):this._pageHeight,i=e||window.innerWidth;return t>e&&Math.round(i/window.innerWidth)<2?200-Math.round(100*i/window.innerWidth):Math.round(100*window.innerWidth/i)},e.prototype.getFitToHeight=function(){var e=!this.formatIcon||"file-excel"!==this.formatIcon&&"file-image"!==this.formatIcon?this.ptToPx(this._pageWidth):this._pageWidth,t=!this.formatIcon||"file-excel"!==this.formatIcon&&"file-image"!==this.formatIcon?this.ptToPx(this._pageHeight):this._pageHeight,i=t>e?window.innerHeight-100:window.innerHeight+100,o=t||i;return t>e?Math.round(100*i/o):Math.round(100*o/i)},e.prototype.zoomOptions=function(){var e=this.getFitToWidth(),t=this.getFitToHeight();return this._zoomService.zoomOptions(e,t)},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,this._zoomService.changeZoom(this._zoom)},enumerable:!0,configurable:!0}),e.prototype.selectZoom=function(e){this.zoom=e.value},e.prototype.rotate=function(e){var t=this;if(!this.formatDisabled){var i=this._navigateService.currentPage,o=this.file.pages[i-1];this.saveRotateStateConfig&&this.file&&this._viewerService.rotate(this.credentials,e,i).subscribe((function(n){if(t.file.pages[i-1]=n,t.file&&t.file.pages&&o){var r=o.angle+e;r>360?t.changeAngle(o,90):r<-360?t.changeAngle(o,-90):t.changeAngle(o,r)}}))}},e.prototype.changeAngle=function(e,t){e.angle=t},e.prototype.downloadFile=function(){this.formatDisabled||window.location.assign(this._viewerService.getDownloadUrl(this.credentials))},e.prototype.printFile=function(){var e=this;this.formatDisabled||(0!==this.viewerConfig.preloadPageCount?this._viewerService.loadPrint(this.credentials).subscribe((function(t){e.file.pages=t.pages,e._renderPrintService.changePages(e.file.pages)})):this._renderPrintService.changePages(this.file.pages))},e.prototype.openThumbnails=function(){var e=this;this.formatDisabled||(this.showThumbnails?this.showThumbnails=!1:0===this.viewerConfig.preloadPageCount?this.showThumbnails=!0:this.file.thumbnails.filter((function(e){return!e.data})).length>0?this._viewerService.loadThumbnails(this.credentials).subscribe((function(t){e.file.thumbnails=t.pages,e.showThumbnails=!0})):this.showThumbnails=!0)},e.prototype.clearData=function(){var e,t;if(this.file&&this.file.pages)try{for(var i=l(this.file.pages),o=i.next();!o.done;o=i.next()){o.value.data=null}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.onRightClick=function(e){return this.enableRightClickConfig},e.prototype.openSearch=function(){this.formatDisabled||(this.showSearch=!this.showSearch)},e.prototype.refreshZoom=function(){this.formatIcon=this.file?n.FileUtil.find(this.file.guid,!1).icon:null,this.zoom=this._windowService.isDesktop()?100:this.getFitToWidth()},e.decorators=[{type:i.Component,args:[{selector:"gd-viewer",template:'<gd-loading-mask [loadingMask]="isLoading"></gd-loading-mask>\n<div class="wrapper" (contextmenu)="onRightClick($event)">\n  <div class="top-panel">\n    <gd-logo [logo]="\'viewer\'" icon="eye"></gd-logo>\n    <gd-top-toolbar class="toolbar-panel">\n      <gd-button [icon]="\'folder-open\'" [tooltip]="\'Browse files\'" (click)="openModal(browseFilesModal)"\n                 *ngIf="browseConfig" ></gd-button>\n\n      <gd-select class="mobile-hide" [disabled]="formatDisabled" [options]="options" (selected)="selectZoom($event)"\n                 [showSelected]="{ name: zoom+\'%\', value : zoom}" *ngIf="zoomConfig" ></gd-select>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'search-plus\'" [tooltip]="\'Zoom In\'" (click)="zoomIn()"\n                 *ngIf="zoomConfig" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'search-minus\'" [tooltip]="\'Zoom Out\'"\n                 (click)="zoomOut()" *ngIf="zoomConfig" ></gd-button>\n\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-double-left\'" [tooltip]="\'First Page\'"\n                 (click)="toFirstPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-left\'" [tooltip]="\'Previous Page\'"\n                 (click)="prevPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <div class="current-page-number" [ngClass]="{\'active\': !formatDisabled}" *ngIf="formatIcon !== \'file-excel\'">{{currentPage}}/{{countPages}}</div>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-right\'" [tooltip]="\'Next Page\'"\n                 (click)="nextPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'angle-double-right\'" [tooltip]="\'Last Page\'"\n                 (click)="toLastPage()" *ngIf="pageSelectorConfig && formatIcon !== \'file-excel\'" ></gd-button>\n\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'undo\'" [tooltip]="\'Rotate CCW\'" (click)="rotate(-90)"\n                 *ngIf="rotateConfig && formatIcon !== \'file-excel\'" ></gd-button>\n      <gd-button class="mobile-hide" [disabled]="formatDisabled" [icon]="\'redo\'" [tooltip]="\'Rotate CW\'" (click)="rotate(90)"\n                 *ngIf="rotateConfig && formatIcon !== \'file-excel\'" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'download\'" [tooltip]="\'Download\'"\n                 (click)="downloadFile()" *ngIf="downloadConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'print\'" [tooltip]="\'Print\'" (click)="printFile()"\n                 *ngIf="printConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'search\'" [tooltip]="\'Search\'" (click)="openSearch()"\n                 *ngIf="searchConfig" ></gd-button>\n      <gd-search (hidePanel)="showSearch = !$event" *ngIf="showSearch" ></gd-search>\n\n      <gd-button class="thumbnails-button" [disabled]="formatDisabled" [icon]="\'th-large\'" [tooltip]="\'Thumbnails\'"\n                 (click)="openThumbnails()" *ngIf="thumbnailsConfig && isDesktop && formatIcon !== \'file-excel\'"></gd-button>\n    </gd-top-toolbar>\n  </div>\n  <div class="doc-panel" *ngIf="file" #docPanel>\n    <gd-thumbnails *ngIf="showThumbnails" [pages]="viewerConfig?.preloadPageCount == 0 ? file.pages : file.thumbnails" [isHtmlMode]="htmlModeConfig"\n                   [guid]="file.guid" [mode]="htmlModeConfig"></gd-thumbnails>\n\n    <gd-document class="gd-document" *ngIf="(file && formatIcon !== \'file-excel\') || (formatIcon === \'file-excel\' && !htmlModeConfig)" [file]="file" [mode]="htmlModeConfig" gdScrollable\n                 [preloadPageCount]="viewerConfig?.preloadPageCount" gdRenderPrint [htmlMode]="htmlModeConfig"></gd-document>\n    <gd-excel-document class="gd-document" *ngIf="file && formatIcon === \'file-excel\' && htmlModeConfig" [file]="file" [mode]="htmlModeConfig" gdScrollable\n                 [preloadPageCount]="viewerConfig?.preloadPageCount" gdRenderPrint [htmlMode]="htmlModeConfig"></gd-excel-document>\n  </div>\n\n  <gd-init-state [icon]="\'eye\'" [text]="\'Drop file here to upload\'" *ngIf="!file" (fileDropped)="fileDropped($event)">\n    Click <fa-icon [icon]="[\'fas\',\'folder-open\']"></fa-icon> to open file<br>\n    Or drop file here\n  </gd-init-state>\n\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\n                         (selectedFileGuid)="selectFile($event, null, browseFilesModal)"\n                         [uploadConfig]="uploadConfig"></gd-browse-files-modal>\n\n  <gd-error-modal></gd-error-modal>\n  <gd-password-required></gd-password-required>\n</div>\n',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.current-page-number{margin-left:7px;font-size:14px;color:#959da5;width:37px;height:37px;line-height:37px;text-align:center}.current-page-number.active{color:#fff}.wrapper{-webkit-box-align:stretch;align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.doc-panel{display:-webkit-box;display:flex;height:calc(100vh - 60px);-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.thumbnails-button{position:absolute;right:3px}.top-panel{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%}.toolbar-panel{background-color:#3e4e5a;width:100%}::ng-deep .tools .button,::ng-deep .tools .nav-caret,::ng-deep .tools .selected-value{color:#fff!important}::ng-deep .tools .button.inactive,::ng-deep .tools .nav-caret.inactive,::ng-deep .tools .selected-value.inactive{color:#959da5!important}::ng-deep .tools .button{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-flow:column}::ng-deep .tools .dropdown-menu .option{color:#6e6e6e!important}::ng-deep .tools .dropdown-menu .option:hover{background-color:#4b566c!important}::ng-deep .tools .icon-button{margin:0 0 0 7px!important}::ng-deep .tools .select{width:65px;height:37px;margin-left:7px;line-height:37px;text-align:center}@media (max-width:1037px){.current-page-number,.mobile-hide{display:none}::ng-deep .tools gd-button:nth-child(1)>.icon-button{margin:0 0 0 10px!important}::ng-deep .tools .icon-button{height:60px;width:60px}::ng-deep .tools .gd-nav-search-btn .icon-button{height:37px;width:37px}::ng-deep .tools .gd-nav-search-btn .button{font-size:14px}}"]}]}],e.ctorParameters=function(){return[{type:p},{type:n.ModalService},{type:c},{type:n.UploadFilesService},{type:n.NavigateService},{type:n.ZoomService},{type:n.PagePreloadService},{type:n.RenderPrintService},{type:n.PasswordService},{type:n.WindowService},{type:n.LoadingMaskService}]},e}();var f=function(){function e(e,t){this._navigateService=e,this._zoomService=t}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){this.pages.forEach((function(e){e.data&&(e.data=e.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,""))}))},e.prototype.ngAfterViewInit=function(){this._zoomService.changeZoom(this._zoomService.zoom)},e.prototype.ngOnDestroy=function(){this._zoomService.changeZoom(this._zoomService.zoom)},e.prototype.imgData=function(e){return this.isHtmlMode?"data:image/png;base64,":"data:image/png;base64,"+e},e.prototype.getScale=function(e,t){return Math.min(190/e,190/t)},e.prototype.openPage=function(e){this._navigateService.navigateTo(e)},e.prototype.getDimensionWithUnit=function(e){return e+n.FileUtil.find(this.guid,!1).unit},e.decorators=[{type:i.Component,args:[{selector:"gd-thumbnails",template:'<div class="gd-thumbnails">\n  <div class="gd-thumbnails-panzoom">\n    <div *ngFor="let page of pages" id="gd-thumbnails-page-{{page.number}}" class="gd-page"\n         (click)="openPage(page.number)" gdRotation [withMargin]="false"\n         [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n      <div class="gd-wrapper"\n           [style.height]="getDimensionWithUnit(page.height)"\n           [style.width]="getDimensionWithUnit(page.width)"\n           [ngStyle]="{\'transform\': \'translateX(-50%) translateY(-50%) scale(\'+getScale(page.width, page.height)+\')\'}"\n           *ngIf="page.data && isHtmlMode"\n           [innerHTML]="page.data | safeHtml"></div>\n      <div class="gd-wrapper" \n           [style.height]="getDimensionWithUnit(page.height)"\n           [style.width]="getDimensionWithUnit(page.width)"\n           [ngStyle]="{\'transform\': \'translateX(-50%) translateY(-50%) scale(\'+getScale(page.width, page.height)+\')\'}"\n           *ngIf="page.data && !isHtmlMode">\n           <img style="width: inherit !important" class="gd-page-image" [attr.src]="imgData(page.data) | safeResourceHtml"\n             alt/>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[":host{-webkit-box-flex:0;flex:0 0 300px;background:#f5f5f5;color:#fff;overflow-y:auto;display:block;-webkit-transition:margin-left .2s;transition:margin-left .2s;height:100%}.gd-page{width:272px;height:272px;-webkit-transition:.3s;transition:.3s;background-color:#e7e7e7;cursor:pointer;margin:14px 14px 0}.gd-page:hover{background-color:silver}.gd-wrapper{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);left:50%;top:50%;position:relative;background-color:#fff;box-shadow:0 4px 12px -4px rgba(0,0,0,.38)}.gd-wrapper ::ng-deep img{width:inherit}.gd-thumbnails::-webkit-scrollbar{width:0;background-color:#f5f5f5}.gd-thumbnails-panzoom>.gd-thumbnails-landscape{margin:-134px 0 -1px 12px}.gd-thumbnails .gd-page-image{height:inherit}.gd-thumbnails-landscape-image{margin:-90px 0 -23px!important}.gd-thumbnails-landscape-image-rotated{margin:126px 0 -3px -104px!important}"]}]}],e.ctorParameters=function(){return[{type:n.NavigateService},{type:n.ZoomService}]},e.propDecorators={pages:[{type:i.Input}],guid:[{type:i.Input}],mode:[{type:i.Input}],isHtmlMode:[{type:i.Input}]},e}();var h=function(){function e(){}return e.prototype.getUpdatedPage=function(e){var t=(new DOMParser).parseFromString(e,"text/html"),i=t.querySelector("table"),o=0;t.querySelectorAll("table > tbody > tr:first-child td").forEach((function(e){o+=e.attributes.colspan?parseInt(e.attributes.colspan.value,10):1}));var n=this.createHeader(o,i);return t.querySelector("table").replaceWith(n),(new XMLSerializer).serializeToString(t).replace(/a0:/g,"").replace(/:a0/g,"")},e.prototype.createHeader=function(e,t){var i=document.createElement("thead");i.append(document.createElement("tr"));for(var o=0;o<e;++o){var n=document.createElement("th");n.innerText=this.colName(o),i.querySelector("tr").append(n)}var r=t.querySelector("colgroup"),a=document.createElement("col");a.width="80px",r.prepend(a),t.prepend(i);var s=0;return t.querySelectorAll("tr").forEach((function(e){var t=document.createElement("div");if(0!==s){var i=document.createElement("td");i.className="excel",i.append(t),t.innerText=s.toString(),e.prepend(i)}else{var o=document.createElement("th");o.append(t),e.prepend(o)}s++})),t},e.prototype.colName=function(e){for(var t="a".charCodeAt(0),i="z".charCodeAt(0)-t+1,o="";e>=0;)o=String.fromCharCode(e%i+t)+o,e=Math.floor(e/i)-1;return o},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),u=function(){function e(e){this._excelPageService=e}return e.prototype.ngOnInit=function(){!!/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)&&0===this.number&&(this.editable=!1)},e.prototype.ngOnChanges=function(e){this.data=null!==this.data?this.data.replace(/>\s+</g,"><").replace(/\uFEFF/g,""):null;this.imgData="data:image/png;base64,",this.isHtml||(this.imgData+=this.data),this.data=null!==this.data?this._excelPageService.getUpdatedPage(this.data):null},e.decorators=[{type:i.Component,args:[{selector:"gd-excel-page",template:'<div id="page-{{number}}">\n  <div class="gd-wrapper" [innerHTML]="data | safeHtml" *ngIf="data && isHtml" [contentEditable]="(editable) ? true : false"></div>\n  <img class="gd-page-image" [style.width.px]="width" [style.height.px]="height" [attr.src]="imgData | safeResourceHtml"\n       alt=""\n       *ngIf="data && !isHtml">\n  <div class="gd-page-spinner" *ngIf="!data">\n    <fa-icon [icon]="[\'fas\',\'circle-notch\']" [spin]="true"></fa-icon>\n    &nbsp;Loading... Please wait.\n  </div>\n</div>\n',styles:[".gd-page-spinner{margin-top:150px;text-align:center}.gd-wrapper{width:inherit;height:inherit}.gd-wrapper div{width:100%}::ng-deep .gd-highlight{background-color:#ff0}::ng-deep .gd-highlight-select{background-color:#ff9b00}::ng-deep th{color:#959da5;background-color:#f4f4f4;font-weight:unset;border:1px solid #e7e7e7!important;text-transform:uppercase;font-size:14px;overflow:hidden}::ng-deep td{vertical-align:middle!important}::ng-deep .page-grid-lines td{border:1px solid #e7e7e7!important}::ng-deep .page td:nth-child(1){border:1px solid #e7e7e7!important}::ng-deep tr td.excel:first-child{color:#959da5;background-color:#f4f4f4;font-weight:unset;width:1%;text-align:center}::ng-deep tr td.excel:first-child div{width:80px}::ng-deep tr th.excel:first-child{background-color:#f4f4f4;width:1%}::ng-deep tr th.excel:first-child div{width:80px}.gd-page-image{height:100%!important;width:100%!important}"]}]}],e.ctorParameters=function(){return[{type:h}]},e.propDecorators={angle:[{type:i.Input}],width:[{type:i.Input}],height:[{type:i.Input}],number:[{type:i.Input}],data:[{type:i.Input}],isHtml:[{type:i.Input}],editable:[{type:i.Input}]},e}();var m=function(e){function t(t,i,o,n){var r=e.call(this,t,i,o)||this;return r._navigateService=n,r.panzoom=null,r}return function(e,t){function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.ngOnInit=function(){this.currentPageNo=1},t.prototype.ngAfterViewInit=function(){var e=this;this.refreshExcelDocHeight(),this.pages.changes.subscribe((function(){e.refreshExcelDocHeight()})),this._navigateService.navigate.subscribe((function(t){e.selectSheet(t)}))},t.prototype.refreshExcelDocHeight=function(){this.doc=this._elementRef.nativeElement.children.item(0),this.panzoom=this._elementRef.nativeElement.children.item(0).children.item(0),this.doc.style.height=this.panzoom.scrollHeight+37+"px"},t.prototype.selectSheet=function(e){this.currentPageNo=e},t.decorators=[{type:i.Component,args:[{selector:"gd-excel-document",template:'<div class="wait" *ngIf="wait">Please wait...</div>\n<div id="document" class="document">\n  <div [ngClass]="isDesktop ? \'panzoom\' : \'panzoom mobile\'" gdZoom [zoomActive]="true" [file]="file" gdSearchable>\n    <div [ngClass]="file.showGridLines ? \'page-grid-lines\' : \'page\'" *ngFor="let page of file?.pages"\n         gdRotation [angle]="page.angle" [isHtmlMode]="mode">\n      <gd-excel-page *ngIf="currentPageNo == page.number" [number]="page.number" [data]="page.data" [isHtml]="mode" [angle]="page.angle"\n               [width]="page.width" [height]="page.height" [editable]="page.editable"></gd-excel-page>\n    </div>\n  </div>\n</div>\n<div class="sheets">\n  <div class="sheets-wrapper">\n    <div *ngFor="let page of file?.pages">\n      <gd-button [icon]="\'eye\'" [ngClass]="{\'active\': currentPageNo == page.number }" (click)="selectSheet(page.number)">Sheet {{page.number}}</gd-button>\n    </div>\n  </div>\n</div>\n',styles:[":host{overflow:scroll;width:100%;background-color:#e7e7e7}.document{width:100%;-webkit-transition:.4s;transition:.4s;padding:0;margin:0;position:relative}.sheets{background-color:#fff;display:-webkit-box;display:flex;border-top:1px solid #e7e7e7;position:fixed;bottom:17px;right:17px;width:100%}.sheets ::ng-deep gd-button.active .text{background-color:#272727;border-radius:10px;color:#eee}.sheets ::ng-deep gd-button .text{padding:1px 12px;color:#000}.sheets ::ng-deep gd-button fa-icon{display:none}.sheets-wrapper{margin-left:29px;display:-webkit-box;display:flex}.page{position:relative;display:inline-block;background-color:#fff;-webkit-transition:.3s;transition:.3s}.wait{position:absolute;top:55px;left:Calc(30%)}.panzoom{-webkit-transform:none;transform:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform-origin:50% 50% 0;transform-origin:50% 50% 0;display:-webkit-box;display:flex;flex-wrap:wrap}.gd-zoomed{margin:10px 98px}.highlights{position:absolute;top:0;left:0;bottom:0;right:0}.page-grid-lines{background-color:#fff}@media (max-width:1037px){.document{overflow-x:auto!important}.panzoom{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.page{min-width:unset!important;min-height:unset!important;margin:5px 0}}"]}]}],t.ctorParameters=function(){return[{type:i.ElementRef},{type:n.ZoomService},{type:n.WindowService},{type:n.NavigateService}]},t.propDecorators={pages:[{type:i.ViewChildren,args:[u]}]},t}(n.DocumentComponent);function b(e){return function(){return e.load()}}function v(e){return new n.LoadingMaskInterceptorService(e)}var w=function(){function e(){}return e.forRoot=function(t){return n.Api.DEFAULT_API_ENDPOINT=t,{ngModule:e}},e.decorators=[{type:i.NgModule,args:[{declarations:[d,f,m,u],imports:[t.BrowserModule,n.CommonComponentsModule,o.HttpClientModule,a.FontAwesomeModule],exports:[d,f,m,u,n.CommonComponentsModule],providers:[p,n.ConfigService,c,{provide:o.HTTP_INTERCEPTORS,useClass:n.ErrorInterceptorService,multi:!0},{provide:i.APP_INITIALIZER,useFactory:b,deps:[c],multi:!0},n.LoadingMaskService,{provide:o.HTTP_INTERCEPTORS,useFactory:v,multi:!0,deps:[n.LoadingMaskService]}]}]}],e}();e.ViewerAppComponent=d,e.ViewerConfigService=c,e.ViewerModule=w,e.ViewerService=p,e.initializeApp=b,e.setupLoadingInterceptor=v,e.ɵa=f,e.ɵb=m,e.ɵc=u,e.ɵd=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=groupdocs.examples.angular-viewer.umd.min.js.map