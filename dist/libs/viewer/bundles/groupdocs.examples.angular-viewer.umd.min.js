!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/platform-browser"),require("@angular/core"),require("@angular/common/http"),require("@groupdocs.examples.angular/common-components"),require("rxjs")):"function"==typeof define&&define.amd?define("@groupdocs.examples.angular/viewer",["exports","@angular/platform-browser","@angular/core","@angular/common/http","@groupdocs.examples.angular/common-components","rxjs"],t):t(((e=e||self).groupdocs=e.groupdocs||{},e.groupdocs.examples=e.groupdocs.examples||{},e.groupdocs.examples.angular=e.groupdocs.examples.angular||{},e.groupdocs.examples.angular.viewer={}),e.ng.platformBrowser,e.ng.core,e.ng.common.http,e.commonComponents,e.rxjs)}(this,function(e,t,i,o,n,r){"use strict";function a(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}var s=function(){function e(e,t){this._http=e,this._config=t}return e.prototype.loadFiles=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_FILE_TREE,{path:e},n.Api.httpOptionsJson)},e.prototype.loadFile=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_DOCUMENT_DESCRIPTION,e,n.Api.httpOptionsJson)},e.prototype.upload=function(e,t,i){var o=new FormData;return o.append("file",e),o.append("rewrite",String(i)),t&&o.append("url",t),this._http.post(this._config.getViewerApiEndpoint()+n.Api.UPLOAD_DOCUMENTS,o)},e.prototype.loadPage=function(e,t){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_DOCUMENT_PAGE,{guid:e.guid,password:e.password,page:t},n.Api.httpOptionsJson)},e.prototype.rotate=function(e,t,i){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.ROTATE_DOCUMENT_PAGE,{guid:e.guid,password:e.password,pages:[i],angle:t},n.Api.httpOptionsJson)},e.prototype.getDownloadUrl=function(e){return this._config.getViewerApiEndpoint()+n.Api.DOWNLOAD_DOCUMENTS+"/?path="+e.guid},e.prototype.loadPrint=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_PRINT,{guid:e.guid,password:e.password},n.Api.httpOptionsJson)},e.prototype.loadPrintPdf=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_PRINT_PDF,{guid:e.guid,password:e.password},n.Api.httpOptionsJsonResponseTypeBlob)},e.prototype.loadThumbnails=function(e){return this._http.post(this._config.getViewerApiEndpoint()+n.Api.LOAD_THUMBNAILS,{guid:e.guid,password:e.password},n.Api.httpOptionsJson)},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:o.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(o.HttpClient),i.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}(),p=function(){},g=function(){function e(e,t){this._http=e,this._config=t,this._viewerConfig=new r.BehaviorSubject(new p),this._updatedConfig=this._viewerConfig.asObservable()}return Object.defineProperty(e.prototype,"updatedConfig",{get:function(){return this._updatedConfig},enumerable:!0,configurable:!0}),e.prototype.load=function(){var e=this;return new Promise(function(t,i){var o=e._config.getConfigEndpoint(n.Api.VIEWER_APP);e._http.get(o,n.Api.httpOptionsJson).toPromise().then(function(i){var o=i;e._viewerConfig.next(o),t()})["catch"](function(e){i("Could not load viewer config: "+JSON.stringify(e))})})},e.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:o.HttpClient},{type:n.ConfigService}]},e.ngInjectableDef=i.ɵɵdefineInjectable({factory:function(){return new e(i.ɵɵinject(o.HttpClient),i.ɵɵinject(n.ConfigService))},token:e,providedIn:"root"}),e}(),l=function(){function e(e,t,i,o,r,a,s,p,g,l){var d=this;this._viewerService=e,this._modalService=t,this._navigateService=r,this._zoomService=a,this._renderPrintService=p,this._windowService=l,this.title="viewer",this.files=[],this.countPages=0,this.formatDisabled=!this.file,this.showThumbnails=!1,this.browseFilesModal=n.CommonModals.BrowseFiles,this.showSearch=!1,this._zoom=100,i.updatedConfig.subscribe(function(e){d.viewerConfig=e}),o.uploadsChange.subscribe(function(e){if(e){var t=void 0;for(t=0;t<e.length;t++)d._viewerService.upload(e.item(t),"",d.viewerConfig.rewrite).subscribe(function(){d.selectDir("")})}}),s.checkPreload.subscribe(function(e){if(0!==d.viewerConfig.preloadPageCount)for(var t=e;t<e+2;t++)t>0&&t<=d.countPages&&!d.file.pages[t-1].data&&d.preloadPages(t,t)}),g.passChange.subscribe(function(e){d.selectFile(d.credentials.guid,e,n.CommonModals.PasswordRequired)}),this.isDesktop=l.isDesktop(),l.onResize.subscribe(function(e){d.isDesktop=l.isDesktop(),d.refreshZoom()})}return Object.defineProperty(e.prototype,"rewriteConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rewrite},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.zoom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSelectorConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.pageSelector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.search},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnailsConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.thumbnails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.rotate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.download},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uploadConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.upload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"printConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.print},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browseConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.browse},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlModeConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.htmlMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"saveRotateStateConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.saveRotateState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableRightClickConfig",{get:function(){return!this.viewerConfig||this.viewerConfig.enableRightClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._navigateService.currentPage},enumerable:!0,configurable:!0}),e.prototype.openModal=function(e){this._modalService.open(e)},e.prototype.closeModal=function(e){this._modalService.close(e)},e.prototype.selectDir=function(e){var t=this;this._viewerService.loadFiles(e).subscribe(function(e){return t.files=e||[]})},e.prototype.selectFile=function(e,t,i){var o=this;this.credentials={guid:e,password:t},this._viewerService.loadFile(this.credentials).subscribe(function(e){if(o.file=e,o.formatDisabled=!o.file,e){e.pages&&e.pages[0]&&(o._pageHeight=e.pages[0].height,o._pageWidth=e.pages[0].width,o.options=o.zoomOptions(),o.refreshZoom());var t=o.viewerConfig.preloadPageCount,i=e.pages?e.pages.length:0;t>0&&o.preloadPages(1,t>i?i:t),o._navigateService.countPages=i,o._navigateService.currentPage=1,o.countPages=i}}),this._modalService.close(i),this.clearData()},e.prototype.preloadPages=function(e,t){for(var i=this,o=function(e){n._viewerService.loadPage(n.credentials,e).subscribe(function(t){i.file.pages[e-1]=t})},n=this,r=e;r<=t;r++)o(r)},e.prototype.upload=function(e){var t=this;this._viewerService.upload(null,e,this.rewriteConfig).subscribe(function(){t.selectDir("")})},e.prototype.nextPage=function(){this.formatDisabled||this._navigateService.nextPage()},e.prototype.prevPage=function(){this.formatDisabled||this._navigateService.prevPage()},e.prototype.toLastPage=function(){this.formatDisabled||this._navigateService.toLastPage()},e.prototype.toFirstPage=function(){this.formatDisabled||this._navigateService.toFirstPage()},e.prototype.navigateToPage=function(e){this.formatDisabled||this._navigateService.navigateTo(e)},e.prototype.zoomIn=function(){this.formatDisabled||this._zoom<490&&(this.zoom=this._zoom+10)},e.prototype.zoomOut=function(){this.formatDisabled||this._zoom>30&&(this.zoom=this._zoom-10)},e.prototype.ptToPx=function(e){return 96*e/72},e.prototype.getFitToWidth=function(){var e=this.ptToPx(this._pageWidth),t=this.ptToPx(this._pageHeight),i=e||window.innerWidth;return t>e&&Math.round(i/window.innerWidth)<2?200-Math.round(100*i/window.innerWidth):Math.round(100*window.innerWidth/i)},e.prototype.getFitToHeight=function(){var e=this.ptToPx(this._pageWidth),t=this.ptToPx(this._pageHeight),i=t>e?window.innerHeight-100:window.innerHeight+100,o=t||i;return t>e?Math.round(100*i/o):Math.round(100*o/i)},e.prototype.zoomOptions=function(){var e=this.getFitToWidth(),t=this.getFitToHeight();return this._zoomService.zoomOptions(e,t)},Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this._zoom=e,this._zoomService.changeZoom(this._zoom)},enumerable:!0,configurable:!0}),e.prototype.selectZoom=function(e){this.zoom=e},e.prototype.rotate=function(e){var t=this;if(!this.formatDisabled){var i=this._navigateService.currentPage;if(this.saveRotateStateConfig&&this.file)this._viewerService.rotate(this.credentials,e,i).subscribe(function(e){var i,o;try{for(var n=a(e),r=n.next();!r.done;r=n.next()){var s=r.value,p=t.file.pages[s.pageNumber-1];t.file&&t.file.pages&&p&&t.changeAngle(p,s.angle)}}catch(g){i={error:g}}finally{try{r&&!r.done&&(o=n["return"])&&o.call(n)}finally{if(i)throw i.error}}});else{var o=this.file.pages[i-1];if(this.file&&this.file.pages&&o){var n=o.angle+e;n>360?this.changeAngle(o,90):n<-360?this.changeAngle(o,-90):this.changeAngle(o,n)}}}},e.prototype.changeAngle=function(e,t){e.angle=t},e.prototype.downloadFile=function(){this.formatDisabled||window.location.assign(this._viewerService.getDownloadUrl(this.credentials))},e.prototype.printFile=function(){var e=this;this.formatDisabled||(0!==this.viewerConfig.preloadPageCount?"Portable Document Format"===n.FileUtil.find(this.file.guid,!1).format?this._viewerService.loadPrintPdf(this.credentials).subscribe(function(t){var i=new Blob([t],{type:"application/pdf"});e._renderPrintService.changeBlob(i)}):this._viewerService.loadPrint(this.credentials).subscribe(function(t){e.file.pages=t.pages,e._renderPrintService.changePages(e.file.pages)}):this._renderPrintService.changePages(this.file.pages))},e.prototype.openThumbnails=function(){var e=this;this.formatDisabled||(this.showThumbnails?this.showThumbnails=!1:0===this.viewerConfig.preloadPageCount?this.showThumbnails=!0:this._viewerService.loadThumbnails(this.credentials).subscribe(function(t){e.file.pages=t.pages,e.showThumbnails=!0}))},e.prototype.clearData=function(){var e,t;if(this.file&&this.file.pages)try{for(var i=a(this.file.pages),o=i.next();!o.done;o=i.next()){o.value.data=null}}catch(n){e={error:n}}finally{try{o&&!o.done&&(t=i["return"])&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.onRightClick=function(e){return this.enableRightClickConfig},e.prototype.openSearch=function(){this.formatDisabled||(this.showSearch=!this.showSearch)},e.prototype.ngAfterViewInit=function(){this.refreshZoom()},e.prototype.refreshZoom=function(){this.zoom=this._windowService.isDesktop()?100:this.getFitToWidth()},e.decorators=[{type:i.Component,args:[{selector:"gd-viewer",template:'<div class="wrapper" (contextmenu)="onRightClick($event)">\n  <div class="top-panel">\n    <gd-logo [logo]="\'viewer\'" icon="eye"></gd-logo>\n    <gd-top-toolbar class="toolbar-panel">\n      <gd-button [icon]="\'folder-open\'" [tooltip]="\'Browse files\'" (click)="openModal(browseFilesModal)"\n                 *ngIf="browseConfig" ></gd-button>\n\n      <gd-select [disabled]="formatDisabled" [options]="options" (selected)="selectZoom($event)"\n                 [showSelected]="zoom" *ngIf="zoomConfig" ></gd-select>\n      <gd-button [disabled]="formatDisabled" [icon]="\'search-plus\'" [tooltip]="\'Zoom In\'" (click)="zoomIn()"\n                 *ngIf="zoomConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'search-minus\'" [tooltip]="\'Zoom Out\'"\n                 (click)="zoomOut()" *ngIf="zoomConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'angle-double-left\'" [tooltip]="\'First Page\'"\n                 (click)="toFirstPage()" *ngIf="pageSelectorConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'angle-left\'" [tooltip]="\'Previous Page\'"\n                 (click)="prevPage()" *ngIf="pageSelectorConfig" ></gd-button>\n      <div class="current-page-number">{{currentPage}}/{{countPages}}</div>\n      <gd-button [disabled]="formatDisabled" [icon]="\'angle-right\'" [tooltip]="\'Next Page\'"\n                 (click)="nextPage()" *ngIf="pageSelectorConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'angle-double-right\'" [tooltip]="\'Last Page\'"\n                 (click)="toLastPage()" *ngIf="pageSelectorConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'undo\'" [tooltip]="\'Rotate CCW\'" (click)="rotate(-90)"\n                 *ngIf="rotateConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'redo\'" [tooltip]="\'Rotate CW\'" (click)="rotate(90)"\n                 *ngIf="rotateConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'download\'" [tooltip]="\'Download\'"\n                 (click)="downloadFile()" *ngIf="downloadConfig" ></gd-button>\n      <gd-button [disabled]="formatDisabled" [icon]="\'print\'" [tooltip]="\'Print\'" (click)="printFile()"\n                 *ngIf="printConfig" ></gd-button>\n\n      <gd-button [disabled]="formatDisabled" [icon]="\'search\'" [tooltip]="\'Search\'" (click)="openSearch()"\n                 *ngIf="searchConfig" ></gd-button>\n      <gd-search (hidePanel)="showSearch = !$event" *ngIf="showSearch" ></gd-search>\n\n      <gd-button class="thumbnails-button" [disabled]="formatDisabled" [icon]="\'th-large\'" [tooltip]="\'Thumbnails\'"\n                 (click)="openThumbnails()" *ngIf="thumbnailsConfig && isDesktop"></gd-button>\n    </gd-top-toolbar>\n  </div>\n  <div class="doc-panel" *ngIf="file">\n    <gd-thumbnails *ngIf="showThumbnails" [pages]="file.pages" [isHtmlMode]="htmlModeConfig"\n                   [guid]="file.guid" [mode]="htmlModeConfig"></gd-thumbnails>\n\n    <gd-document class="gd-document" *ngIf="file" [file]="file" [mode]="htmlModeConfig"\n                 [preloadPageCount]="viewerConfig?.preloadPageCount" gdRenderPrint [htmlMode]="htmlModeConfig"></gd-document>\n  </div>\n\n  <gd-init-state [icon]="\'eye\'" [text]="\'\'" *ngIf="!file"></gd-init-state>\n\n  <gd-browse-files-modal (urlForUpload)="upload($event)" [files]="files" (selectedDirectory)="selectDir($event)"\n                         (selectedFileGuid)="selectFile($event, null, browseFilesModal)"\n                         [uploadConfig]="uploadConfig"></gd-browse-files-modal>\n\n  <gd-error-modal></gd-error-modal>\n  <gd-password-required></gd-password-required>\n</div>\n',styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans&display=swap);:host *{font-family:'Open Sans',Arial,Helvetica,sans-serif}.current-page-number{margin:0 15px;font-size:14px;color:#959da5}.wrapper{align-items:stretch;height:100%;width:100%;position:fixed;top:0;bottom:0;left:0;right:0}.doc-panel{display:flex;height:inherit}.thumbnails-button{position:absolute;right:3px}.gd-document{width:100%;height:100%}.top-panel{display:flex;align-items:center;width:100%}.toolbar-panel{background-color:#3e4e5a;width:100%}"]}]}],e.ctorParameters=function(){return[{type:s},{type:n.ModalService},{type:g},{type:n.UploadFilesService},{type:n.NavigateService},{type:n.ZoomService},{type:n.PagePreloadService},{type:n.RenderPrintService},{type:n.PasswordService},{type:n.WindowService}]},e}(),d=function(){function e(e){this._navigateService=e}return e.prototype.ngOnInit=function(){},e.prototype.imgData=function(e){return this.isHtmlMode?"data:image/png;base64,":"data:image/png;base64,"+e},e.prototype.getScale=function(e,t){return Math.min(190/e,190/t)},e.prototype.openPage=function(e){this._navigateService.navigateTo(e)},e.decorators=[{type:i.Component,args:[{selector:"gd-thumbnails",template:'<div class="gd-thumbnails">\n  <div class="gd-thumbnails-panzoom">\n    <div *ngFor="let page of pages" id="gd-thumbnails-page-{{page.number}}" class="gd-page"\n         (click)="openPage(page.number)" gdRotation [withMargin]="false"\n         [angle]="page.angle" [isHtmlMode]="mode" [width]="page.width" [height]="page.height">\n      <div class="gd-wrapper"\n           [style.width.pt]="page.width"\n           [style.height.pt]="page.height"\n           [ngStyle]="{\'transform\': \'translateX(-50%) translateY(-50%) scale(\'+getScale(page.width, page.height)+\')\'}"\n           *ngIf="page.data && isHtmlMode"\n           [innerHTML]="page.data | safeHtml"></div>\n      <div class="gd-wrapper" *ngIf="page.data && !isHtmlMode">\n        <img style="width: inherit !important" class="gd-page-image" [attr.src]="imgData(page.data) | safeResourceHtml"\n             alt/>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[".gd-thumbnails{z-index:9;padding:10pt;width:200pt;background:#f5f5f5;color:#fff;overflow-y:auto;display:block;transition:margin-left .2s;height:100%}.gd-page{width:190pt;height:190pt;transition:.3s;padding:5pt;background-color:#efefef;border-radius:5px;cursor:pointer}.gd-page:hover{background-color:silver}.gd-wrapper{transform:translate(-50%,-50%);left:50%;top:50%;position:relative;background-color:#fff;box-shadow:0 4px 12px -4px rgba(0,0,0,.38)}.gd-thumbnails::-webkit-scrollbar{width:0;background-color:#f5f5f5}.gd-thumbnails-panzoom>.gd-thumbnails-landscape{margin:-134px 0 -1px 12px}.gd-thumbnails-panzoom .gd-wrapper>div>div>img{width:inherit}.gd-thumbnails .gd-wrapper>img{width:-webkit-fill-available!important;margin:0 20px 0 0!important}.gd-thumbnails .gd-page-image{height:inherit;margin-left:153px!important}.gd-thumbnails-landscape-image{margin:-90px 0 -23px!important}.gd-thumbnails-landscape-image-rotated{margin:126px 0 -3px -104px!important}"]}]}],e.ctorParameters=function(){return[{type:n.NavigateService}]},e.propDecorators={pages:[{type:i.Input}],guid:[{type:i.Input}],mode:[{type:i.Input}],isHtmlMode:[{type:i.Input}]},e}();function c(e){return function(){return e.load()}}var u=function(){function e(){}return e.forRoot=function(t){return n.Api.DEFAULT_API_ENDPOINT=t,{ngModule:e}},e.decorators=[{type:i.NgModule,args:[{declarations:[l,d],imports:[t.BrowserModule,n.CommonComponentsModule,o.HttpClientModule],exports:[l,d,n.CommonComponentsModule],providers:[s,n.ConfigService,g,{provide:o.HTTP_INTERCEPTORS,useClass:n.ErrorInterceptorService,multi:!0},{provide:i.APP_INITIALIZER,useFactory:c,deps:[g],multi:!0}]}]}],e}();e.ViewerAppComponent=l,e.ViewerConfigService=g,e.ViewerModule=u,e.ViewerService=s,e.initializeApp=c,e.ɵa=d,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=groupdocs.examples.angular-viewer.umd.min.js.map